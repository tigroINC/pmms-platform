# 배출허용기준 관리 사용 가이드

## 개요
배출허용기준 관리 메뉴는 측정항목별 배출허용기준을 설정하고 관리하는 기능입니다.
우선순위: **굴뚝별 > 고객사별 > 전체 기준 > 기본 기준(Item 테이블)**

---

## 주요 기능

### 1. 기준 설정 (저장)

#### 케이스 1: 전체 기준 설정
**목적**: 모든 고객사/굴뚝에 공통으로 적용되는 기준 설정

**사용 방법**:
1. 고객사: "전체" 선택
2. 굴뚝: "전체" 선택
3. 지역 구분: "일반지역" 또는 "특별대책지역" 선택
4. 원하는 항목의 "설정 기준" 입력
5. "저장" 버튼 클릭

**적용 범위**: 개별 설정이 없는 모든 고객사/굴뚝

**예시**:
- 먼지: 30 mg/S㎥
- SOx: 100 ppm
- NOx: 200 ppm

---

#### 케이스 2: 고객사별 기준 설정
**목적**: 특정 고객사의 모든 굴뚝에 적용되는 기준 설정

**사용 방법**:
1. 고객사: 특정 고객사 선택 (예: "고려아연")
2. 굴뚝: "전체" 선택
3. 지역 구분 선택
4. 원하는 항목의 "설정 기준" 입력
5. "저장" 버튼 클릭

**적용 범위**: 해당 고객사의 모든 굴뚝 (굴뚝별 설정이 없는 경우)

**예시**:
- 고려아연의 모든 굴뚝에 먼지 기준 25 mg/S㎥ 적용

---

#### 케이스 3: 굴뚝별 기준 설정 (최우선)
**목적**: 특정 굴뚝에만 적용되는 개별 기준 설정

**사용 방법**:
1. 고객사: 특정 고객사 선택
2. 굴뚝: 특정 굴뚝 선택 (예: "C-ST01001")
3. 지역 구분 선택
4. 원하는 항목의 "설정 기준" 입력
5. "저장" 버튼 클릭

**적용 범위**: 해당 굴뚝만 (최우선 적용)

**예시**:
- C-ST01001 굴뚝에만 먼지 기준 20 mg/S㎥ 적용

---

### 2. 기존 설정값 조회 및 수정

#### 자동 로드 기능
- 고객사/굴뚝 선택 시 기존 설정값이 자동으로 입력 필드에 로드됨
- 값을 수정하고 "저장" 버튼 클릭하면 업데이트됨

#### 설정 현황 조회 (모달)
**사용 방법**:
1. "📊 설정 현황 조회" 버튼 클릭
2. 필터로 범위별 조회:
   - 전체: 모든 설정
   - 전체 기준: 고객사/굴뚝 지정 없는 기준
   - 고객사별: 특정 고객사 기준
   - 굴뚝별: 특정 굴뚝 기준
3. 테이블에서 설정 내역 확인
4. 필요시 "삭제" 버튼으로 개별 삭제

---

### 3. 편의 기능

#### 모두 기본기준 적용
- 현재 필터링된 모든 항목에 기본 기준을 일괄 적용
- 지역 구분에 따라 자동 계산 (특별대책지역 = 80%)

#### 개별 기본기준 적용
- 각 항목별로 "기본기준 적용" 버튼 클릭
- 해당 항목만 기본 기준으로 설정

#### Excel 다운로드
- 현재 필터링된 항목의 기준을 CSV로 내보내기

---

## 우선순위 적용 예시

### 시나리오
- 전체 기준: 먼지 30 mg/S㎥
- 고려아연 고객사별 기준: 먼지 25 mg/S㎥
- C-ST01001 굴뚝별 기준: 먼지 20 mg/S㎥

### 적용 결과
- C-ST01001 굴뚝: **20 mg/S㎥** (굴뚝별 기준 적용)
- 고려아연의 다른 굴뚝: **25 mg/S㎥** (고객사별 기준 적용)
- 다른 고객사의 굴뚝: **30 mg/S㎥** (전체 기준 적용)

---

## 주의사항

1. **관리자 권한 필요**: 저장/수정/삭제는 관리자만 가능
2. **자동 저장 없음**: 반드시 "저장" 버튼을 클릭해야 저장됨
3. **빈 값 처리**: 빈 값은 저장되지 않음 (기본 기준 사용)
4. **지역 구분**: 특별대책지역 선택 시 기본 기준의 80% 자동 계산
5. **중복 방지**: 동일 조건(항목+고객사+굴뚝)에 하나의 기준만 저장 가능

---

## 문제 해결

### 저장이 안 되는 경우
1. 관리자 권한 확인
2. 브라우저 콘솔에서 에러 메시지 확인
3. 입력값이 숫자인지 확인
4. 네트워크 연결 확인

### 기존 설정값이 안 보이는 경우
1. 고객사/굴뚝을 다시 선택
2. 페이지 새로고침
3. "설정 현황 조회"에서 확인

---

## 개선 필요 사항

### 현재 문제점
1. **복잡한 UX**: 3단계 우선순위 개념이 직관적이지 않음
2. **설정 확인 어려움**: 어떤 기준이 실제로 적용되는지 불명확
3. **일괄 관리 부족**: 여러 항목을 한번에 설정하기 어려움

### 개선 제안
1. **시각화 강화**: 우선순위를 색상/아이콘으로 표시
2. **미리보기 기능**: 저장 전 적용 결과 미리보기
3. **템플릿 기능**: 자주 사용하는 설정을 템플릿으로 저장
4. **이력 관리**: 변경 이력 추적 및 롤백 기능
5. **대량 업로드**: Excel 파일로 일괄 업로드
