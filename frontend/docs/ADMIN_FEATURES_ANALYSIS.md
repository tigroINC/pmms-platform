# 시스템 관리자 대시보드 기능 분석 보고서

## 📋 개요
시스템 관리자 대시보드의 **사용자 관리**와 **권한 관리** 기능 간 중복 및 충돌 여부를 검토한 결과입니다.

---

## 🔍 현재 구조

### 1. 사용자 관리 (`/admin/users`)
**목적**: 전체 사용자의 계정 생명주기 관리

**주요 기능**:
- ✅ 가입 승인/거부 (PENDING → APPROVED/REJECTED)
- ✅ 사용자 삭제
- ✅ **역할 변경** (드롭다운 선택)
  - 환경측정기업: ORG_ADMIN ↔ OPERATOR
  - 고객사: CUSTOMER_ADMIN ↔ CUSTOMER_USER
  - SUPER_ADMIN: 모든 역할 변경 가능
- ✅ 검색 및 필터링 (상태, 역할)
- ✅ 사용자 정보 조회 (이메일, 이름, 회사, 부서, 생성일)

**권한**: SUPER_ADMIN만 접근 가능

**특징**:
- **시스템 기본 역할(System Role)** 관리에 집중
- 계정 상태 관리 (PENDING, APPROVED, REJECTED, WITHDRAWN)
- 역할 변경 시 조직 경계를 넘지 않음 (환경측정기업 ↔ 고객사 간 변경 불가)

---

### 2. 권한 관리 (`/org/settings/users`)
**목적**: 사용자별 세부 권한 및 커스텀 역할 할당

**주요 기능**:
- ✅ **커스텀 역할 할당** (드롭다운 선택)
  - 기본 역할 대신 조직별 커스텀 역할 사용
  - SUPER_ADMIN은 커스텀 역할 할당 불가
- ✅ 접근 범위(Access Scope) 표시
  - SYSTEM, ORGANIZATION, GROUP, SITE, ASSIGNED, SELF
- ✅ 활성/비활성 상태 표시
- ✅ 검색 (이름, 이메일)

**권한**: ORG_ADMIN, SUPER_ADMIN 접근 가능

**특징**:
- **커스텀 역할(Custom Role)** 관리에 집중
- 시스템 역할은 읽기 전용으로 표시
- 조직별로 다른 권한 체계 적용 가능

---

### 3. 역할 관리 (`/org/settings/roles`)
**목적**: 커스텀 역할 템플릿 생성 및 관리

**주요 기능**:
- ✅ 역할 템플릿 조회
- ✅ 커스텀 역할 생성
- ✅ 커스텀 역할 수정/삭제
- ✅ 권한 코드 설정

**권한**: ORG_ADMIN, SUPER_ADMIN 접근 가능

---

## ⚠️ 발견된 문제점

### 🔴 1. 역할 변경 기능 중복
**문제**:
- **사용자 관리**: 시스템 역할(role) 변경 가능
- **권한 관리**: 커스텀 역할(customRoleId) 할당 가능
- 두 기능이 동시에 존재하여 혼란 발생 가능

**시나리오**:
1. 사용자 관리에서 사용자 A를 `OPERATOR`로 변경
2. 권한 관리에서 사용자 A에게 "선임 실무자" 커스텀 역할 할당
3. 결과: 시스템 역할과 커스텀 역할이 동시에 적용되어 권한 우선순위 불명확

**영향도**: 🔴 높음

---

### 🟡 2. 접근 경로 혼란
**문제**:
- 시스템 관리 대시보드(`/admin/system`)에서 "권한 관리" 카드가 `/org/settings/users`로 연결
- `/org/settings/*`는 환경측정기업 설정 경로인데, 시스템 관리자 메뉴에서 접근
- 경로 구조가 일관성 없음

**시나리오**:
- SUPER_ADMIN이 "권한 관리"를 클릭하면 `/org/settings/users`로 이동
- 이 경로는 조직(Organization) 설정 영역이므로 시스템 관리자 전용 기능과 혼재

**영향도**: 🟡 중간

---

### 🟡 3. 역할 관리 위치 불명확
**문제**:
- "역할 관리"가 `/org/settings/roles`에 위치
- 시스템 전체 역할 템플릿을 관리하는 기능인데 조직 설정 경로에 존재
- SUPER_ADMIN이 모든 조직의 역할 템플릿을 관리해야 하는지 불명확

**영향도**: 🟡 중간

---

### 🟢 4. 기능 설명 불일치
**문제**:
- 시스템 관리 대시보드 안내:
  - "사용자 관리: 전체 사용자 가입 승인 및 정보 관리"
  - "권한 관리: 사용자별 역할 할당 및 개별 권한 조정"
- 실제로는 사용자 관리에서도 역할 변경 가능

**영향도**: 🟢 낮음 (문서 수정으로 해결 가능)

---

## 💡 권장 해결 방안

### 방안 1: 역할 관리 기능 분리 (추천 ⭐)

#### A. 사용자 관리 (`/admin/users`)
**역할**: 계정 생명주기 관리
- 가입 승인/거부
- 사용자 삭제
- **시스템 역할 변경 제거** (읽기 전용으로 변경)
- 기본 정보 조회

#### B. 권한 관리 (`/admin/permissions` - 경로 변경)
**역할**: 역할 및 권한 통합 관리
- 시스템 역할 변경
- 커스텀 역할 할당
- 접근 범위 설정
- 개별 권한 조정

#### C. 역할 템플릿 관리 (`/admin/role-templates` - 경로 변경)
**역할**: 역할 템플릿 생성 및 관리
- 시스템 역할 템플릿 조회
- 커스텀 역할 생성/수정/삭제
- 권한 코드 설정

**장점**:
- 기능별 명확한 분리
- 경로 구조 일관성 확보 (`/admin/*`)
- 역할 변경 기능 단일화

**단점**:
- 기존 코드 리팩토링 필요
- 사용자 교육 필요

---

### 방안 2: 현재 구조 유지 + 문서화 강화

#### 수정 사항:
1. **사용자 관리**: 역할 변경 기능 유지, 설명 추가
   - "시스템 기본 역할만 변경 가능 (커스텀 역할은 권한 관리에서)"
2. **권한 관리**: 커스텀 역할 할당 기능 유지
   - "시스템 역할은 사용자 관리에서 변경"
3. **안내 메시지**: 두 페이지 간 차이점 명확히 표시

**장점**:
- 최소한의 코드 변경
- 즉시 적용 가능

**단점**:
- 근본적인 중복 문제 미해결
- 사용자 혼란 가능성 존재

---

### 방안 3: 하이브리드 접근 (단계적 개선)

#### Phase 1 (즉시):
- 사용자 관리에서 역할 변경 시 안내 메시지 추가
  - "기본 역할만 변경됩니다. 세부 권한은 권한 관리에서 조정하세요."
- 권한 관리 페이지 이름 변경: "사용자 권한 관리" → "세부 권한 설정"

#### Phase 2 (1개월 내):
- 경로 통합: `/org/settings/*` → `/admin/*`
- 역할 관리 페이지를 시스템 관리 영역으로 이동

#### Phase 3 (2개월 내):
- 역할 변경 기능을 권한 관리로 통합
- 사용자 관리는 계정 생명주기만 담당

**장점**:
- 점진적 개선으로 리스크 최소화
- 사용자 피드백 반영 가능

**단점**:
- 완료까지 시간 소요

---

## 📊 비교표

| 기능 | 사용자 관리 | 권한 관리 | 역할 관리 |
|------|------------|----------|----------|
| **경로** | `/admin/users` | `/org/settings/users` | `/org/settings/roles` |
| **권한** | SUPER_ADMIN | ORG_ADMIN, SUPER_ADMIN | ORG_ADMIN, SUPER_ADMIN |
| **가입 승인** | ✅ | ❌ | ❌ |
| **사용자 삭제** | ✅ | ❌ | ❌ |
| **시스템 역할 변경** | ✅ | ❌ (읽기 전용) | ❌ |
| **커스텀 역할 할당** | ❌ | ✅ | ❌ |
| **역할 템플릿 생성** | ❌ | ❌ | ✅ |
| **접근 범위 설정** | ❌ | ✅ (표시만) | ❌ |

---

## 🎯 최종 권장사항

### 우선순위 1: 즉시 적용 (방안 2)
1. 사용자 관리 페이지에 안내 메시지 추가
2. 권한 관리 페이지 설명 개선
3. 시스템 관리 대시보드 안내 문구 수정

### 우선순위 2: 단기 개선 (1개월, 방안 3 Phase 1-2)
1. 경로 구조 통일 (`/admin/*`)
2. 페이지 제목 및 설명 명확화
3. 사용자 가이드 문서 작성

### 우선순위 3: 중장기 개선 (2-3개월, 방안 1)
1. 역할 변경 기능 통합
2. 권한 관리 UI/UX 개선
3. 역할 기반 접근 제어(RBAC) 체계 정립

---

## 📝 결론

**현재 상태**:
- 사용자 관리와 권한 관리 간 **역할 변경 기능이 중복**되어 있음
- 경로 구조가 일관성 없음 (`/admin/*` vs `/org/settings/*`)
- 기능 설명과 실제 구현이 불일치

**충돌 여부**: 
- ⚠️ **기능적 충돌은 없으나, 사용자 혼란 가능성 높음**
- 시스템 역할과 커스텀 역할이 별도로 관리되므로 직접적인 충돌은 없음
- 그러나 두 곳에서 역할을 변경할 수 있어 일관성 문제 발생 가능

**권장 조치**:
1. **즉시**: 안내 메시지 추가 및 문서화
2. **단기**: 경로 구조 통일
3. **중장기**: 역할 관리 기능 통합

---

**작성일**: 2025-11-02  
**작성자**: Cascade AI  
**버전**: 1.0
