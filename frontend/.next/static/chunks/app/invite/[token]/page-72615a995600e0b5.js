(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8164],{6619:function(e,s,t){Promise.resolve().then(t.bind(t,6365))},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},6365:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n}});var a=t(7437),l=t(2265),r=t(9376);function n(){let e=(0,r.useRouter)(),s=(0,r.useParams)().token,[t,n]=(0,l.useState)(!0),[i,d]=(0,l.useState)(null),[c,m]=(0,l.useState)(""),[u,o]=(0,l.useState)(""),[x,h]=(0,l.useState)(""),[b,g]=(0,l.useState)(""),[v,N]=(0,l.useState)(""),[j,p]=(0,l.useState)(""),[y,f]=(0,l.useState)(""),[w,S]=(0,l.useState)(""),[k,R]=(0,l.useState)(!1);(0,l.useEffect)(()=>{C()},[s]);let C=async()=>{try{n(!0);let e=await fetch("/api/customer-invitations/".concat(s)),t=await e.json();e.ok?(d(t.invitation),t.invitation.adminEmail&&o(t.invitation.adminEmail),t.invitation.adminName&&N(t.invitation.adminName),t.invitation.adminPhone&&p(t.invitation.adminPhone),t.invitation.suggestedRole&&f(t.invitation.suggestedRole),t.invitation.customer.businessNumber&&S(t.invitation.customer.businessNumber)):m(t.error||"초대 정보를 불러올 수 없습니다.")}catch(e){m("초대 정보 조회 중 오류가 발생했습니다.")}finally{n(!1)}},D=async t=>{if(t.preventDefault(),!u||!x||!v||!j){alert("모든 필드를 입력해주세요.");return}if(x!==b){alert("비밀번호가 일치하지 않습니다.");return}if(x.length<8){alert("비밀번호는 최소 8자 이상이어야 합니다.");return}R(!0);try{let t=await fetch("/api/customer-invitations/".concat(s,"/accept"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,password:x,name:v,phone:j,role:y||"ADMIN",businessNumber:w.trim()||void 0})}),a=await t.json();t.ok?(alert("가입이 완료되었습니다! 로그인해주세요."),e.push("/login")):alert(a.error||"가입 실패")}catch(e){alert("가입 중 오류가 발생했습니다.")}finally{R(!1)}};return t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsx)("div",{className:"text-gray-500",children:"로딩 중..."})}):c||!i?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"❌"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"초대 링크 오류"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:c}),(0,a.jsx)("button",{onClick:()=>e.push("/"),className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"홈으로 이동"})]})})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-2xl w-full",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"text-5xl mb-4",children:"\uD83C\uDF89"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"고객사 초대"}),(0,a.jsxs)("p",{className:"text-gray-600",children:[(0,a.jsx)("span",{className:"font-semibold text-blue-600",children:i.organization.name}),"에서 귀하를 초대했습니다"]})]}),(0,a.jsx)("div",{className:"border-t border-b border-gray-200 py-4 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"고객사"}),(0,a.jsx)("div",{className:"font-medium",children:i.customer.name}),i.customer.fullName&&(0,a.jsx)("div",{className:"text-sm text-gray-600",children:i.customer.fullName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"사업자등록번호"}),(0,a.jsx)("div",{className:"font-medium",children:i.customer.businessNumber})]}),i.customer.industry&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"업종"}),(0,a.jsx)("div",{className:"font-medium",children:i.customer.industry})]}),i.customer.address&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"주소"}),(0,a.jsx)("div",{className:"font-medium",children:i.customer.address})]})]})}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded p-4",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCA1 회원가입을 완료하면 ",(0,a.jsx)("strong",{children:i.organization.name}),"와 자동으로 연결되며, 측정 데이터를 실시간으로 확인할 수 있습니다."]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"회원가입"}),(0,a.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"이메일 *"}),(0,a.jsx)("input",{type:"email",value:u,onChange:e=>o(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"example@company.com",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"이름 *"}),(0,a.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"홍길동",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"전화번호 *"}),(0,a.jsx)("input",{type:"tel",value:j,onChange:e=>p(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"010-1234-5678",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"역할 선택 *"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"role",value:"ADMIN",checked:"ADMIN"===y||!y&&(null==i?void 0:i.suggestedRole)==="ADMIN",onChange:e=>f(e.target.value),className:"mr-2"}),(0,a.jsx)("span",{children:"관리자 (CUSTOMER_ADMIN)"}),(null==i?void 0:i.suggestedRole)==="ADMIN"&&(0,a.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"(권장)"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"role",value:"USER",checked:"USER"===y||!y&&(null==i?void 0:i.suggestedRole)==="USER",onChange:e=>f(e.target.value),className:"mr-2"}),(0,a.jsx)("span",{children:"일반 사용자 (CUSTOMER_USER)"}),(null==i?void 0:i.suggestedRole)==="USER"&&(0,a.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"(권장)"})]})]}),(null==i?void 0:i.roleNote)&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["힌트: ",i.roleNote]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"사업자등록번호 (선택)"}),(0,a.jsx)("input",{type:"text",value:w,onChange:e=>S(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"123-45-67890"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"모르면 비워두세요. 나중에 추가할 수 있습니다."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비밀번호 * (최소 8자)"}),(0,a.jsx)("input",{type:"password",value:x,onChange:e=>h(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"••••••••",minLength:8,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비밀번호 확인 *"}),(0,a.jsx)("input",{type:"password",value:b,onChange:e=>g(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"••••••••",minLength:8,required:!0})]}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsx)("button",{type:"submit",disabled:k,className:"w-full bg-blue-600 text-white px-4 py-3 rounded font-medium hover:bg-blue-700 disabled:bg-gray-400",children:k?"가입 중...":"회원가입 및 연결하기"})})]}),(0,a.jsxs)("div",{className:"mt-6 text-center text-sm text-gray-500",children:["이미 계정이 있으신가요?"," ",(0,a.jsx)("a",{href:"/login",className:"text-blue-600 hover:text-blue-700",children:"로그인"})]})]}),(0,a.jsxs)("div",{className:"mt-4 text-center text-sm text-gray-500",children:["이 초대 링크는 ",new Date(i.expiresAt).toLocaleDateString(),"까지 유효합니다."]})]})})}}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=6619)}),_N_E=e.O()}]);