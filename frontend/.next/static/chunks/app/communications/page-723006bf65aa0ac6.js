(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[773],{8446:function(e,t,a){Promise.resolve().then(a.bind(a,5999))},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5999:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var r=a(7437),s=a(2265),d=a(605),l=a(9376),n=a(6334),c=a(5685),i=a(9397),x=a(2827),o=a(6819);function g(e){let{isOpen:t,onClose:a,onSuccess:l,initialShareType:c=!0}=e,{data:i}=(0,d.useSession)(),g=null==i?void 0:i.user,h=(null==g?void 0:g.role)==="CUSTOMER_ADMIN"||(null==g?void 0:g.role)==="CUSTOMER_USER",[u,m]=(0,s.useState)({customerId:"",contactAt:new Date().toISOString().slice(0,16),channel:"PHONE",subject:"",content:"",priority:"NORMAL",assignedToId:"",contactPerson:"",contactOrg:"",isShared:!0}),[y,b]=(0,s.useState)([]),[p,j]=(0,s.useState)([]),[k,N]=(0,s.useState)(!1),[v,f]=(0,s.useState)("");(0,s.useEffect)(()=>{t&&(h||(w(),D()),m({customerId:"",contactAt:new Date().toISOString().slice(0,16),channel:"PHONE",subject:"",content:"",priority:"NORMAL",assignedToId:"",contactPerson:"",contactOrg:"",isShared:c}),f(""))},[t,h]);let w=async()=>{try{let e=await fetch("/api/customers?tab=all"),t=await e.json();e.ok&&b(t.customers||[])}catch(e){}},D=async()=>{try{let e=await fetch("/api/org/staff"),t=await e.json();e.ok&&j(t.staff||[])}catch(e){}},S=(e,t)=>{m(a=>({...a,[e]:t}))},C=async e=>{if(e.preventDefault(),f(""),!h&&!u.customerId){f("고객사를 선택해주세요");return}if(!u.content.trim()){f("내용을 입력해주세요");return}N(!0);try{let e=await fetch("/api/communications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),t=await e.json();e.ok?l():f(t.error||"등록 실패")}catch(e){f("등록 중 오류가 발생했습니다")}finally{N(!1)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto m-4",children:[(0,r.jsx)("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h?"요청사항 등록":"커뮤니케이션 등록"})}),(0,r.jsxs)("form",{onSubmit:C,className:"p-6 space-y-4",children:[v&&(0,r.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:v}),!h&&(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"공유 범위"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",checked:!0===u.isShared,onChange:()=>S("isShared",!0),className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:"고객사 공유"})]}),(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",checked:!1===u.isShared,onChange:()=>S("isShared",!1),disabled:!1===c,className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:"내부 전용"})]})]}),!1===c&&!1===u.isShared&&(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"* 내부 전용은 고객사 공유로만 변경 가능합니다"})]}),!h&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["고객사 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)(o.Z,{value:u.customerId,onChange:e=>S("customerId",e.target.value),required:!0,children:[(0,r.jsx)("option",{value:"",children:"선택하세요"}),y.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["소통 일시 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)(x.Z,{type:"datetime-local",value:u.contactAt,onChange:e=>S("contactAt",e.target.value),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["채널 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)(o.Z,{value:u.channel,onChange:e=>S("channel",e.target.value),required:!0,children:[(0,r.jsx)("option",{value:"PHONE",children:"\uD83D\uDCDE 전화"}),(0,r.jsx)("option",{value:"EMAIL",children:"\uD83D\uDCE7 이메일"}),(0,r.jsx)("option",{value:"VISIT",children:"\uD83D\uDC64 방문"}),(0,r.jsx)("option",{value:"KAKAO",children:"\uD83D\uDCAC 카톡"}),(0,r.jsx)("option",{value:"SMS",children:"\uD83D\uDCF1 SMS"}),(0,r.jsx)("option",{value:"FAX",children:"\uD83D\uDCE0 팩스"}),(0,r.jsx)("option",{value:"OTHER",children:"기타"})]})]})]}),!h&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"우선순위"}),(0,r.jsxs)(o.Z,{value:u.priority,onChange:e=>S("priority",e.target.value),children:[(0,r.jsx)("option",{value:"URGENT",children:"\uD83D\uDD34 긴급"}),(0,r.jsx)("option",{value:"HIGH",children:"\uD83D\uDFE0 높음"}),(0,r.jsx)("option",{value:"NORMAL",children:"⚪ 보통"}),(0,r.jsx)("option",{value:"LOW",children:"\uD83D\uDD35 낮음"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["상대방 조직명 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)(x.Z,{value:u.contactOrg,onChange:e=>S("contactOrg",e.target.value),placeholder:h?"측정기업명":"고객사명",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["상대방 담당자명 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)(x.Z,{value:u.contactPerson,onChange:e=>S("contactPerson",e.target.value),placeholder:"담당자 이름",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"제목"}),(0,r.jsx)(x.Z,{value:u.subject,onChange:e=>S("subject",e.target.value),placeholder:"제목을 입력하세요 (선택사항)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["내용 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{value:u.content,onChange:e=>S("content",e.target.value),placeholder:"소통 내용을 입력하세요",rows:6,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),!h&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"담당자 지정"}),(0,r.jsxs)(o.Z,{value:u.assignedToId,onChange:e=>S("assignedToId",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"선택 안 함"}),p.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},e.id))]})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsx)(n.Z,{type:"submit",disabled:k,className:"flex-1",children:k?"등록 중...":"등록"}),(0,r.jsx)(n.Z,{type:"button",variant:"secondary",onClick:a,disabled:k,className:"flex-1",children:"취소"})]})]})]})}):null}var h=a(5254);let u={PHONE:"\uD83D\uDCDE 전화",EMAIL:"\uD83D\uDCE7 이메일",VISIT:"\uD83D\uDC64 방문",KAKAO:"\uD83D\uDCAC 카톡",SMS:"\uD83D\uDCF1 SMS",FAX:"\uD83D\uDCE0 팩스",OTHER:"기타"},m={PENDING:{label:"답변대기",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"},IN_PROGRESS:{label:"대화중",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"},COMPLETED:{label:"완료",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"},REFERENCE:{label:"참고",color:"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300"}},y={URGENT:{label:"긴급",icon:"\uD83D\uDD34"},HIGH:{label:"높음",icon:"\uD83D\uDFE0"},NORMAL:{label:"보통",icon:"⚪"},LOW:{label:"낮음",icon:"\uD83D\uDD35"}},b=(e,t)=>"PENDING"!==e||t?m[e]:{label:"완료전",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"};function p(){let{data:e,status:t}=(0,d.useSession)(),a=(0,l.useRouter)(),[x,o]=(0,s.useState)([]),[p,j]=(0,s.useState)(!0),[k,N]=(0,s.useState)(!1),[v,f]=(0,s.useState)(!1),[w,D]=(0,s.useState)(!0),[S,C]=(0,s.useState)(!1),[E,O]=(0,s.useState)(""),[I,R]=(0,s.useState)(""),[A,T]=(0,s.useState)(""),[M,P]=(0,s.useState)(""),[_,Z]=(0,s.useState)(""),[L,H]=(0,s.useState)(new Set),G=null==e?void 0:e.user,z=(null==G?void 0:G.role)==="CUSTOMER_ADMIN"||(null==G?void 0:G.role)==="CUSTOMER_USER";(0,s.useEffect)(()=>{if("unauthenticated"===t){a.push("/login");return}"authenticated"===t&&U()},[t,a,I,A,E,M,_]);let U=async()=>{try{j(!0);let e=new URLSearchParams;I&&e.append("status",I),A&&e.append("channel",A),E&&e.append("search",E),M&&e.append("startDate",M),_&&e.append("endDate",_);let t=await fetch("/api/communications?".concat(e.toString())),a=await t.json();t.ok&&o(a.data||[])}catch(e){}finally{j(!1)}},F=async e=>{if(0===L.size){alert("변경할 항목을 선택해주세요");return}if(confirm("선택한 ".concat(L.size,"건을 ").concat(m[e].label," 상태로 변경하시겠습니까?")))try{let t=await fetch("/api/communications/bulk-status",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(L),status:e})}),a=await t.json();t.ok?(alert("".concat(a.updated,"건이 변경되었습니다")),H(new Set),U()):alert("변경 실패: ".concat(a.error))}catch(e){alert("상태 변경 중 오류가 발생했습니다")}},K=e=>{let t=new Set(L);t.has(e)?t.delete(e):t.add(e),H(t)};return"loading"===t||p?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"text-gray-500",children:"로딩 중..."})}):(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold whitespace-nowrap mb-1.5",children:z?"소통 내역":"고객 소통"}),(0,r.jsx)("span",{className:"text-gray-300 dark:text-gray-600 mb-1.5",children:"|"}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"140px",minWidth:"140px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"검색"}),(0,r.jsx)("input",{type:"text",value:E,onChange:e=>O(e.target.value),placeholder:"제목, 내용...",className:"text-sm h-8 px-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"120px",minWidth:"120px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"상태"}),(0,r.jsxs)("select",{value:I,onChange:e=>R(e.target.value),className:"text-sm h-8 px-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,r.jsx)("option",{value:"",children:"상태:전체"}),(0,r.jsx)("option",{value:"PENDING",children:"답변대기"}),(0,r.jsx)("option",{value:"IN_PROGRESS",children:"대화중"}),(0,r.jsx)("option",{value:"COMPLETED",children:"완료"}),(0,r.jsx)("option",{value:"REFERENCE",children:"참고"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"120px",minWidth:"120px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"채널"}),(0,r.jsxs)("select",{value:A,onChange:e=>T(e.target.value),className:"text-sm h-8 px-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,r.jsx)("option",{value:"",children:"전체"}),(0,r.jsx)("option",{value:"PHONE",children:"전화"}),(0,r.jsx)("option",{value:"EMAIL",children:"이메일"}),(0,r.jsx)("option",{value:"VISIT",children:"방문"}),(0,r.jsx)("option",{value:"KAKAO",children:"카톡"}),(0,r.jsx)("option",{value:"SMS",children:"SMS"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"140px",minWidth:"140px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"시작일"}),(0,r.jsx)("input",{type:"date",value:M,onChange:e=>P(e.target.value),className:"text-sm h-8 px-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"140px",minWidth:"140px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"종료일"}),(0,r.jsx)("input",{type:"date",value:_,onChange:e=>Z(e.target.value),className:"text-sm h-8 px-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2 ml-auto",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 px-3 py-1 flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"전체"}),(0,r.jsx)("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:x.length})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 px-3 py-1 flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"답변대기"}),(0,r.jsx)("span",{className:"text-sm font-bold text-yellow-600 dark:text-yellow-400",children:x.filter(e=>"PENDING"===e.status).length})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 px-3 py-1 flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"완료"}),(0,r.jsx)("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:x.filter(e=>"COMPLETED"===e.status).length})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 px-3 py-1 flex items-center gap-1.5",children:[(0,r.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"긴급"}),(0,r.jsx)("span",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:x.filter(e=>"URGENT"===e.priority).length})]}),(0,r.jsxs)("button",{onClick:()=>C(!0),className:"px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition-colors flex items-center gap-1",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4"}),"도움말"]}),(0,r.jsxs)(n.Z,{onClick:()=>{z?N(!0):f(!0)},size:"sm",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-1"}),z?"요청 등록":"등록"]})]})]})}),!z&&L.size>0&&(0,r.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-300",children:[L.size,"건 선택됨"]}),(0,r.jsx)(n.Z,{size:"sm",variant:"secondary",onClick:()=>F("COMPLETED"),children:"완료 처리"}),(0,r.jsx)(n.Z,{size:"sm",variant:"secondary",onClick:()=>F("REFERENCE"),children:"참고 처리"}),(0,r.jsx)(n.Z,{size:"sm",variant:"secondary",onClick:()=>H(new Set),children:"선택 해제"})]})}),(0,r.jsxs)("div",{className:"hidden md:block bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)("tr",{children:[!z&&(0,r.jsx)("th",{className:"px-4 py-3 text-left",children:(0,r.jsx)("input",{type:"checkbox",checked:L.size===x.length&&x.length>0,onChange:()=>{L.size===x.length?H(new Set):H(new Set(x.map(e=>e.id)))},className:"rounded"})}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"일시"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:z?"환경측정기업":"고객사"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"채널"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"내용"}),!z&&(0,r.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"공유범위"}),(0,r.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"우선순위"}),(0,r.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"상태"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:x.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer",onClick:()=>a.push("/communications/".concat(e.id)),children:[!z&&(0,r.jsx)("td",{className:"px-4 py-3",onClick:e=>e.stopPropagation(),children:(0,r.jsx)("input",{type:"checkbox",checked:L.has(e.id),onChange:()=>K(e.id),className:"rounded"})}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white whitespace-nowrap",children:new Date(e.contactAt).toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:z?e.contactOrg||"-":e.customer.name}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:u[e.channel]}),(0,r.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white max-w-md",children:[(0,r.jsx)("div",{className:"font-medium",children:e.subject||"(제목 없음)"}),(0,r.jsxs)("div",{className:"text-gray-500 dark:text-gray-400 truncate",children:[e.content.substring(0,50),e.content.length>50&&"..."]}),(e._count.notes>0||e._count.attachments>0)&&(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[e._count.notes>0&&"\uD83D\uDCAC ".concat(e._count.notes),e._count.attachments>0&&" \uD83D\uDCCE ".concat(e._count.attachments)]})]}),!z&&(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded font-medium ".concat(e.isShared?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300"),children:e.isShared?"고객사 공유":"내부전용"})}),(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded font-medium ".concat("URGENT"===e.priority?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"HIGH"===e.priority?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300":"NORMAL"===e.priority?"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"),children:y[e.priority].label})}),(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(b(e.status,e.isShared).color),children:b(e.status,e.isShared).label})})]},e.id))})]})}),0===x.length&&(0,r.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"등록된 커뮤니케이션이 없습니다"})]}),(0,r.jsxs)("div",{className:"md:hidden space-y-3",children:[x.map(e=>(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 space-y-3",onClick:()=>a.push("/communications/".concat(e.id)),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(b(e.status,e.isShared).color),children:b(e.status,e.isShared).label}),(0,r.jsx)("span",{className:"text-lg",children:y[e.priority].icon})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.contactAt).toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white mb-1",children:e.subject||"(제목 없음)"}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:e.content})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsxs)("div",{children:["\uD83C\uDFE2 ",e.customer.name]}),(0,r.jsx)("div",{children:u[e.channel]}),!z&&(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded font-medium ".concat(e.isShared?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300"),children:e.isShared?"고객사 공유":"내부전용"})}),e.assignedTo&&(0,r.jsxs)("div",{children:["\uD83D\uDC64 ",e.assignedTo.name]}),(e._count.notes>0||e._count.attachments>0)&&(0,r.jsxs)("div",{children:[e._count.notes>0&&"\uD83D\uDCAC ".concat(e._count.notes," "),e._count.attachments>0&&"\uD83D\uDCCE ".concat(e._count.attachments)]})]})]},e.id)),0===x.length&&(0,r.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"등록된 커뮤니케이션이 없습니다"})]}),v&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"소통 내역 유형 선택"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:"등록할 소통 내역의 공유 범위를 선택해주세요"}),(0,r.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,r.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 border-blue-500 bg-blue-50 dark:bg-blue-900/20",children:[(0,r.jsx)("input",{type:"radio",name:"shareType",checked:!0===w,onChange:()=>D(!0),className:"mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"고객사 공유"}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"고객사가 확인할 수 있는 소통 내역"})]})]}),(0,r.jsxs)("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 border-gray-300 dark:border-gray-600",children:[(0,r.jsx)("input",{type:"radio",name:"shareType",checked:!1===w,onChange:()=>D(!1),className:"mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"내부 전용"}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"환경측정기업 내부에서만 확인 가능"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(n.Z,{variant:"secondary",onClick:()=>f(!1),className:"flex-1",children:"취소"}),(0,r.jsx)(n.Z,{onClick:()=>{f(!1),N(!0)},className:"flex-1",children:"확인"})]})]})}),(0,r.jsx)(g,{isOpen:k,onClose:()=>N(!1),onSuccess:()=>{N(!1),U()},initialShareType:w}),(0,r.jsx)(h.Z,{isOpen:S,onClose:()=>C(!1)})]})}},2827:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(7437);function s(e){let{className:t="",...a}=e;return(0,r.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...a})}a(2265)},6819:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(7437);function s(e){let{className:t="",children:a,...s}=e;return(0,r.jsx)("select",{className:"".concat("w-full rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...s,children:a})}a(2265)}},function(e){e.O(0,[605,115,2971,2117,1744],function(){return e(e.s=8446)}),_N_E=e.O()}]);