(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1955],{9049:function(e,t,s){Promise.resolve().then(s.bind(s,8319))},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},8319:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var r=s(7437),a=s(2265),l=s(2397),i=s(2827),n=s(6819),d=s(6334),c=s(4755),o=s(9548),x=s(8776),m=s(3158);function u(e){let{isOpen:t,onClose:s,title:a,message:l,type:i="info"}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:s,children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("div",{className:"rounded-t-lg border-b p-4 ".concat({success:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-900/30 text-green-900 dark:text-green-200",error:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-900/30 text-red-900 dark:text-red-200",warning:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-900/30 text-yellow-900 dark:text-yellow-200",info:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-900/30 text-blue-900 dark:text-blue-200"}[i]),children:(0,r.jsxs)("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-2xl",children:{success:"✅",error:"❌",warning:"⚠️",info:"ℹ️"}[i]}),a]})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:l})}),(0,r.jsx)("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"확인"})})]})}):null}var h=s(1515);function g(){let{user:e}=(0,l.a)(),[t,s]=(0,a.useState)(!1),[x,m]=(0,a.useState)([]),[u,g]=(0,a.useState)(0),[b,j]=(0,a.useState)(1),[y,p]=(0,a.useState)(50),v=()=>{let e=new Date,t=new Date;return t.setMonth(e.getMonth()-1),{start:t.toISOString().split("T")[0],end:e.toISOString().split("T")[0]}},N=(0,a.useMemo)(()=>v(),[]),[f,k]=(0,a.useState)(""),[w,D]=(0,a.useState)("전체"),[S,C]=(0,a.useState)("전체"),[T,O]=(0,a.useState)(N.start),[E,A]=(0,a.useState)(N.end),{list:I}=(0,c.n)(),_=(0,a.useMemo)(()=>{var e;return"전체"===w?void 0:null===(e=I.find(e=>e.name===w))||void 0===e?void 0:e.id},[w,I]),{list:M}=(0,o.D)(_),[z,P]=(0,a.useState)(new Set),Z=async()=>{s(!0);try{let t=new URLSearchParams;if(T&&t.append("startDate",T),E&&t.append("endDate",E),_&&t.append("customerId",_),"전체"!==S){var e;let s=null===(e=M.find(e=>e.name===S))||void 0===e?void 0:e.id;s&&t.append("stackId",s)}t.append("page",b.toString()),t.append("limit",y.toString());let s=await fetch("/api/measurements-temp?".concat(t.toString())),r=await s.json();s.ok?(m(r.data||[]),g(r.total||0)):(m([]),g(0))}catch(e){m([]),g(0)}finally{s(!1)}};(0,a.useEffect)(()=>{Z()},[b,T,E,w,S]);let F=e=>{e?P(new Set(x.map(e=>e.id))):P(new Set)},R=(e,t)=>{let s=new Set(z);t?s.add(e):s.delete(e),P(s)},L=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{let t=await fetch("/api/measurements-temp/".concat(e),{method:"DELETE"});if(t.ok)alert("삭제되었습니다."),Z();else{let e=await t.json();alert(e.error||"삭제 실패")}}catch(e){alert(e.message||"삭제 중 오류가 발생했습니다.")}},U=async()=>{if(0===z.size){alert("삭제할 항목을 선택해주세요.");return}if(confirm("선택한 ".concat(z.size,"건을 삭제하시겠습니까?")))try{let e=await fetch("/api/measurements-temp/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(z)})}),t=await e.json();e.ok?(alert(t.message||"삭제되었습니다."),P(new Set),Z()):alert(t.error||"삭제 실패")}catch(e){alert(e.message||"삭제 중 오류가 발생했습니다.")}},Y=async()=>{if(0===z.size){alert("확정할 항목을 선택해주세요.");return}if(confirm("선택한 ".concat(z.size,"건을 확정하시겠습니까?\n\n확정된 데이터는 측정 이력 및 대시보드에 반영됩니다."))){s(!0);try{let e=await fetch("/api/measurements-temp/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(z)})}),t=await e.json();e.ok?(alert(t.message||"확정되었습니다."),P(new Set),Z()):alert(t.error||"확정 실패")}catch(e){alert(e.message||"확정 중 오류가 발생했습니다.")}finally{s(!1)}}},W=async()=>{if(0!==z.size||confirm("전체 데이터를 다운로드하시겠습니까?"))try{let e=await fetch("/api/measurements-temp/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(z)})});if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s;let a=new Date,l="임시측정데이터_".concat(a.getFullYear()).concat(String(a.getMonth()+1).padStart(2,"0")).concat(String(a.getDate()).padStart(2,"0"),"_").concat(String(a.getHours()).padStart(2,"0")).concat(String(a.getMinutes()).padStart(2,"0")).concat(String(a.getSeconds()).padStart(2,"0"),".csv");r.download=l,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r)}else{let t=await e.json();alert(t.error||"다운로드 실패")}}catch(e){alert(e.message||"다운로드 중 오류가 발생했습니다.")}},B=Math.ceil(u/y);return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"176px",minWidth:"176px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"고객사"}),(0,r.jsx)(n.Z,{className:"text-sm h-8 w-full",value:w,onChange:e=>{D(e.target.value),C("전체"),j(1)},children:["전체",...I.map(e=>e.name)].map(e=>(0,r.jsx)("option",{children:e},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"176px",minWidth:"176px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"굴뚝명"}),(0,r.jsx)(n.Z,{className:"text-sm h-8 w-full",value:S,onChange:e=>{C(e.target.value),j(1)},children:["전체",..._?M.map(e=>e.name):[]].map(e=>(0,r.jsx)("option",{children:e},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"시작일"}),(0,r.jsx)(i.Z,{className:"text-sm h-8",style:{width:"144px",minWidth:"144px"},type:"date",value:T,onChange:e=>{O(e.target.value),j(1)}})]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mb-1.5",children:"~"}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"종료일"}),(0,r.jsx)(i.Z,{className:"text-sm h-8",style:{width:"144px",minWidth:"144px"},type:"date",value:E,onChange:e=>{A(e.target.value),j(1)}})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{width:"158px",minWidth:"158px"},children:[(0,r.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"한페이지당"}),(0,r.jsxs)(n.Z,{className:"text-sm h-8 w-full",value:String(y),onChange:e=>{let t=e.target.value;p("ALL"===t?999999:Number(t)),j(1)},children:[(0,r.jsx)("option",{value:"50",children:"50"}),(0,r.jsx)("option",{value:"100",children:"100"}),(0,r.jsx)("option",{value:"200",children:"200"}),(0,r.jsx)("option",{value:"ALL",children:"전체"})]})]}),(0,r.jsxs)("div",{className:"flex gap-1.5 ml-auto mb-1.5",children:[(0,r.jsx)(d.Z,{size:"sm",variant:"secondary",onClick:()=>{k(""),D("전체"),C("전체"),O(N.start),A(N.end),j(1),Z()},children:"초기화"}),(0,r.jsx)(d.Z,{size:"sm",onClick:Y,className:"bg-blue-600 hover:bg-blue-700",disabled:t,children:t?"처리중...":"확정"}),(0,r.jsx)(d.Z,{size:"sm",onClick:W,className:"bg-green-600 hover:bg-green-700",children:"Excel"}),(0,r.jsx)(d.Z,{size:"sm",variant:"secondary",onClick:U,className:"bg-red-600 hover:bg-red-700 text-white",children:"삭제"})]})]})}),(0,r.jsxs)("div",{className:"hidden md:block rounded-lg border overflow-x-auto max-h-[calc(100vh-180px)] overflow-y-auto",children:[0!==x.length||t?(0,r.jsxs)(h.iA,{className:"min-w-[1200px]",children:[(0,r.jsx)(h.hr,{className:"bg-gray-50 dark:bg-white/10 sticky top-0 z-10",children:(0,r.jsxs)(h.Tr,{children:[(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:(0,r.jsx)("input",{type:"checkbox",checked:x.length>0&&z.size===x.length,onChange:e=>F(e.target.checked),className:"accent-blue-500"})}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"임시ID"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"측정일자"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"고객사"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"배출구명"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"기상"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"기온℃"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"습도％"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"기압mmHg"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"풍향"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"풍속m／sec"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"가스속도m／s"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"가스온도℃"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"수분함량％"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"실측산소농도％"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"표준산소농도％"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"배출가스유량S㎥／min"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"오염물질"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"농도"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"배출허용기준농도"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"배출허용기준체크"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"측정업체"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"입력자"}),(0,r.jsx)(h.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"액션"})]})}),(0,r.jsx)(h.p3,{children:t?(0,r.jsx)(h.Tr,{children:(0,r.jsx)(h.Td,{colSpan:24,className:"text-center py-8 text-gray-500",children:"로딩 중..."})}):x.map((e,t)=>{var s;return(0,r.jsxs)(h.Tr,{children:[(0,r.jsx)(h.Td,{children:(0,r.jsx)("input",{type:"checkbox",checked:z.has(e.id),onChange:t=>R(e.id,t.target.checked),className:"accent-blue-500"})}),(0,r.jsx)(h.Td,{className:"font-mono text-xs",style:{maxWidth:"100px"},children:(0,r.jsx)("div",{className:"break-words",children:e.tempId})}),(0,r.jsx)(h.Td,{style:{maxWidth:"90px"},children:(0,r.jsx)("div",{className:"text-xs break-words",children:e.measuredAt})}),(0,r.jsx)(h.Td,{children:e.customer}),(0,r.jsx)(h.Td,{children:e.stack}),(0,r.jsx)(h.Td,{children:e.weather}),(0,r.jsx)(h.Td,{children:e.temp}),(0,r.jsx)(h.Td,{children:e.humidity}),(0,r.jsx)(h.Td,{children:e.pressure}),(0,r.jsx)(h.Td,{children:e.windDir}),(0,r.jsx)(h.Td,{children:e.windSpeed}),(0,r.jsx)(h.Td,{children:e.gasVel}),(0,r.jsx)(h.Td,{children:e.gasTemp}),(0,r.jsx)(h.Td,{children:e.moisture}),(0,r.jsx)(h.Td,{children:e.o2Measured}),(0,r.jsx)(h.Td,{children:e.o2Standard}),(0,r.jsx)(h.Td,{children:e.flowRate}),(0,r.jsx)(h.Td,{children:e.pollutant}),(0,r.jsx)(h.Td,{children:e.value}),(0,r.jsx)(h.Td,{children:null!==(s=e.limit)&&void 0!==s?s:""}),(0,r.jsx)(h.Td,{children:e.limitCheck}),(0,r.jsx)(h.Td,{children:e.company}),(0,r.jsx)(h.Td,{children:e.createdBy}),(0,r.jsx)(h.Td,{children:(0,r.jsx)("button",{onClick:()=>L(e.id),className:"text-xs text-red-600 hover:underline",children:"삭제"})})]},"".concat(e.tempId,"_").concat(e.pollutant,"_").concat(t))})})]}):(0,r.jsx)("div",{className:"p-6 text-sm text-gray-500",children:"조건에 맞는 데이터가 없습니다."}),(0,r.jsxs)("div",{className:"p-3 flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsxs)("div",{children:["총 ",u,"건 \xb7 ",b,"/",B," 페이지"]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(d.Z,{variant:"secondary",size:"sm",onClick:()=>j(e=>Math.max(1,e-1)),disabled:1===b,children:"이전"}),(0,r.jsx)(d.Z,{variant:"secondary",size:"sm",onClick:()=>j(e=>Math.min(B,e+1)),disabled:b===B,children:"다음"})]})]})]}),(0,r.jsx)("div",{className:"md:hidden space-y-3",children:t?(0,r.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6 text-center text-gray-500",children:"로딩 중..."}):0===x.length?(0,r.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6 text-center text-gray-500",children:"조건에 맞는 데이터가 없습니다."}):(0,r.jsxs)(r.Fragment,{children:[x.map((e,t)=>{var s;return(0,r.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:z.has(e.id),onChange:t=>R(e.id,t.target.checked),className:"accent-blue-500 mt-1"}),(0,r.jsx)("button",{onClick:()=>L(e.id),className:"text-xs text-red-600 hover:underline",children:"삭제"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCCD 고객사:"})," ",e.customer]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDFED 굴뚝:"})," ",e.stack]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCC5 측정일:"})," ",e.measuredAt]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83E\uDDEA 오염물질:"})," ",e.pollutant]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCCA 농도:"})," ",e.value]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"⚠️ 기준:"})," ",null!==(s=e.limit)&&void 0!==s?s:"-"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"✅ 체크:"})," ",e.limitCheck]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDF24️ 기상:"})," ",e.weather||"-"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDF21️ 기온:"})," ",e.temp||"-","℃"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCA7 습도:"})," ",e.humidity||"-","%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDF9A️ 기압:"})," ",e.pressure||"-","mmHg"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83E\uDDED 풍향:"})," ",e.windDir||"-"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCA8 풍속:"})," ",e.windSpeed||"-","m/s"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDD25 가스온도:"})," ",e.gasTemp||"-","℃"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCA8 가스속도:"})," ",e.gasVel||"-","m/s"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCA7 수분:"})," ",e.moisture||"-","%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83E\uDEE7 실측O₂:"})," ",e.o2Measured||"-","%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83E\uDEE7 표준O₂:"})," ",e.o2Standard||"-","%"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDF0A 유량:"})," ",e.flowRate||"-","S㎥/min"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDFE2 업체:"})," ",e.company]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDC64 입력자:"})," ",e.createdBy]}),(0,r.jsxs)("div",{className:"col-span-2 text-xs text-gray-400 font-mono break-all",children:["ID: ",e.tempId]})]})]},"".concat(e.tempId,"_").concat(e.pollutant,"_").concat(t))}),(0,r.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-3 flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsxs)("div",{children:["총 ",u,"건 \xb7 ",b,"/",B," 페이지"]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(d.Z,{variant:"secondary",size:"sm",onClick:()=>j(e=>Math.max(1,e-1)),disabled:1===b,children:"이전"}),(0,r.jsx)(d.Z,{variant:"secondary",size:"sm",onClick:()=>j(e=>Math.min(B,e+1)),disabled:b===B,children:"다음"})]})]})]})})]})}var b=s(8653);function j(e){let{isOpen:t,onClose:s,onConfirm:a,inputValue:l,lowerBound:i,upperBound:n,itemName:d}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md shadow-xl",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"측정값 확인 필요"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:["입력하신 ",(0,r.jsx)("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:d})," 값(",l.toFixed(2),")이 예상 범위(",(0,r.jsxs)("span",{className:"font-medium",children:[i.toFixed(2)," ~ ",n.toFixed(2)]}),")를 벗어났습니다."]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 mb-4",children:[(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"\uD83D\uDCA1 확인이 필요한 사항:"}),(0,r.jsxs)("ul",{className:"text-xs text-gray-700 dark:text-gray-300 space-y-1",children:[(0,r.jsx)("li",{children:"• 측정 장비의 상태를 확인해주세요"}),(0,r.jsx)("li",{children:"• 측정 조건을 재확인해주세요"}),(0,r.jsx)("li",{children:"• 실제 배출 상황을 점검해주세요"})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"이대로 저장하시겠습니까?"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"취소"}),(0,r.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"확인하고 저장"})]})]})}):null}function y(){let{user:e}=(0,l.a)(),t=null==e?void 0:e.role,[s,h]=(0,a.useState)("field"),[y,p]=(0,a.useState)(!1),[v,N]=(0,a.useState)({}),[f,k]=(0,a.useState)(new Set),{dateStr:w,timeStr:D}=(()=>{let e=new Date;return{dateStr:e.toISOString().split("T")[0],timeStr:e.toTimeString().slice(0,5)}})(),[S,C]=(0,a.useState)(w),[T,O]=(0,a.useState)(D),{list:E}=(0,c.n)(),[A,I]=(0,a.useState)(""),_=(0,a.useMemo)(()=>{var e;return null===(e=E.find(e=>e.name===A))||void 0===e?void 0:e.id},[E,A]),{list:M}=(0,o.D)(_),[z,P]=(0,a.useState)(""),Z=(0,a.useMemo)(()=>{var e;return null===(e=M.find(e=>e.name===z))||void 0===e?void 0:e.id},[M,z]),[F,R]=(0,a.useState)("보아스환경기술"),{items:L}=(0,x.F)(),[U,Y]=(0,a.useState)([]),[W,B]=(0,a.useState)(!1);(0,a.useEffect)(()=>{Z?V(Z):Y([])},[Z]);let V=async e=>{B(!0);try{let t=await fetch("/api/stacks/".concat(e,"/measurement-items")),s=((await t.json()).items||[]).filter(e=>e.isActive);Y(s)}catch(e){Y([])}finally{B(!1)}},[H,J]=(0,a.useState)(!1),[Q,K]=(0,a.useState)(!1),[$,q]=(0,a.useState)(null),[G,X]=(0,a.useState)({isOpen:!1,title:"",message:"",type:"info"}),ee=(e,t,s)=>{X({isOpen:!0,title:e,message:t,type:s})},et=async e=>{try{let t=await e.text(),{rows:s,error:r}=es(t);if(r||!s){let e=r||"CSV 파싱 실패";return ee("업로드 실패",e,"error"),{success:!1,message:e}}let a=await ea(s);return a.success?ee("업로드 성공",a.message,"success"):ee("업로드 실패",a.message,"error"),a}catch(t){let e=t.message||"업로드 중 오류가 발생했습니다.";return ee("업로드 오류",e,"error"),{success:!1,message:e}}},es=e=>{let t=e.split(/\r?\n/).filter(e=>e.trim().length>0&&!e.startsWith("* "));if(0===t.length)return{rows:null,error:"빈 파일입니다."};let s=t.findIndex(e=>e.startsWith("배출구명,"));if(s<0)return{rows:null,error:"헤더 행을 찾을 수 없습니다."};let r=t[s].split(","),a=e=>r.findIndex(t=>t.trim()===e),l=a("배출구명"),i=a("측정일자"),n=a("기상"),d=a("기온℃"),c=a("습도％"),o=a("기압mmHg"),x=a("풍향"),m=a("풍속m／sec"),u=a("가스속도m／s"),h=a("가스온도℃"),g=a("수분함량％"),b=a("실측산소농도％"),j=a("표준산소농도％"),y=a("배출가스유량S㎥／min"),p=a("오염물질"),v=a("농도"),N=a("측정업체"),f=[];for(let e=s+1;e<t.length;e++){var k,w,D,S,C,T,O,E,A,I,_,M,z,P,Z,F,R;let s=t[e].split(",");if(s.length<16)continue;let r=null===(k=s[l])||void 0===k?void 0:k.trim(),a=null===(w=s[i])||void 0===w?void 0:w.trim(),L=null===(D=s[p])||void 0===D?void 0:D.trim(),U=null===(S=s[v])||void 0===S?void 0:S.trim();if(!r||!a||!L)continue;let Y=Number(U);Number.isFinite(Y)&&f.push({stack:r,measuredAt:a,weather:null===(C=s[n])||void 0===C?void 0:C.trim(),temp:null===(T=s[d])||void 0===T?void 0:T.trim(),humidity:null===(O=s[c])||void 0===O?void 0:O.trim(),pressure:null===(E=s[o])||void 0===E?void 0:E.trim(),windDir:null===(A=s[x])||void 0===A?void 0:A.trim(),wind:null===(I=s[m])||void 0===I?void 0:I.trim(),gasVel:null===(_=s[u])||void 0===_?void 0:_.trim(),gasTemp:null===(M=s[h])||void 0===M?void 0:M.trim(),flow:null===(z=s[y])||void 0===z?void 0:z.trim(),moisture:null===(P=s[g])||void 0===P?void 0:P.trim(),o2Measured:null===(Z=s[b])||void 0===Z?void 0:Z.trim(),o2Standard:null===(F=s[j])||void 0===F?void 0:F.trim(),pollutant:L,value:Y,company:null===(R=s[N])||void 0===R?void 0:R.trim()})}return{rows:f}},er=e=>{if(!e||""===e.trim())return new Date().toISOString();let t=e.match(/^(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})$/);if(t){let[e,s,r,a,l,i]=t;return new Date(Number(s),Number(r)-1,Number(a),Number(l),Number(i)).toISOString()}if(t=e.match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2})$/)){let[e,s,r,a,l,i]=t;return new Date(Number(s),Number(r)-1,Number(a),Number(l),Number(i)).toISOString()}if(t=e.match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})$/)){let[e,s,r,a,l,i,n]=t;return new Date(Number(s),Number(r)-1,Number(a),Number(l),Number(i),Number(n)).toISOString()}if(t=e.match(/^(\d{4})\/(\d{2})\/(\d{2})\s+(\d{2}):(\d{2})$/)){let[e,s,r,a,l,i]=t;return new Date(Number(s),Number(r)-1,Number(a),Number(l),Number(i)).toISOString()}let s=new Date(e);return isNaN(s.getTime())?new Date().toISOString():s.toISOString()},ea=async e=>{try{let t=new Map(L.map(e=>[e.name,e.key])),s=e=>{if(null==e||""===e)return;let t=Number(String(e).replace(/[^0-9.+-]/g,""));return Number.isFinite(t)?t:void 0},r=[];for(let a of e){let e=er(a.measuredAt);for(let[l,i]of(r.push({stack:a.stack,itemKey:String(t.get(a.pollutant)||a.pollutant),value:a.value,measuredAt:e}),[["temperature",s(a.temp)],["humidity",s(a.humidity)],["pressure",s(a.pressure)],["wind_speed",s(a.wind)],["gas_velocity",s(a.gasVel)],["gas_temp",s(a.gasTemp)],["moisture",s(a.moisture)],["oxygen_measured",s(a.o2Measured)],["oxygen_std",s(a.o2Standard)],["flow_rate",s(a.flow)]]))void 0!==i&&r.push({stack:a.stack,itemKey:l,value:i,measuredAt:e});a.weather&&a.weather.trim()&&r.push({stack:a.stack,itemKey:"weather",value:a.weather.trim(),measuredAt:e}),a.windDir&&a.windDir.trim()&&r.push({stack:a.stack,itemKey:"wind_direction",value:a.windDir.trim(),measuredAt:e})}let a=await fetch("/api/measurements/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rows:r})}),l=await a.json();if(a.ok)return{success:!0,message:l.message||"업로드 성공",count:l.count};return{success:!1,message:l.error||"업로드 실패"}}catch(e){return{success:!1,message:e.message||"업로드 중 오류가 발생했습니다."}}},el=(e,t)=>N(s=>({...s,[e]:t})),ei=e=>{let{v:t,limit:s}=e,a=parseFloat(t);if(y||"nd"===t.toLowerCase()||""===t)return(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"미입력"});if(isNaN(a))return(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"-"});let l=a/s;return l>1?(0,r.jsx)("span",{className:"text-xs text-red-600",children:"초과"}):l>=.8?(0,r.jsx)("span",{className:"text-xs text-orange-500",children:"주의"}):(0,r.jsx)("span",{className:"text-xs text-green-600",children:"정상"})},en=(0,a.useMemo)(()=>{let e={};return S||(e.__date="날짜는 필수입니다"),T||(e.__time="시간은 필수입니다"),Object.entries(v).forEach(t=>{let[s,r]=t;if(!r)return;let a=U.find(e=>e.key===s);if((null==a?void 0:a.inputType)==="select"||(null==a?void 0:a.inputType)==="text")return;let l=Number(r);Number.isFinite(l)?(l<0||l>999999)&&(e[s]="0~999999 범위"):e[s]="숫자를 입력하세요"}),e},[S,T,v,U]),ed=Object.keys(en).length>0,ec=async function(e){var s;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("customer"===t)return;if(!_||!Z){ee("임시저장 실패","고객사와 굴뚝을 선택해주세요.","error");return}let a=null!==(s=v[e])&&void 0!==s?s:"";if(""===a){ee("임시저장 실패","값을 입력해주세요.","warning");return}let l=U.find(t=>t.key===e);if((null==l?void 0:l.category)==="채취환경"||(null==l?void 0:l.category)==="보조항목"){try{let t=new Date(S+"T"+(T||"00:00")+":00"),s=await fetch("/api/measurements-temp/auxiliary",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:_,stackId:Z,measurementDate:t.toISOString(),auxiliaryData:{[e]:a}})}),r=await s.json();s.ok?(k(t=>new Set(t).add(e)),ee("채취환경 저장 완료",((null==l?void 0:l.name)||e)+" 항목이 저장되었습니다.\n동일 날짜/굴뚝의 "+r.updatedCount+"건 임시데이터에 적용되었습니다.","success")):ee("저장 실패",r.error||"저장 중 오류가 발생했습니다.","error")}catch(e){ee("저장 오류",e.message||"저장 중 오류가 발생했습니다.","error")}return}if((null==l?void 0:l.inputType)!=="select"&&(null==l?void 0:l.inputType)!=="text"){let t=Number(a);if(!Number.isFinite(t)){ee("임시저장 실패","올바른 숫자를 입력해주세요.","error");return}if(!r)try{let s=await fetch("http://localhost:8000/api/validate-measurement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:_,stack:z,item_key:e,value:t})}),r=await s.json();if(r.anomaly_detected){q({isOpen:!0,itemKey:e,itemName:(null==l?void 0:l.name)||e,inputValue:t,lowerBound:r.details.lower_bound,upperBound:r.details.upper_bound});return}}catch(e){}}try{let t=new Date(S+"T"+(T||"00:00")+":00"),s=(null==l?void 0:l.inputType)==="select"||(null==l?void 0:l.inputType)==="text"?a:Number(a),r=[{itemKey:e,value:s,unit:(null==l?void 0:l.unit)||""}],i={};U.filter(e=>"채취환경"===e.category||"보조항목"===e.category).forEach(e=>{let t=v[e.key];t&&(i[e.key]=t)}),F&&(i.company=F);let n=await fetch("/api/measurements-temp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:_,stackId:Z,measurementDate:t.toISOString(),measurements:r,auxiliaryData:Object.keys(i).length>0?i:null})}),d=await n.json();n.ok?(k(t=>new Set(t).add(e)),ee(f.has(e)?"재저장 완료":"임시저장 완료",((null==l?void 0:l.name)||e)+" 항목이 임시 저장되었습니다.\n임시 ID: "+d.tempId,"success")):ee("저장 실패",d.error||"임시저장 중 오류가 발생했습니다.","error")}catch(e){ee("저장 오류",e.message||"임시저장 중 오류가 발생했습니다.","error")}};return(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-end justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold whitespace-nowrap mb-1.5",children:"측정 입력"}),(0,r.jsx)("span",{className:"text-gray-300 dark:text-gray-600 mb-1.5",children:"|"}),(0,r.jsxs)("div",{className:"flex gap-2 mb-1.5",children:[(0,r.jsx)("button",{onClick:()=>h("field"),className:"px-3 py-1 rounded text-sm font-medium transition-colors ".concat("field"===s?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"\uD83D\uDCDD 현장임시입력"}),(0,r.jsx)("button",{onClick:()=>h("temp"),className:"px-3 py-1 rounded text-sm font-medium transition-colors ".concat("temp"===s?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"\uD83D\uDCCA 임시데이터관리"}),(0,r.jsx)("button",{onClick:()=>h("bulk"),className:"px-3 py-1 rounded text-sm font-medium transition-colors ".concat("bulk"===s?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"\uD83D\uDCE4 확정일괄업로드"})]})]}),(0,r.jsx)("button",{onClick:()=>K(!0),className:"px-3 py-1.5 text-xs bg-blue-100 hover:bg-blue-200 dark:bg-blue-900 dark:hover:bg-blue-800 text-blue-700 dark:text-blue-300 rounded mb-1.5",children:"❓ 도움말"})]})}),"customer"===t&&"temp"!==s&&(0,r.jsx)("div",{className:"rounded-md border p-3 text-sm bg-yellow-50 border-yellow-200 text-yellow-900 dark:bg-yellow-900/20 dark:text-yellow-200",children:"고객사 사용자는 측정 데이터 입력 권한이 없습니다. 조회 기능을 이용해 주세요."}),"field"===s&&(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,r.jsxs)("aside",{className:"col-span-12 md:col-span-2 rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-4",children:[(0,r.jsx)("h2",{className:"text-base font-semibold",children:"측정 정보"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm",children:"측정일"}),(0,r.jsx)(i.Z,{type:"date",value:S,onChange:e=>C(e.target.value),className:"w-full text-xs sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white border-gray-700 ".concat(en.__date?"border-red-500":""),disabled:"customer"===t}),en.__date&&(0,r.jsx)("div",{className:"text-xs text-red-400 mt-1",children:en.__date})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm",children:"고객사"}),(0,r.jsxs)(n.Z,{className:"w-full text-xs sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white border-gray-700",value:A,onChange:e=>I(e.target.value),disabled:"customer"===t,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"선택"}),E.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm",children:"굴뚝"}),(0,r.jsxs)(n.Z,{className:"w-full text-xs sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white border-gray-700",value:z,onChange:e=>P(e.target.value),disabled:"customer"===t||!_,children:[(0,r.jsx)("option",{value:"",disabled:!0,children:_?"선택":"고객사 선택 필요"}),M.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm",children:"측정업체"}),(0,r.jsx)(n.Z,{className:"w-full text-xs sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white border-gray-700",value:F,onChange:e=>R(e.target.value),disabled:"customer"===t,children:(0,r.jsx)("option",{value:"보아스환경기술",children:"보아스환경기술"})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"text-xs sm:text-sm flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:y,onChange:e=>p(e.target.checked),disabled:"customer"===t,className:"accent-blue-500"})," 불검출(전체)"]}),y&&(0,r.jsx)("div",{className:"text-xs rounded-md border border-blue-900/30 bg-blue-900/20 text-blue-200 p-2",children:"불검출(전체) 모드가 활성화되어 항목 값 입력이 비활성화됩니다."})]})]})]}),(0,r.jsx)("main",{className:"col-span-12 md:col-span-10",children:(0,r.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6 space-y-6",children:[Z?W?(0,r.jsx)("div",{className:"text-center py-12 text-gray-500",children:"로딩 중..."}):0===U.length?(0,r.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,r.jsx)("p",{className:"mb-2",children:"측정 이력이 없습니다."}),(0,r.jsx)("p",{className:"text-sm",children:"측정 데이터를 입력하면 자동으로 항목이 표시됩니다."})]}):(0,r.jsxs)(r.Fragment,{children:[U.filter(e=>"채취환경"===e.category||"보조항목"===e.category).length>0&&(0,r.jsxs)("div",{className:"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold mb-3",children:"\uD83C\uDF21️ 채취환경"}),(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:U.filter(e=>"채취환경"===e.category||"보조항목"===e.category).map(e=>{var s;let a=e.key,l=null!==(s=v[a])&&void 0!==s?s:"",n="select"===e.inputType,d=n&&e.options?JSON.parse(e.options):[];return(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("div",{className:"w-20 text-xs font-medium leading-tight line-clamp-2",children:e.name}),n?(0,r.jsxs)("select",{className:"w-20 px-2 py-1 text-center text-sm border rounded ".concat(en[a]?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-700"),value:l,onChange:e=>el(a,e.target.value),disabled:"customer"===t,children:[(0,r.jsx)("option",{value:"",children:"선택"}),d.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}):(0,r.jsx)(i.Z,{type:"text",className:"w-20 px-2 py-1 text-center text-sm ".concat(en[a]?"border-red-500":""),placeholder:"값",value:l,onChange:e=>el(a,e.target.value),disabled:"customer"===t}),en[a]&&(0,r.jsx)("div",{className:"text-xs text-red-600",children:en[a]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 w-12",children:e.unit}),(0,r.jsx)("button",{className:"px-2 py-1 text-xs bg-orange-500 hover:bg-orange-600 text-white rounded disabled:opacity-50",disabled:"customer"===t,onClick:()=>ec(a),children:f.has(a)?"재저장":"임시저장"})]},a)})})]}),U.filter(e=>"오염물질"===e.category).length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-base font-semibold mb-3",children:"\uD83C\uDFED 오염물질"}),(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:U.filter(e=>"오염물질"===e.category).map(e=>{var s;let a=e.key,l=null!==(s=v[a])&&void 0!==s?s:"";return(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("div",{className:"w-20 text-xs font-medium leading-tight line-clamp-2",children:e.name}),(0,r.jsx)(i.Z,{type:"text",className:"w-20 px-2 py-1 text-center text-sm ".concat(en[a]?"border-red-500":""),placeholder:y?"ND":"값",value:y?"":l,onChange:e=>el(a,e.target.value),disabled:y||"customer"===t}),en[a]&&(0,r.jsx)("div",{className:"text-xs text-red-600",children:en[a]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 w-12",children:e.unit}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 w-16",children:["기준 ",e.limit]}),(0,r.jsx)("div",{className:"w-12",children:(0,r.jsx)(ei,{v:l,limit:e.limit})}),(0,r.jsx)("button",{className:"px-2 py-1 text-xs bg-orange-500 hover:bg-orange-600 text-white rounded disabled:opacity-50",disabled:"customer"===t,onClick:()=>ec(a),children:f.has(a)?"재저장":"임시저장"})]},a)})})]})]}):(0,r.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,r.jsx)("p",{className:"text-lg mb-2",children:"\uD83C\uDFED 굴뚝을 선택하세요"}),(0,r.jsx)("p",{className:"text-sm",children:"고객사와 굴뚝을 선택하면 측정 대상 항목이 표시됩니다."})]}),ed&&(0,r.jsxs)("div",{className:"mt-4 text-xs rounded-md border border-red-200 bg-red-50 text-red-700 dark:border-red-900/30 dark:bg-red-900/20 dark:text-red-200 p-2",children:["유효성 오류 ",Object.keys(en).length,"개가 있습니다. 빨간 표시된 필드를 확인해 주세요."]})]})})]}),"temp"===s&&(0,r.jsx)(g,{}),"bulk"===s&&(0,r.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"확정 일괄업로드"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"검증이 완료된 측정 데이터를 일괄 업로드하여 확정 등록합니다."})]}),(0,r.jsx)(d.Z,{size:"sm",variant:"primary",onClick:()=>J(!0),children:"\uD83D\uDCE4 파일 업로드"})]}),(0,r.jsxs)("div",{className:"rounded-md border border-blue-200 bg-blue-50 dark:border-blue-900/30 dark:bg-blue-900/20 p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-200 mb-2",children:"\uD83D\uDCA1 업로드 안내"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 dark:text-blue-300 space-y-1",children:[(0,r.jsx)("li",{children:"• [임시데이터관리] 탭에서 다운로드한 Excel 파일을 그대로 사용할 수 있습니다"}),(0,r.jsx)("li",{children:"• 업로드된 데이터는 즉시 확정되어 측정 이력 및 대시보드에 반영됩니다"}),(0,r.jsx)("li",{children:"• 측정일자는 YYYYMMDDhhmm 형식(예: 202501131125) 또는 YYYY-MM-DD HH:mm 형식을 지원합니다"})]})]})]})}),(0,r.jsx)(m.Z,{isOpen:H,onClose:()=>J(!1),title:"측정 데이터 일괄업로드",templateHeaders:["배출구명","측정일자","기상","기온℃","습도％","기압mmHg","풍향","풍속m／sec","가스속도m／s","가스온도℃","수분함량％","실측산소농도％","표준산소농도％","배출가스유량S㎥／min","오염물질","농도","배출허용기준농도","배출허용기준체크","측정업체"],exampleRow:["C-ST01001","202501131125","맑음","4.0","33","769.9","북서","3.0","26.63","12","1.97","0","0","1713.8","먼지","0.7","30","","보아스환경기술"],templateFileName:"측정데이터_업로드_양식.csv",onUpload:et,parseInstructions:"양식에 맞게 작성한 CSV 파일을 업로드하세요. 측정일자는 YYYYMMDDhhmm 형식(예: 202501131125) 또는 YYYY-MM-DD HH:mm 형식을 지원합니다."}),(0,r.jsx)(u,{isOpen:G.isOpen,onClose:()=>{X({...G,isOpen:!1})},title:G.title,message:G.message,type:G.type}),(0,r.jsx)(b.Z,{isOpen:Q,title:"측정 입력 도움말",sections:[{title:"\uD83D\uDCCC 빠른 시작",content:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"측정 데이터 입력 3단계"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2",children:[(0,r.jsxs)("li",{className:"text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("strong",{children:"날짜/고객사/굴뚝 선택"}),(0,r.jsxs)("ul",{className:"list-disc list-inside ml-6 mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"측정일, 측정시간 입력"}),(0,r.jsx)("li",{children:"고객사와 굴뚝 선택"}),(0,r.jsx)("li",{children:"과거 측정이력 기반으로 항목 자동 표시"})]})]}),(0,r.jsxs)("li",{className:"text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("strong",{children:"채취환경 입력 (상단 파란 박스)"}),(0,r.jsxs)("ul",{className:"list-disc list-inside ml-6 mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"기상, 풍향, 기온 등 입력"}),(0,r.jsx)("li",{children:"각 항목별 [임시저장] 클릭"})]})]}),(0,r.jsxs)("li",{className:"text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("strong",{children:"오염물질 입력"}),(0,r.jsxs)("ul",{className:"list-disc list-inside ml-6 mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"먼지, SOx, NOx 등 측정값 입력"}),(0,r.jsx)("li",{children:"각 항목별 [임시저장] 클릭"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-blue-900 dark:text-blue-300 mb-2",children:"\uD83D\uDCA1 핵심 Tip"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-200",children:[(0,r.jsx)("li",{children:"• 채취환경을 먼저 입력하세요 (모든 오염물질에 공통 적용)"}),(0,r.jsx)("li",{children:"• 임시저장 → 임시데이터관리 탭에서 체크박스 선택 → 확정 버튼 클릭"}),(0,r.jsx)("li",{children:"• 측정항목 변경은 [측정항목] 메뉴에서"})]})]})]})},{title:"\uD83D\uDCCB 측정할 항목 설정",content:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"자동 표시 방식"}),(0,r.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:["굴뚝을 선택하면 ",(0,r.jsx)("strong",{children:"과거 측정이력을 기반"}),"으로 측정 항목이 자동으로 표시됩니다."]}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-700 rounded p-3",children:(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["예: A 굴뚝에서 과거에 먼지, SOx, NOx를 측정했다면",(0,r.jsx)("br",{}),"→ A 굴뚝 선택 시 자동으로 먼지, SOx, NOx 항목이 표시됨"]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"측정항목 변경이 필요한 경우"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded p-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-yellow-900 dark:text-yellow-300 mb-2",children:"다음과 같은 경우 측정항목 설정이 필요합니다:"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-yellow-800 dark:text-yellow-200",children:[(0,r.jsx)("li",{children:"• 신규 항목 추가 (예: 암모니아 측정 시작)"}),(0,r.jsx)("li",{children:"• 기존 항목 제거 (예: 더 이상 측정하지 않는 항목)"}),(0,r.jsx)("li",{children:"• 처음 측정하는 굴뚝 (측정이력 없음)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-gray-900 dark:text-gray-300 mb-2",children:"설정 방법"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"[측정항목]"})," 메뉴로 이동"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"[굴뚝별 측정 대상 설정]"})," 탭 선택"]}),(0,r.jsx)("li",{children:"고객사와 굴뚝 선택"}),(0,r.jsx)("li",{children:"측정할 항목 체크/해제"}),(0,r.jsx)("li",{children:"[저장] 버튼 클릭"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-blue-900 dark:text-blue-300 mb-2",children:"\uD83D\uDCA1 Tip"}),(0,r.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["측정항목 설정은 한 번만 하면 됩니다.",(0,r.jsx)("br",{}),"이후 해당 굴뚝 선택 시 설정한 항목이 자동으로 표시됩니다."]})]})]})},{title:"\uD83C\uDF21️ 채취환경 입력",content:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"채취환경이란?"}),(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:"측정 당시의 환경 조건으로, 모든 오염물질 측정에 공통으로 적용됩니다."}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsx)("li",{children:"• 기상, 기온, 습도, 기압"}),(0,r.jsx)("li",{children:"• 풍향, 풍속"}),(0,r.jsx)("li",{children:"• 가스속도, 가스온도, 수분함량"}),(0,r.jsx)("li",{children:"• 산소농도, 배출가스유량 등"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"입력 방법"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("li",{children:"상단 파란색 박스의 채취환경 항목 확인"}),(0,r.jsx)("li",{children:"각 항목에 측정값 입력"}),(0,r.jsx)("li",{children:"항목별 [임시저장] 버튼 클릭"})]})]}),(0,r.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-green-900 dark:text-green-300 mb-2",children:"✨ 자동 적용 기능"}),(0,r.jsxs)("p",{className:"text-sm text-green-800 dark:text-green-200",children:["채취환경을 저장하면 ",(0,r.jsx)("strong",{children:"동일 날짜/동일 굴뚝"}),"의 모든 임시데이터에 자동으로 적용됩니다.",(0,r.jsx)("br",{}),'예: 기상을 "맑음"으로 저장 → 해당 날짜의 모든 오염물질 데이터에 "맑음" 적용']})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-yellow-900 dark:text-yellow-300 mb-2",children:"⚠️ 주의사항"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-yellow-800 dark:text-yellow-200",children:[(0,r.jsx)("li",{children:"• 채취환경은 측정 시작 전에 먼저 입력하는 것을 권장"}),(0,r.jsx)("li",{children:"• 나중에 수정하면 기존 임시데이터도 함께 업데이트됨"}),(0,r.jsx)("li",{children:"• 확정 후에는 측정이력 메뉴에서 수정 가능"})]})]})]})},{title:"\uD83C\uDFED 오염물질 입력",content:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"입력 방법"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("li",{children:"오염물질 항목에 측정값 입력"}),(0,r.jsx)("li",{children:"각 항목별 [임시저장] 버튼 클릭"}),(0,r.jsx)("li",{children:"저장되면 버튼이 [재저장]으로 변경됨"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"채취환경 자동 적용"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:"오염물질을 임시저장하면 현재 입력된 채취환경 값이 자동으로 함께 저장됩니다."}),(0,r.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded p-3",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["\uD83D\uDCA1 채취환경 없이 오염물질만 저장해도 됩니다.",(0,r.jsx)("br",{}),"나중에 채취환경을 입력하면 자동으로 업데이트됩니다."]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"유효성 검사"}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-600",children:"✅"}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"숫자 항목: 올바른 숫자 형식 확인"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-600",children:"✅"}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"선택 항목: 드롭다운에서 선택"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-600",children:"✅"}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"배출허용기준 초과 시 경고 표시"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-yellow-600",children:"⚠️"}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"AI 기반 이상치 검증 (예상 범위 벗어날 시 워닝)"})]})]})]}),(0,r.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-purple-900 dark:text-purple-300 mb-2",children:"\uD83E\uDD16 AI 이상치 검증"}),(0,r.jsx)("p",{className:"text-sm text-purple-800 dark:text-purple-200 mb-3",children:"측정값 입력 시 AI가 과거 데이터를 분석하여 예상 범위를 벗어난 값을 자동으로 감지합니다."}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-purple-800 dark:text-purple-200",children:[(0,r.jsx)("li",{children:"• 워닝 메시지가 표시되면 측정 장비와 조건을 재확인하세요"}),(0,r.jsx)("li",{children:'• 실제로 높은 값이 맞다면 "확인하고 저장" 클릭'}),(0,r.jsx)("li",{children:"• 데이터가 10개 미만인 경우 검증이 생략됩니다"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-700 rounded p-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-gray-300 mb-2",children:"불검출(ND) 처리"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:['측정값이 검출한계 미만인 경우 "불검출(전체)" 체크박스를 선택하면',(0,r.jsx)("br",{}),"모든 항목이 ND로 처리됩니다."]})]})]})},{title:"\uD83D\uDCCB 임시데이터 관리",content:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"임시저장 후 확인"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("li",{children:"[임시데이터관리] 탭 클릭"}),(0,r.jsx)("li",{children:"저장된 데이터 목록 확인"}),(0,r.jsx)("li",{children:"확정할 항목 체크박스 선택"}),(0,r.jsx)("li",{children:"[확정] 버튼 클릭 → 측정이력에 자동 반영"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"확정 방법 2가지"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded p-3",children:[(0,r.jsx)("h4",{className:"font-medium text-blue-900 dark:text-blue-300 mb-2",children:"방법 1: 직접 확정 (권장)"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-blue-800 dark:text-blue-200",children:[(0,r.jsx)("li",{children:"• 임시데이터관리 탭에서 체크박스 선택"}),(0,r.jsx)("li",{children:"• [확정] 버튼 클릭"}),(0,r.jsx)("li",{children:"• 즉시 측정이력에 반영"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-700 rounded p-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-gray-300 mb-2",children:"방법 2: Excel 다운로드 후 일괄업로드"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("li",{children:"• [Excel] 버튼으로 다운로드"}),(0,r.jsx)("li",{children:"• Excel에서 수정 필요 시 편집"}),(0,r.jsx)("li",{children:"• [확정일괄업로드] 탭에서 업로드"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"기타 기능"}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"[Excel]"}),": 선택한 항목 또는 전체 다운로드"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"[삭제]"}),": 선택한 임시데이터 삭제"]}),(0,r.jsx)("li",{children:"• 필터: 고객사, 굴뚝, 기간별 조회"})]})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-yellow-900 dark:text-yellow-300 mb-2",children:"⚠️ 주의"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["임시데이터는 아직 확정되지 않은 상태입니다.",(0,r.jsx)("br",{}),"확정 버튼을 클릭해야 측정이력 및 대시보드에 반영됩니다."]})]})]})},{title:"\uD83D\uDCE4 확정 일괄업로드",content:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"업로드 절차"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,r.jsx)("li",{children:"[확정일괄업로드] 탭 클릭"}),(0,r.jsx)("li",{children:"[\uD83D\uDCE4 파일 업로드] 버튼 클릭"}),(0,r.jsx)("li",{children:"검토/수정한 Excel 파일 선택"}),(0,r.jsx)("li",{children:"업로드 완료 → 측정이력에 자동 반영"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Excel 파일 형식"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:"임시데이터관리 탭에서 다운로드한 Excel 파일을 그대로 사용할 수 있습니다."}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsx)("li",{children:"• 컬럼 순서 및 이름 변경 금지"}),(0,r.jsx)("li",{children:"• 측정값만 수정 가능"}),(0,r.jsx)("li",{children:"• 행 추가/삭제 가능"})]})]}),(0,r.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-green-900 dark:text-green-300 mb-2",children:"✅ 확정 후"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-green-800 dark:text-green-200",children:[(0,r.jsx)("li",{children:"• 측정이력 메뉴에서 조회 가능"}),(0,r.jsx)("li",{children:"• 대시보드에 자동 반영"}),(0,r.jsx)("li",{children:"• 고객사도 조회 가능"})]})]})]})},{title:"❓ FAQ",content:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h4",{className:"font-bold mb-2",children:"Q1. 측정할 항목이 표시되지 않아요"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["A: 과거 측정이력이 없거나 측정항목 설정이 필요합니다.",(0,r.jsx)("br",{}),"[측정항목] 메뉴 → [굴뚝별 측정 대상 설정]에서 항목을 설정하세요."]})]}),(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h4",{className:"font-bold mb-2",children:"Q2. 채취환경을 나중에 입력해도 되나요?"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"A: 네, 가능합니다. 나중에 입력하면 동일 날짜/굴뚝의 모든 임시데이터에 자동 적용됩니다."})]}),(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h4",{className:"font-bold mb-2",children:"Q3. 임시저장한 데이터를 수정하려면?"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["A: 같은 날짜/굴뚝/항목으로 다시 임시저장하면 기존 값이 업데이트됩니다.",(0,r.jsx)("br",{}),"또는 [임시데이터관리] 탭에서 삭제 후 다시 입력하세요."]})]}),(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h4",{className:"font-bold mb-2",children:"Q4. 확정 후 수정이 가능한가요?"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"A: 네, [측정이력] 메뉴에서 수정 가능합니다."})]}),(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h4",{className:"font-bold mb-2",children:"Q5. 여러 굴뚝을 한 번에 입력할 수 있나요?"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"A: 현장임시입력은 굴뚝별로 입력합니다. 여러 굴뚝은 Excel 파일로 일괄 업로드하세요."})]}),(0,r.jsxs)("div",{className:"pb-4",children:[(0,r.jsx)("h4",{className:"font-bold mb-2",children:"Q6. AI 이상치 워닝이 뜨는데 값이 맞아요"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:['A: 실제로 높은 값이 측정된 경우 "확인하고 저장" 버튼을 클릭하면 됩니다.',(0,r.jsx)("br",{}),"AI는 과거 데이터 기반으로 예측하므로 실제 배출 상황이 변경된 경우 워닝이 표시될 수 있습니다."]})]})]})}],onClose:()=>K(!1)}),$&&(0,r.jsx)(j,{isOpen:$.isOpen,onClose:()=>q(null),onConfirm:()=>{ec($.itemKey,!0),q(null)},inputValue:$.inputValue,lowerBound:$.lowerBound,upperBound:$.upperBound,itemName:$.itemName})]})}},3158:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var r=s(7437),a=s(2265),l=s(6334);function i(e){let{isOpen:t,onClose:s,title:i,templateHeaders:n,exampleRow:d,templateFileName:c,onUpload:o,parseInstructions:x="양식에 맞게 작성한 CSV 파일을 업로드하세요."}=e,[m,u]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1),[b,j]=(0,a.useState)(""),y=async()=>{if(!m){j("파일을 선택해주세요.");return}g(!0),j("");try{let e=await o(m);if(e.success){let t=e.message||"업로드 완료";j("✅ ".concat(t)),u(null)}else j("❌ ".concat(e.message||"업로드 실패"))}catch(e){j("❌ 오류: ".concat(e.message||"업로드 중 문제가 발생했습니다."))}finally{g(!1)}},p=()=>{h||(u(null),j(""),s())};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:p,children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:i}),(0,r.jsx)("button",{onClick:p,disabled:h,className:"text-gray-500 hover:text-gray-700 disabled:opacity-50",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded",children:[(0,r.jsx)("p",{className:"font-medium mb-1",children:"\uD83D\uDCCB 업로드 절차"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[(0,r.jsx)("li",{children:'아래 "업로드 양식 다운로드" 버튼을 클릭하여 CSV 양식을 다운로드합니다.'}),(0,r.jsx)("li",{children:"다운로드한 양식에 데이터를 입력합니다. (예시 행 참고)"}),(0,r.jsx)("li",{children:'"파일 선택" 버튼을 클릭하여 작성한 CSV 파일을 선택합니다.'}),(0,r.jsx)("li",{children:'"업로드" 버튼을 클릭하여 데이터를 등록합니다.'})]})]}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:x}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)(l.Z,{variant:"secondary",onClick:()=>{let e=new Blob(["\uFEFF"+n.map(e=>'"'.concat(e,'"')).join(",")+"\n"+d.map(e=>'"'.concat(e,'"')).join(",")+"\n"],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=c,s.click(),URL.revokeObjectURL(t)},disabled:h,className:"flex-1",children:"\uD83D\uDCE5 업로드 양식 다운로드"})}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)("label",{className:"flex-1",children:[(0,r.jsx)("div",{className:"px-4 py-2 border-2 border-dashed rounded cursor-pointer text-center transition-colors ".concat(m?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400"," ").concat(h?"opacity-50 cursor-not-allowed":""),children:m?(0,r.jsxs)("span",{className:"text-sm",children:["\uD83D\uDCC4 ",m.name]}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"\uD83D\uDCC1 파일 선택 (CSV)"})}),(0,r.jsx)("input",{type:"file",accept:".csv",className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&(u(s),j(""))},disabled:h})]})}),(0,r.jsx)(l.Z,{onClick:y,disabled:!m||h,className:"w-full",children:h?"업로드 중...":"업로드"})]}),b&&(0,r.jsx)("div",{className:"text-sm p-4 rounded border-2 ".concat(b.startsWith("✅")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-500":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-500"),children:(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("pre",{className:"whitespace-pre-wrap font-sans",children:b}),(0,r.jsx)(l.Z,{size:"sm",onClick:()=>{j(""),p()},className:"self-end",children:"확인"})]})})]}),!b&&(0,r.jsx)("div",{className:"mt-6 flex justify-end gap-2",children:(0,r.jsx)(l.Z,{variant:"secondary",onClick:p,disabled:h,children:"닫기"})})]})}):null}},8653:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(7437),a=s(2265);function l(e){let{isOpen:t,onClose:s,title:l,sections:i}=e,[n,d]=(0,a.useState)(0);return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:s}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center text-2xl",children:"\uD83D\uDCDA"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:l})]}),(0,r.jsx)("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),i.length>1&&(0,r.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:(0,r.jsx)("nav",{className:"flex -mb-px overflow-x-auto",children:i.map((e,t)=>(0,r.jsx)("button",{onClick:()=>d(t),className:"px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ".concat(n===t?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e.title},t))})}),(0,r.jsx)("div",{className:"px-6 py-6 max-h-[70vh] overflow-y-auto",children:(0,r.jsx)("div",{className:"prose dark:prose-invert max-w-none",children:"string"==typeof i[n].content?(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:i[n].content}}):i[n].content})}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-4 flex justify-between items-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\uD83D\uDCA1 추가 도움이 필요하시면 시스템 관리자에게 문의하세요."}),(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"닫기"})]})]})]})}):null}},6334:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var r=s(7437);s(2265);let a={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},l={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i(e){let{variant:t="primary",size:s="md",className:i="",...n}=e;return(0,r.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(a[t]," ").concat(l[s]," ").concat(i),...n})}},2827:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(7437);function a(e){let{className:t="",...s}=e;return(0,r.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...s})}s(2265)},6819:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(7437);function a(e){let{className:t="",children:s,...a}=e;return(0,r.jsx)("select",{className:"".concat("w-full rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...a,children:s})}s(2265)},1515:function(e,t,s){"use strict";s.d(t,{Td:function(){return c},Th:function(){return d},Tr:function(){return n},hr:function(){return l},iA:function(){return a},p3:function(){return i}});var r=s(7437);function a(e){let{className:t="",...s}=e;return(0,r.jsx)("table",{className:"w-full text-sm border-collapse ".concat(t),...s})}function l(e){return(0,r.jsx)("thead",{...e})}function i(e){return(0,r.jsx)("tbody",{...e})}function n(e){return(0,r.jsx)("tr",{className:"border-b last:border-0 border-gray-200 dark:border-white/10",...e})}function d(e){let{className:t="",...s}=e;return(0,r.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-600 dark:text-gray-300 ".concat(t),...s})}function c(e){let{className:t="",...s}=e;return(0,r.jsx)("td",{className:"py-2 px-3 ".concat(t),...s})}s(2265)},2397:function(e,t,s){"use strict";s.d(t,{H:function(){return c},a:function(){return o}});var r=s(7437),a=s(2265),l=s(605),i=s(9376);function n(){return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900",children:[(0,r.jsxs)("div",{className:"mb-16",children:[(0,r.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-white text-center",children:"오염물질 측정 관리 시스템"}),(0,r.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Pollutant Measurement Management System"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-gray-200 dark:border-gray-700 border-t-blue-600 rounded-full animate-spin"})}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"로딩 중..."})]}),(0,r.jsx)("div",{className:"mt-16"})]})}let d=(0,a.createContext)(null);function c(e){let{children:t}=e,{data:s,status:c}=(0,l.useSession)(),[o,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),h=(0,i.usePathname)();(0,a.useEffect)(()=>{"loading"!==c&&u(!1),(null==s?void 0:s.user)?x(s.user):"unauthenticated"===c&&x(null)},[s,c]);let g="loading"===c||m;return!g||"/login"===h||(null==h?void 0:h.startsWith("/register"))||(null==h?void 0:h.startsWith("/invite"))||(null==h?void 0:h.startsWith("/auth"))?(0,r.jsx)(d.Provider,{value:{user:o,loading:g},children:t}):(0,r.jsx)(n,{})}function o(){let e=(0,a.useContext)(d);if(!e)throw Error("AuthProvider is missing");return e}},2891:function(e,t,s){"use strict";s.d(t,{OrganizationProvider:function(){return n},o:function(){return d}});var r=s(7437),a=s(2265),l=s(605);let i=(0,a.createContext)(void 0);function n(e){var t,s,n;let{children:d}=e,{data:c,status:o}=(0,l.useSession)(),[x,m]=(0,a.useState)(null),[u,h]=(0,a.useState)([]),[g,b]=(0,a.useState)(!0),j=(null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.role)==="SUPER_ADMIN",y=null==c?void 0:null===(s=c.user)||void 0===s?void 0:s.role,p=null==c?void 0:null===(n=c.user)||void 0===n?void 0:n.organizationId,v="CUSTOMER_ADMIN"===y||"CUSTOMER_USER"===y;(0,a.useEffect)(()=>{if("loading"!==o){if(!c||v){b(!1);return}j&&sessionStorage.getItem("viewAsOrganization"),j?N():p?f(p):b(!1)}},[c,o,j,p,v]),(0,a.useEffect)(()=>{if(!j)return;let e=sessionStorage.getItem("viewAsOrganization");e&&(null==x?void 0:x.id)!==e&&N();let t=setInterval(()=>{let e=sessionStorage.getItem("viewAsOrganization");if(e&&(null==x?void 0:x.id)!==e)N();else if(!e&&x){let e=localStorage.getItem("selectedOrgId");e&&x.id!==e&&N()}},500);return()=>clearInterval(t)},[j,x]);let N=async()=>{try{let e=await fetch("/api/organizations?status=APPROVED"),t=await e.json();if(e.ok){let e=t.organizations||[];h(e);let s=sessionStorage.getItem("viewAsOrganization");if(s){let t=e.find(e=>e.id===s);if(t){m(t);return}}let r=localStorage.getItem("selectedOrgId");if(r){let t=e.find(e=>e.id===r);t?m(t):e.length>0&&m(e[0])}else e.length>0&&m(e[0])}}catch(e){}finally{b(!1)}},f=async e=>{try{let t=await fetch("/api/organizations/".concat(e)),s=await t.json();if(t.ok){let e=s.organization;h([e]),m(e)}}catch(e){}finally{b(!1)}};return(0,r.jsx)(i.Provider,{value:{selectedOrg:x,setSelectedOrg:e=>{m(e),e?localStorage.setItem("selectedOrgId",e.id):localStorage.removeItem("selectedOrgId")},organizations:u,loading:g,isSuperAdmin:j},children:d})}function d(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useOrganization must be used within OrganizationProvider");return e}},4755:function(e,t,s){"use strict";s.d(t,{n:function(){return i}});var r=s(2265),a=s(2891),l=s(605);function i(){var e,t;let[s,i]=(0,r.useState)([]),{selectedOrg:n}=(0,a.o)(),{data:d}=(0,l.useSession)(),c=null==d?void 0:null===(e=d.user)||void 0===e?void 0:e.role,o=null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.customerId,x="CUSTOMER_ADMIN"===c||"CUSTOMER_USER"===c,m=(0,r.useCallback)(()=>{if(x&&o){fetch("/api/customers/".concat(o)).then(e=>e.json()).then(e=>{let t=e.customer||e.data;i(t?[t]:[])}).catch(e=>{i([])});return}if(!(null==n?void 0:n.id)){i([]);return}let e=new URLSearchParams;e.append("organizationId",n.id),e.append("tab","all"),fetch("/api/customers?".concat(e.toString())).then(e=>e.json()).then(e=>{i(e.customers||e.data||[])}).catch(e=>{i([])})},[n,x,o]);return(0,r.useEffect)(()=>{m()},[m]),{list:s,refetch:m}}},8776:function(e,t,s){"use strict";s.d(t,{F:function(){return i},r:function(){return n}});var r=s(2265),a=s(2891),l=s(605);function i(){let[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=!0;return fetch("/api/items").then(e=>e.json()).then(s=>{e&&t(s.data||[])}).catch(()=>{e&&t([])}),()=>{e=!1}},[]),{items:e}}function n(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{customerId:s,stack:i,stacks:n,itemKey:d,page:c=1,pageSize:o=50,sort:x,start:m,end:u}=t,[h,g]=(0,r.useState)([]),[b,j]=(0,r.useState)(0),{selectedOrg:y}=(0,a.o)(),{data:p}=(0,l.useSession)(),v=null==p?void 0:null===(e=p.user)||void 0===e?void 0:e.role,N="CUSTOMER_ADMIN"===v||"CUSTOMER_USER"===v;(0,r.useEffect)(()=>{let e=!0,t=new AbortController;if(!N&&!(null==y?void 0:y.id)){g([]);return}let r=new URLSearchParams;return s&&r.set("customerId",s),n&&n.length?n.forEach(e=>r.append("stack",e)):i&&r.set("stack",i),d&&r.set("itemKey",d),m&&r.set("start",m),u&&r.set("end",u),(null==y?void 0:y.id)&&r.set("organizationId",y.id),fetch("/api/measurements?".concat(r.toString()),{signal:t.signal}).then(e=>e.json()).then(t=>{e&&g(Array.isArray(t.measurements)?t.measurements:Array.isArray(t.data)?t.data:[])}).catch(t=>{t.name,e&&g([])}),()=>{e=!1,t.abort()}},[s,i,(n||[]).join("|"),d,m,u,b,y,N]);let f=(0,r.useMemo)(()=>{if(!x)return h;let{key:e,dir:t}=x,s=[...h];return s.sort((s,r)=>{let a=s[e],l=r[e];return a<l?"asc"===t?-1:1:a>l?"asc"===t?1:-1:0}),s},[h,x]),k=f.length,w=(c-1)*o;return{data:o>=999999?f:f.slice(w,w+o),total:k,page:c,pageSize:o,mutate:()=>j(e=>e+1)}}},9548:function(e,t,s){"use strict";s.d(t,{D:function(){return l}});var r=s(2265),a=s(2891);function l(e){let[t,s]=(0,r.useState)([]),{selectedOrg:l}=(0,a.o)();return(0,r.useEffect)(()=>{let t=!0;if(!(null==l?void 0:l.id)){s([]);return}let r=new URLSearchParams;return e&&r.set("customerId",e),r.set("organizationId",l.id),fetch("/api/stacks?".concat(r.toString())).then(e=>e.json()).then(e=>{let r=(e.stacks||e.data||[]).filter(e=>!1!==e.isActive);t&&s(r)}).catch(e=>{t&&s([])}),()=>{t=!1}},[e,l]),{list:t}}}},function(e){e.O(0,[605,2971,2117,1744],function(){return e(e.s=9049)}),_N_E=e.O()}]);