(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6781],{4542:function(e,t,r){Promise.resolve().then(r.bind(r,1489))},1489:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var a=r(7437),s=r(2265),d=r(605),i=r(9376),l=r(6334),n=r(4358),c=r(7648);function x(){let{data:e,status:t}=(0,d.useSession)(),r=(0,i.useRouter)(),[x,o]=(0,s.useState)([]),[h,g]=(0,s.useState)(!0),[m,u]=(0,s.useState)(""),[p,y]=(0,s.useState)("ALL"),[b,j]=(0,s.useState)("ALL");(0,s.useEffect)(()=>{if("unauthenticated"===t)r.push("/login");else if("authenticated"===t){var a;"SUPER_ADMIN"!==(null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.role)?r.push("/dashboard"):v()}},[t,e,r]),(0,s.useEffect)(()=>{"authenticated"===t&&v()},[m,p,b]);let v=async()=>{try{g(!0);let e=new URLSearchParams;"ALL"!==p&&e.append("status",p),"ALL"!==b&&e.append("plan",b),m&&e.append("search",m);let t=await fetch("/api/customers?".concat(e)),r=await t.json();t.ok?o(r.customers):alert(r.error||"고객회사 목록을 불러오는데 실패했습니다.")}catch(e){alert("고객회사 목록을 불러오는데 실패했습니다.")}finally{g(!1)}},f=async e=>{if(confirm("이 고객회사를 승인하시겠습니까?"))try{let t=await fetch("/api/customers/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"approve"})}),r=await t.json();t.ok?(alert(r.message),v()):alert(r.error||"승인에 실패했습니다.")}catch(e){alert("승인 중 오류가 발생했습니다.")}},k=async e=>{if(confirm("이 고객회사를 거부하시겠습니까?"))try{let t=await fetch("/api/customers/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reject"})}),r=await t.json();t.ok?(alert(r.message),v()):alert(r.error||"거부에 실패했습니다.")}catch(e){alert("거부 중 오류가 발생했습니다.")}},N=e=>{sessionStorage.setItem("viewAsCustomer",e),r.push("/dashboard")},w=e=>e?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";return h?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"text-gray-500",children:"로딩 중..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)(n.Z,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"고객회사 관리"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"고객회사 승인 및 관리"})]}),(0,a.jsx)(c.default,{href:"/admin/dashboard",children:(0,a.jsx)(l.Z,{children:"← 대시보드로"})})]}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"전체 "}),(0,a.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:x.length})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"승인대기 "}),(0,a.jsx)("span",{className:"font-bold text-yellow-600",children:x.filter(e=>!e.isActive).length})]})]}),(0,a.jsx)("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),(0,a.jsx)("input",{type:"text",placeholder:"회사명 또는 사업자등록번호 검색",value:m,onChange:e=>u(e.target.value),className:"flex-1 min-w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white"}),(0,a.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white",children:[(0,a.jsx)("option",{value:"ALL",children:"전체 상태"}),(0,a.jsx)("option",{value:"PENDING",children:"승인 대기"}),(0,a.jsx)("option",{value:"APPROVED",children:"승인됨"})]}),(0,a.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white",children:[(0,a.jsx)("option",{value:"ALL",children:"전체 플랜"}),(0,a.jsx)("option",{value:"FREE",children:"FREE"}),(0,a.jsx)("option",{value:"BASIC",children:"BASIC"}),(0,a.jsx)("option",{value:"PLUS",children:"PLUS"}),(0,a.jsx)("option",{value:"MASTER",children:"MASTER"})]})]})}),(0,a.jsxs)("div",{className:"hidden md:block bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-900 sticky top-0 z-10",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"회사명"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"사업자등록번호"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"관리자"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"사용자 수"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"상태"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"등록일"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"액션"})]})}),(0,a.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:x.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),e.address&&(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.address})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.businessNumber||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.users[0]?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.users[0].name}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.users[0].email})]}):(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"-"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e._count.users}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(w(e.isActive)),children:e.isActive?"활성":"승인 대기"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.isActive?(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("button",{onClick:()=>r.push("/admin/customers/".concat(e.id)),className:"px-3 py-1 bg-blue-100 text-blue-700 hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-200 dark:hover:bg-blue-800 rounded text-left",children:"상세"}),(0,a.jsx)("button",{onClick:()=>N(e.id),className:"px-3 py-1 bg-purple-100 text-purple-700 hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-200 dark:hover:bg-purple-800 rounded text-left",children:"시스템 보기"})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("button",{onClick:()=>f(e.id),className:"px-3 py-1 bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900 dark:text-green-200 dark:hover:bg-green-800 rounded text-left",children:"승인"}),(0,a.jsx)("button",{onClick:()=>k(e.id),className:"px-3 py-1 bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900 dark:text-red-200 dark:hover:bg-red-800 rounded text-left",children:"거부"})]})})]},e.id))})]})}),0===x.length&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"등록된 고객회사가 없습니다."})]}),(0,a.jsx)("div",{className:"md:hidden space-y-3",children:0===x.length?(0,a.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6 text-center text-gray-500",children:"등록된 고객회사가 없습니다."}):x.map(e=>(0,a.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(w(e.isActive)),children:e.isActive?"활성":"승인 대기"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[(0,a.jsx)("div",{className:"font-medium text-lg",children:e.name}),e.address&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["\uD83D\uDCCD ",e.address]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCBC 사업자:"})," ",e.businessNumber||"-"]}),e.users[0]&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDC64 관리자:"})," ",e.users[0].name,(0,a.jsx)("div",{className:"text-xs text-gray-500 ml-6",children:e.users[0].email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDC65 사용자:"})," ",e._count.users,"명"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCC5 등록일:"})," ",new Date(e.createdAt).toLocaleDateString()]}),(0,a.jsx)("div",{className:"flex flex-col gap-2 pt-2",children:e.isActive?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>r.push("/admin/customers/".concat(e.id)),className:"w-full px-3 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded text-sm",children:"상세"}),(0,a.jsx)("button",{onClick:()=>N(e.id),className:"w-full px-3 py-2 bg-purple-500 text-white hover:bg-purple-600 rounded text-sm",children:"시스템 보기"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>f(e.id),className:"w-full px-3 py-2 bg-green-500 text-white hover:bg-green-600 rounded text-sm",children:"승인"}),(0,a.jsx)("button",{onClick:()=>k(e.id),className:"w-full px-3 py-2 bg-gray-500 text-white hover:bg-gray-600 rounded text-sm",children:"거부"})]})})]})]},e.id))})]})]})}},4358:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var a=r(7437),s=r(605),d=r(9376),i=r(2265);function l(){var e,t;let{data:r}=(0,s.useSession)();(0,d.useRouter)();let[l,n]=(0,i.useState)(!1),c=(null==r?void 0:null===(e=r.user)||void 0===e?void 0:e.name)||"",x=(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.email)||"";return(0,a.jsx)("header",{className:"h-16 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 sticky top-0 z-40",children:(0,a.jsxs)("div",{className:"mx-auto h-full px-6 flex items-center justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"시스템 관리자"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>n(!l),className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center text-white font-semibold",children:c.charAt(0).toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:x})]}),(0,a.jsx)("div",{className:"py-1",children:(0,a.jsx)("button",{onClick:()=>{sessionStorage.removeItem("viewAsOrganization"),sessionStorage.removeItem("viewAsCustomer"),(0,s.signOut)({callbackUrl:"/login"})},className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700",children:"로그아웃"})})]})]})]})]})})}},6334:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(7437);r(2265);let s={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},d={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i(e){let{variant:t="primary",size:r="md",className:i="",...l}=e;return(0,a.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(s[t]," ").concat(d[r]," ").concat(i),...l})}}},function(e){e.O(0,[605,3448,2971,2117,1744],function(){return e(e.s=4542)}),_N_E=e.O()}]);