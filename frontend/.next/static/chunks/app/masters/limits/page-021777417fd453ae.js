(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2435],{6195:function(e,t,s){Promise.resolve().then(s.bind(s,816))},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},816:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(7437),r=s(2265),n=s(2397),l=s(4755),i=s(9548),c=s(8776),d=s(6334),o=s(2827),x=s(1515),u=s(6819);function m(e){let{isOpen:t,onClose:s,onSuccess:n,limit:x}=e,{list:m}=(0,l.n)(),{items:g}=(0,c.F)(),[h,y]=(0,r.useState)(""),[p,b]=(0,r.useState)(""),[f,j]=(0,r.useState)(""),[v,N]=(0,r.useState)(""),[k,w]=(0,r.useState)("일반지역"),[C,S]=(0,r.useState)(!1),{list:D}=(0,i.D)(h||void 0),I=g.filter(e=>("오염물질"===e.category||"채취환경"===e.category||"보조항목"===e.category)&&!1!==e.isActive).sort((e,t)=>{let s="오염물질"===e.category,a="오염물질"===t.category;return s&&!a?-1:!s&&a?1:e.name.localeCompare(t.name)});(0,r.useEffect)(()=>{t&&x?(y(x.customerId||""),b(x.stackId||""),j(x.itemKey||""),N(String(x.limit||"")),w(x.region||"")):t&&(y(""),b(""),j(""),N(""),w(""))},[t,x]);let A=async e=>{if(e.preventDefault(),!f||!v){alert("항목과 기준값을 입력해주세요.");return}S(!0);try{if(null==x?void 0:x.id){await fetch("/api/limits?id=".concat(x.id),{method:"DELETE"});let e={limits:[{itemKey:f,limit:parseFloat(v)}],customerId:h||"",stackId:p||"",region:k||"",createdBy:"admin"},t=await fetch("/api/limits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)alert("수정되었습니다."),n(),s();else{let e=await t.json();alert(e.error||"수정 실패")}}else{let e={limits:[{itemKey:f,limit:parseFloat(v)}],customerId:h||"",stackId:p||"",region:k||"",createdBy:"admin"},t=await fetch("/api/limits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)alert("저장되었습니다."),n(),s();else{let e=await t.json();alert(e.error||"저장 실패")}}}catch(e){alert("저장 중 오류가 발생했습니다.")}finally{S(!1)}};return t?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b dark:border-gray-700",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:x?"배출허용기준 수정":"배출허용기준 추가"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:A,className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"고객사"}),(0,a.jsxs)(u.Z,{value:h,onChange:e=>{y(e.target.value),b("")},children:[(0,a.jsx)("option",{value:"",children:"전체"}),m.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"굴뚝"}),(0,a.jsxs)(u.Z,{value:p,onChange:e=>b(e.target.value),disabled:!h,children:[(0,a.jsx)("option",{value:"",children:"전체"}),D.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"측정항목 *"}),(0,a.jsxs)(u.Z,{value:f,onChange:e=>j(e.target.value),required:!0,children:[(0,a.jsx)("option",{value:"",children:"선택하세요"}),I.map(e=>(0,a.jsxs)("option",{value:e.key,children:[e.name," (",e.key,")"]},e.key))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"기준값 *"}),(0,a.jsx)(o.Z,{type:"number",step:"0.01",value:v,onChange:e=>N(e.target.value),placeholder:"예: 20",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"지역 구분"}),(0,a.jsxs)(u.Z,{value:k,onChange:e=>w(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"전체"}),(0,a.jsx)("option",{value:"일반지역",children:"일반지역"}),(0,a.jsx)("option",{value:"특별대책지역",children:"특별대책지역"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end pt-4",children:[(0,a.jsx)(d.Z,{type:"button",variant:"secondary",onClick:s,children:"취소"}),(0,a.jsx)(d.Z,{type:"submit",disabled:C,children:C?"저장 중...":"저장"})]})]})]})}):null}function g(e){let{isOpen:t,onClose:s}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b dark:border-gray-700",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold flex items-center gap-2",children:"❓ 배출허용기준 관리 도움말"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCCB 컬럼 설명"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("span",{className:"font-medium min-w-[80px]",children:"범위:"}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"배출허용기준이 어느 수준에서 적용되는지 표시 (전체/고객사별/굴뚝별)"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("span",{className:"font-medium min-w-[80px]",children:"고객사:"}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:'실제 어느 고객사에 적용되는지 표시 (범위가 "전체"면 "전체" 표시)'})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("span",{className:"font-medium min-w-[80px]",children:"굴뚝:"}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"특정 굴뚝에만 적용되는 경우 굴뚝명 표시"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83C\uDFAF 범위 종류"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 whitespace-nowrap",children:"공통"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:"공통 기준"}),(0,a.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"모든 고객사, 모든 굴뚝에 적용되는 기본 기준입니다."})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 whitespace-nowrap",children:"고객사별"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:"고객사별 기준"}),(0,a.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"특정 고객사의 모든 굴뚝에 적용됩니다. (예: A기업 전체)"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 whitespace-nowrap",children:"굴뚝별"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:"굴뚝별 기준"}),(0,a.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"특정 고객사의 특정 굴뚝에만 적용됩니다. (예: A기업 S-001)"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"⚡ 적용 우선순위 (높음 → 낮음)"}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/10 rounded-lg p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:"1순위"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"굴뚝별 기준"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(특정 굴뚝에만 적용)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:"2순위"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"고객사별 기준"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(해당 고객사 전체)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:"3순위"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"공통 기준"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(모든 고객사/굴뚝)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-200 text-gray-600 dark:bg-gray-800 dark:text-gray-400",children:"기본"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"기본 기준"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(측정항목 테이블의 기본값)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCA1 사용 예시"}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 space-y-2 text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:"시나리오: 먼지(PM) 배출허용기준"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs text-gray-600 dark:text-gray-400 pl-4",children:[(0,a.jsx)("div",{children:"• 일반 기준: 20 mg/Sm\xb3 (공통 기준)"}),(0,a.jsx)("div",{children:"• A기업: 15 mg/Sm\xb3 (고객사별 기준 - 특별관리 대상)"}),(0,a.jsx)("div",{children:"• A기업 S-001: 18 mg/Sm\xb3 (굴뚝별 기준 - 노후화로 완화)"})]}),(0,a.jsxs)("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("div",{className:"font-medium text-xs",children:"적용 결과:"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 pl-4 space-y-1",children:[(0,a.jsxs)("div",{children:["→ A기업 S-001: ",(0,a.jsx)("strong",{children:"18"})," (굴뚝별 우선)"]}),(0,a.jsxs)("div",{children:["→ A기업 S-002: ",(0,a.jsx)("strong",{children:"15"})," (고객사별 적용)"]}),(0,a.jsxs)("div",{children:["→ B기업: ",(0,a.jsx)("strong",{children:"20"})," (공통 기준 적용)"]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCCC 안내사항"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("li",{children:"특별대책지역은 일반지역 기준의 80%가 자동 계산됩니다"}),(0,a.jsx)("li",{children:"비활성화된 기준은 적용되지 않습니다"}),(0,a.jsx)("li",{children:"관리자만 추가/수정/삭제가 가능합니다"}),(0,a.jsx)("li",{children:"수정 시 고객사, 굴뚝, 항목을 모두 변경할 수 있습니다"})]})]})]}),(0,a.jsx)("div",{className:"p-4 border-t flex justify-end",children:(0,a.jsx)(d.Z,{onClick:s,children:"확인"})})]})}):null}var h=s(3158);function y(){let{user:e}=(0,n.a)(),t=null==e?void 0:e.role,{list:s}=(0,l.n)(),{items:u}=(0,c.F)(),[y,p]=(0,r.useState)([]),[b,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(""),[N,k]=(0,r.useState)("all"),[w,C]=(0,r.useState)(!1),[S,D]=(0,r.useState)(!1),[I,A]=(0,r.useState)(null),[E,T]=(0,r.useState)(!1),[O,R]=(0,r.useState)(!1),{list:P}=(0,i.D)();(0,r.useEffect)(()=>{K()},[]);let K=async()=>{f(!0);try{let e=await fetch("/api/limits"),t=await e.json();p(Array.isArray(t.data)?t.data:[])}catch(e){}finally{f(!1)}},U=e=>{let t=u.find(t=>t.key===e);return t?t.name:e},M=e=>{let t=u.find(t=>t.key===e);return t?t.unit:"-"},_=e=>{let t=u.find(t=>t.key===e);return t?t.category:""},z=e=>{var t;let s=u.find(t=>t.key===e);return s&&null!==(t=s.order)&&void 0!==t?t:0},Z=e=>{if(!e)return"전체";let t=s.find(t=>t.id===e);return t?t.name:e},F=e=>{if(!e)return"-";let t=P.find(t=>t.id===e);return t?t.name:e},L=e=>e.stackId?"굴뚝별":e.customerId?"고객사별":"전체",B=(0,r.useMemo)(()=>y,[y]),G=(0,r.useMemo)(()=>{let e=B.filter(e=>{let t=!!w||!1!==e.isActive,s=!0;if("global"===N?s=!e.customerId&&!e.stackId:"customer"===N?s=!!e.customerId&&!e.stackId:"stack"===N&&(s=!!e.stackId),!j)return t&&s;let a=j.toLowerCase(),r=U(e.itemKey).toLowerCase().includes(a)||e.itemKey.toLowerCase().includes(a)||Z(e.customerId).toLowerCase().includes(a)||F(e.stackId).toLowerCase().includes(a);return t&&s&&r}),t=(e,t)=>{let s=z(e.itemKey),a=z(t.itemKey);return 0===s&&0!==a?1:0!==s&&0===a?-1:s===a?U(e.itemKey).localeCompare(U(t.itemKey)):s-a},s=e.filter(e=>"오염물질"===_(e.itemKey)),a=e.filter(e=>"채취환경"===_(e.itemKey)),r=e.filter(e=>{let t=_(e.itemKey);return"오염물질"!==t&&"채취환경"!==t});return s.sort(t),a.sort(t),r.sort(t),[...s,...a,...r]},[B,j,N,w,u]),V=e=>{A(e),D(!0)},W=()=>{D(!1),A(null)},J=async e=>{try{let t=await fetch("/api/limits/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!e.isActive})});if(!t.ok){let e=await t.json();throw Error(e.error||"상태 변경 실패")}K()}catch(e){alert(e.message||"상태 변경 중 오류가 발생했습니다.")}},H=async e=>{if(confirm("".concat(U(e.itemKey)," 기준을 삭제하시겠습니까?")))try{let t=await fetch("/api/limits?id=".concat(e.id),{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"삭제 실패")}alert("삭제되었습니다."),K()}catch(e){alert(e.message||"삭제 중 오류가 발생했습니다.")}},q=async e=>{try{let t=await e.text(),s=await fetch("/api/limits/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({csvText:t})}),a=await s.json();if(s.ok)return K(),{success:!0,message:a.message||"업로드 성공",count:a.count};return{success:!1,message:a.error||"업로드 실패"}}catch(e){return{success:!1,message:e.message||"업로드 중 오류가 발생했습니다."}}};return(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold whitespace-nowrap mb-1.5",children:"배출허용기준 관리"}),(0,a.jsx)("span",{className:"text-gray-300 dark:text-gray-600 mb-1.5",children:"|"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"검색"}),(0,a.jsx)(o.Z,{className:"text-sm h-8",style:{width:"352px",minWidth:"352px"},value:j,onChange:e=>v(e.target.value),placeholder:"항목명, 항목코드, 고객사, 굴뚝 등"})]}),(0,a.jsxs)("div",{className:"flex gap-1.5 mb-1.5",children:[(0,a.jsx)("button",{onClick:()=>k("all"),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat("all"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"모두보기"}),(0,a.jsx)("button",{onClick:()=>k("global"),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat("global"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"공통기준"}),(0,a.jsx)("button",{onClick:()=>k("customer"),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat("customer"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"고객사별"}),(0,a.jsx)("button",{onClick:()=>k("stack"),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat("stack"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"굴뚝별"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-1.5 text-xs cursor-pointer mb-1.5 whitespace-nowrap ml-auto",children:[(0,a.jsx)("input",{type:"checkbox",checked:w,onChange:e=>C(e.target.checked),className:"rounded"}),"비활성 표시"]}),(0,a.jsxs)("div",{className:"flex gap-1.5 mb-1.5",children:[(0,a.jsx)(d.Z,{size:"sm",variant:"secondary",onClick:()=>T(!0),children:"❓ 도움말"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{size:"sm",variant:"secondary",onClick:()=>{let e=new Blob(["\uFEFF"+[["범위","고객사","굴뚝","구분","항목코드","항목명","단위","설정기준","지역구분"],...G.map(e=>[L(e),Z(e.customerId),F(e.stackId),_(e.itemKey)||"-",e.itemKey,U(e.itemKey),M(e.itemKey),e.limit,e.region||"-"])].map(e=>e.map(e=>'"'.concat(String(null!=e?e:"").replace(/"/g,'""'),'"')).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="배출허용기준_".concat(new Date().toISOString().slice(0,10),".csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},children:"Excel"}),(0,a.jsx)(d.Z,{size:"sm",variant:"secondary",onClick:()=>R(!0),children:"일괄업로드"}),(0,a.jsx)(d.Z,{size:"sm",onClick:()=>{A(null),D(!0)},children:"+ 신규 추가"})]})]})]})}),(0,a.jsx)("div",{className:"hidden md:block rounded-lg border overflow-x-auto max-h-[calc(100vh-180px)] overflow-y-auto",children:(0,a.jsxs)(x.iA,{className:"min-w-[1200px]",children:[(0,a.jsx)(x.hr,{className:"bg-gray-50 dark:bg-white/10 sticky top-0 z-10",children:(0,a.jsxs)(x.Tr,{children:[(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"상태"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"범위"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"고객사"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"굴뚝"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"구분"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"항목코드"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"항목명"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"단위"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"설정기준"}),(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"지역구분"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)(x.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"액션"})]})}),(0,a.jsx)(x.p3,{children:0===G.length?(0,a.jsx)(x.Tr,{children:(0,a.jsx)(x.Td,{colSpan:"SUPER_ADMIN"===t||"ORG_ADMIN"===t?11:10,className:"text-center text-gray-500 py-8",children:"설정된 배출허용기준이 없습니다"})}):G.map(e=>{let s=!1!==e.isActive;return(0,a.jsxs)(x.Tr,{className:s?"":"opacity-50 bg-gray-50 dark:bg-gray-900/20",children:[(0,a.jsx)(x.Td,{children:s?(0,a.jsx)("span",{className:"inline-block px-2 py-0.5 rounded bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300 text-xs",children:"활성"}):(0,a.jsx)("span",{className:"inline-block px-2 py-0.5 rounded bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 text-xs",children:"비활성"})}),(0,a.jsx)(x.Td,{children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.stackId?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":e.customerId?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"),children:L(e)})}),(0,a.jsx)(x.Td,{children:Z(e.customerId)}),(0,a.jsx)(x.Td,{children:F(e.stackId)}),(0,a.jsx)(x.Td,{children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("오염물질"===_(e.itemKey)?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"채취환경"===_(e.itemKey)?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"),children:_(e.itemKey)||"-"})}),(0,a.jsx)(x.Td,{className:"font-mono text-xs",children:e.itemKey}),(0,a.jsxs)(x.Td,{className:"font-medium",children:[U(e.itemKey),e.isDefault&&(0,a.jsx)("span",{className:"ml-2 inline-block px-2 py-0.5 rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300 text-xs",children:"기본값"})]}),(0,a.jsx)(x.Td,{className:"text-center",children:M(e.itemKey)}),(0,a.jsx)(x.Td,{className:"font-semibold",children:e.limit}),(0,a.jsx)(x.Td,{className:"text-sm",children:e.region||"-"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)(x.Td,{children:(0,a.jsxs)("div",{className:"flex gap-2 whitespace-nowrap",children:[(0,a.jsx)("button",{onClick:()=>V(e),className:"text-xs text-green-600 hover:underline",children:"수정"}),(0,a.jsx)("button",{onClick:()=>J(e),className:"text-xs text-blue-600 hover:underline",children:s?"비활성화":"활성화"}),!s&&(0,a.jsx)("button",{onClick:()=>H(e),className:"text-xs text-red-600 hover:underline",children:"삭제"})]})})]},e.id)})})]})}),(0,a.jsx)("div",{className:"md:hidden space-y-3",children:0===G.length?(0,a.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6 text-center text-gray-500",children:"설정된 배출허용기준이 없습니다"}):G.map(e=>{let s=!1!==e.isActive;return(0,a.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2 ".concat(s?"":"opacity-50"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("span",{className:"inline-block px-2 py-0.5 rounded text-xs ".concat(s?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"),children:s?"활성":"비활성"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(e.stackId?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":e.customerId?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"),children:L(e)})]}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>V(e),className:"text-xs text-blue-600 hover:underline",children:"수정"}),(0,a.jsx)("button",{onClick:()=>J(e),className:"text-xs text-blue-600 hover:underline",children:s?"비활성화":"활성화"}),!s&&(0,a.jsx)("button",{onClick:()=>H(e),className:"text-xs text-gray-600 hover:underline",children:"삭제"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCCD 고객사:"})," ",Z(e.customerId)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDFED 굴뚝:"})," ",F(e.stackId)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83C\uDFF7️ 구분:"})," ",(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("오염물질"===_(e.itemKey)?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"채취환경"===_(e.itemKey)?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"),children:_(e.itemKey)||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCCB 코드:"})," ",e.itemKey]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCDD 항목:"})," ",U(e.itemKey),e.isDefault&&(0,a.jsx)("span",{className:"ml-2 inline-block px-2 py-0.5 rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300 text-xs",children:"기본값"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDCCF 단위:"})," ",M(e.itemKey)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"⚠️ 기준:"})," ",(0,a.jsx)("span",{className:"font-semibold",children:e.limit})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\uD83D\uDDFA️ 지역:"})," ",e.region||"-"]})]})]},e.id)})}),(0,a.jsx)(m,{isOpen:S,onClose:W,onSuccess:()=>{K(),W()},limit:I}),(0,a.jsx)(g,{isOpen:E,onClose:()=>T(!1)}),(0,a.jsx)(h.Z,{isOpen:O,onClose:()=>R(!1),title:"배출허용기준 일괄업로드",templateHeaders:["범위","고객사코드","굴뚝번호","항목코드","설정기준","지역구분"],exampleRow:["공통","","","dust","20","일반지역"],templateFileName:"배출허용기준_일괄업로드_양식.csv",onUpload:q,parseInstructions:"범위는 '공통', '고객사별', '굴뚝별' 중 하나입니다. 고객사별은 고객사코드 필수, 굴뚝별은 고객사코드와 굴뚝번호 모두 필수입니다."})]})}},3158:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(2265),n=s(6334);function l(e){let{isOpen:t,onClose:s,title:l,templateHeaders:i,exampleRow:c,templateFileName:d,onUpload:o,parseInstructions:x="양식에 맞게 작성한 CSV 파일을 업로드하세요."}=e,[u,m]=(0,r.useState)(null),[g,h]=(0,r.useState)(!1),[y,p]=(0,r.useState)(""),b=async()=>{if(!u){p("파일을 선택해주세요.");return}h(!0),p("");try{let e=await o(u);if(e.success){let t=e.message||"업로드 완료";p("✅ ".concat(t)),m(null)}else p("❌ ".concat(e.message||"업로드 실패"))}catch(e){p("❌ 오류: ".concat(e.message||"업로드 중 문제가 발생했습니다."))}finally{h(!1)}},f=()=>{g||(m(null),p(""),s())};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:f,children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:l}),(0,a.jsx)("button",{onClick:f,disabled:g,className:"text-gray-500 hover:text-gray-700 disabled:opacity-50",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"\uD83D\uDCCB 업로드 절차"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[(0,a.jsx)("li",{children:'아래 "업로드 양식 다운로드" 버튼을 클릭하여 CSV 양식을 다운로드합니다.'}),(0,a.jsx)("li",{children:"다운로드한 양식에 데이터를 입력합니다. (예시 행 참고)"}),(0,a.jsx)("li",{children:'"파일 선택" 버튼을 클릭하여 작성한 CSV 파일을 선택합니다.'}),(0,a.jsx)("li",{children:'"업로드" 버튼을 클릭하여 데이터를 등록합니다.'})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:x}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(n.Z,{variant:"secondary",onClick:()=>{let e=new Blob(["\uFEFF"+i.map(e=>'"'.concat(e,'"')).join(",")+"\n"+c.map(e=>'"'.concat(e,'"')).join(",")+"\n"],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=d,s.click(),URL.revokeObjectURL(t)},disabled:g,className:"flex-1",children:"\uD83D\uDCE5 업로드 양식 다운로드"})}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("label",{className:"flex-1",children:[(0,a.jsx)("div",{className:"px-4 py-2 border-2 border-dashed rounded cursor-pointer text-center transition-colors ".concat(u?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400"," ").concat(g?"opacity-50 cursor-not-allowed":""),children:u?(0,a.jsxs)("span",{className:"text-sm",children:["\uD83D\uDCC4 ",u.name]}):(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"\uD83D\uDCC1 파일 선택 (CSV)"})}),(0,a.jsx)("input",{type:"file",accept:".csv",className:"hidden",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&(m(s),p(""))},disabled:g})]})}),(0,a.jsx)(n.Z,{onClick:b,disabled:!u||g,className:"w-full",children:g?"업로드 중...":"업로드"})]}),y&&(0,a.jsx)("div",{className:"text-sm p-4 rounded border-2 ".concat(y.startsWith("✅")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-500":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-500"),children:(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("pre",{className:"whitespace-pre-wrap font-sans",children:y}),(0,a.jsx)(n.Z,{size:"sm",onClick:()=>{p(""),f()},className:"self-end",children:"확인"})]})})]}),!y&&(0,a.jsx)("div",{className:"mt-6 flex justify-end gap-2",children:(0,a.jsx)(n.Z,{variant:"secondary",onClick:f,disabled:g,children:"닫기"})})]})}):null}},6334:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437);s(2265);let r={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},n={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function l(e){let{variant:t="primary",size:s="md",className:l="",...i}=e;return(0,a.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(r[t]," ").concat(n[s]," ").concat(l),...i})}},2827:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(7437);function r(e){let{className:t="",...s}=e;return(0,a.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...s})}s(2265)},6819:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(7437);function r(e){let{className:t="",children:s,...r}=e;return(0,a.jsx)("select",{className:"".concat("w-full rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...r,children:s})}s(2265)},1515:function(e,t,s){"use strict";s.d(t,{Td:function(){return d},Th:function(){return c},Tr:function(){return i},hr:function(){return n},iA:function(){return r},p3:function(){return l}});var a=s(7437);function r(e){let{className:t="",...s}=e;return(0,a.jsx)("table",{className:"w-full text-sm border-collapse ".concat(t),...s})}function n(e){return(0,a.jsx)("thead",{...e})}function l(e){return(0,a.jsx)("tbody",{...e})}function i(e){return(0,a.jsx)("tr",{className:"border-b last:border-0 border-gray-200 dark:border-white/10",...e})}function c(e){let{className:t="",...s}=e;return(0,a.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-600 dark:text-gray-300 ".concat(t),...s})}function d(e){let{className:t="",...s}=e;return(0,a.jsx)("td",{className:"py-2 px-3 ".concat(t),...s})}s(2265)},2397:function(e,t,s){"use strict";s.d(t,{H:function(){return d},a:function(){return o}});var a=s(7437),r=s(2265),n=s(605),l=s(9376);function i(){return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"mb-16",children:[(0,a.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-white text-center",children:"오염물질 측정 관리 시스템"}),(0,a.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Pollutant Measurement Management System"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-gray-200 dark:border-gray-700 border-t-blue-600 rounded-full animate-spin"})}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"로딩 중..."})]}),(0,a.jsx)("div",{className:"mt-16"})]})}let c=(0,r.createContext)(null);function d(e){let{children:t}=e,{data:s,status:d}=(0,n.useSession)(),[o,x]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),g=(0,l.usePathname)();(0,r.useEffect)(()=>{"loading"!==d&&m(!1),(null==s?void 0:s.user)?x(s.user):"unauthenticated"===d&&x(null)},[s,d]);let h="loading"===d||u;return!h||"/login"===g||(null==g?void 0:g.startsWith("/register"))||(null==g?void 0:g.startsWith("/invite"))||(null==g?void 0:g.startsWith("/auth"))?(0,a.jsx)(c.Provider,{value:{user:o,loading:h},children:t}):(0,a.jsx)(i,{})}function o(){let e=(0,r.useContext)(c);if(!e)throw Error("AuthProvider is missing");return e}},2891:function(e,t,s){"use strict";s.d(t,{OrganizationProvider:function(){return i},o:function(){return c}});var a=s(7437),r=s(2265),n=s(605);let l=(0,r.createContext)(void 0);function i(e){var t,s,i;let{children:c}=e,{data:d,status:o}=(0,n.useSession)(),[x,u]=(0,r.useState)(null),[m,g]=(0,r.useState)([]),[h,y]=(0,r.useState)(!0),p=(null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.role)==="SUPER_ADMIN",b=null==d?void 0:null===(s=d.user)||void 0===s?void 0:s.role,f=null==d?void 0:null===(i=d.user)||void 0===i?void 0:i.organizationId,j="CUSTOMER_ADMIN"===b||"CUSTOMER_USER"===b;(0,r.useEffect)(()=>{if("loading"!==o){if(!d||j){y(!1);return}p&&sessionStorage.getItem("viewAsOrganization"),p?v():f?N(f):y(!1)}},[d,o,p,f,j]),(0,r.useEffect)(()=>{if(!p)return;let e=sessionStorage.getItem("viewAsOrganization");e&&(null==x?void 0:x.id)!==e&&v();let t=setInterval(()=>{let e=sessionStorage.getItem("viewAsOrganization");if(e&&(null==x?void 0:x.id)!==e)v();else if(!e&&x){let e=localStorage.getItem("selectedOrgId");e&&x.id!==e&&v()}},500);return()=>clearInterval(t)},[p,x]);let v=async()=>{try{let e=await fetch("/api/organizations?status=APPROVED"),t=await e.json();if(e.ok){let e=t.organizations||[];g(e);let s=sessionStorage.getItem("viewAsOrganization");if(s){let t=e.find(e=>e.id===s);if(t){u(t);return}}let a=localStorage.getItem("selectedOrgId");if(a){let t=e.find(e=>e.id===a);t?u(t):e.length>0&&u(e[0])}else e.length>0&&u(e[0])}}catch(e){}finally{y(!1)}},N=async e=>{try{let t=await fetch("/api/organizations/".concat(e)),s=await t.json();if(t.ok){let e=s.organization;g([e]),u(e)}}catch(e){}finally{y(!1)}};return(0,a.jsx)(l.Provider,{value:{selectedOrg:x,setSelectedOrg:e=>{u(e),e?localStorage.setItem("selectedOrgId",e.id):localStorage.removeItem("selectedOrgId")},organizations:m,loading:h,isSuperAdmin:p},children:c})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useOrganization must be used within OrganizationProvider");return e}},4755:function(e,t,s){"use strict";s.d(t,{n:function(){return l}});var a=s(2265),r=s(2891),n=s(605);function l(){var e,t;let[s,l]=(0,a.useState)([]),{selectedOrg:i}=(0,r.o)(),{data:c}=(0,n.useSession)(),d=null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.role,o=null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.customerId,x="CUSTOMER_ADMIN"===d||"CUSTOMER_USER"===d,u=(0,a.useCallback)(()=>{if(x&&o){fetch("/api/customers/".concat(o)).then(e=>e.json()).then(e=>{let t=e.customer||e.data;l(t?[t]:[])}).catch(e=>{l([])});return}if(!(null==i?void 0:i.id)){l([]);return}let e=new URLSearchParams;e.append("organizationId",i.id),e.append("tab","all"),fetch("/api/customers?".concat(e.toString())).then(e=>e.json()).then(e=>{l(e.customers||e.data||[])}).catch(e=>{l([])})},[i,x,o]);return(0,a.useEffect)(()=>{u()},[u]),{list:s,refetch:u}}},8776:function(e,t,s){"use strict";s.d(t,{F:function(){return l},r:function(){return i}});var a=s(2265),r=s(2891),n=s(605);function l(){let[e,t]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let e=!0;return fetch("/api/items").then(e=>e.json()).then(s=>{e&&t(s.data||[])}).catch(()=>{e&&t([])}),()=>{e=!1}},[]),{items:e}}function i(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{customerId:s,stack:l,stacks:i,itemKey:c,page:d=1,pageSize:o=50,sort:x,start:u,end:m}=t,[g,h]=(0,a.useState)([]),[y,p]=(0,a.useState)(0),{selectedOrg:b}=(0,r.o)(),{data:f}=(0,n.useSession)(),j=null==f?void 0:null===(e=f.user)||void 0===e?void 0:e.role,v="CUSTOMER_ADMIN"===j||"CUSTOMER_USER"===j;(0,a.useEffect)(()=>{let e=!0,t=new AbortController;if(!v&&!(null==b?void 0:b.id)){h([]);return}let a=new URLSearchParams;return s&&a.set("customerId",s),i&&i.length?i.forEach(e=>a.append("stack",e)):l&&a.set("stack",l),c&&a.set("itemKey",c),u&&a.set("start",u),m&&a.set("end",m),(null==b?void 0:b.id)&&a.set("organizationId",b.id),fetch("/api/measurements?".concat(a.toString()),{signal:t.signal}).then(e=>e.json()).then(t=>{e&&h(Array.isArray(t.measurements)?t.measurements:Array.isArray(t.data)?t.data:[])}).catch(t=>{t.name,e&&h([])}),()=>{e=!1,t.abort()}},[s,l,(i||[]).join("|"),c,u,m,y,b,v]);let N=(0,a.useMemo)(()=>{if(!x)return g;let{key:e,dir:t}=x,s=[...g];return s.sort((s,a)=>{let r=s[e],n=a[e];return r<n?"asc"===t?-1:1:r>n?"asc"===t?1:-1:0}),s},[g,x]),k=N.length,w=(d-1)*o;return{data:o>=999999?N:N.slice(w,w+o),total:k,page:d,pageSize:o,mutate:()=>p(e=>e+1)}}},9548:function(e,t,s){"use strict";s.d(t,{D:function(){return n}});var a=s(2265),r=s(2891);function n(e){let[t,s]=(0,a.useState)([]),{selectedOrg:n}=(0,r.o)();return(0,a.useEffect)(()=>{let t=!0;if(!(null==n?void 0:n.id)){s([]);return}let a=new URLSearchParams;return e&&a.set("customerId",e),a.set("organizationId",n.id),fetch("/api/stacks?".concat(a.toString())).then(e=>e.json()).then(e=>{let a=(e.stacks||e.data||[]).filter(e=>!1!==e.isActive);t&&s(a)}).catch(e=>{t&&s([])}),()=>{t=!1}},[e,n]),{list:t}}}},function(e){e.O(0,[605,2971,2117,1744],function(){return e(e.s=6195)}),_N_E=e.O()}]);