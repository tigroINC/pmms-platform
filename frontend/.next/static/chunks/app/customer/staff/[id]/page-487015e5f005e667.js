(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7009],{6951:function(e,t,r){Promise.resolve().then(r.bind(r,3564))},3564:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var a=r(7437),s=r(2265),n=r(605),d=r(9376),i=r(7648),c=r(6334),l=r(2827);function o(){var e;let{data:t,status:r}=(0,n.useSession)(),o=(0,d.useRouter)(),x=(0,d.useParams)(),m=null==x?void 0:x.id,[h,g]=(0,s.useState)(null),[u,b]=(0,s.useState)(!0),[y,f]=(0,s.useState)(!1),[p,k]=(0,s.useState)({name:"",phone:"",department:"",position:"",role:""});(0,s.useEffect)(()=>{if("unauthenticated"===r){o.push("/login");return}if(null==t?void 0:t.user){let e=t.user.role;if("CUSTOMER_ADMIN"!==e&&"SUPER_ADMIN"!==e){o.push("/dashboard");return}j()}},[t,r,o,m]);let j=async()=>{try{b(!0);let e=await fetch("/api/customer/staff/".concat(m)),t=await e.json();e.ok?(g(t.staff),k({name:t.staff.name||"",phone:t.staff.phone||"",department:t.staff.department||"",position:t.staff.position||"",role:t.staff.role||""})):(alert(t.error||"직원 정보를 불러오는데 실패했습니다."),o.push("/customer/staff"))}catch(e){alert("직원 정보를 불러오는데 실패했습니다.")}finally{b(!1)}},v=async()=>{try{let e=await fetch("/api/customer/staff/".concat(m),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}),t=await e.json();e.ok?(alert("저장되었습니다."),f(!1),j()):alert(t.error||"저장에 실패했습니다.")}catch(e){alert("저장 중 오류가 발생했습니다.")}},N=async()=>{if(!h)return;let e=h.isActive?"비활성화":"활성화";if(confirm("이 직원을 ".concat(e,"하시겠습니까?")))try{let t=h.isActive?"deactivate":"activate",r=await fetch("/api/customer/staff/".concat(m,"/").concat(t),{method:"PATCH"}),a=await r.json();r.ok?(alert(a.message),j()):alert(a.error||"".concat(e,"에 실패했습니다."))}catch(t){alert("".concat(e," 중 오류가 발생했습니다."))}},w=async()=>{if(h&&confirm('"'.concat(h.name,'" 직원을 완전히 삭제하시겠습니까?\n\n⚠️ 이 작업은 되돌릴 수 없습니다.')))try{let e=await fetch("/api/customer/staff/".concat(m),{method:"DELETE"}),t=await e.json();e.ok?(alert("삭제되었습니다."),o.push("/customer/staff")):alert(t.error||"삭제에 실패했습니다.")}catch(e){alert("삭제 중 오류가 발생했습니다.")}};return u?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-gray-500",children:"로딩 중..."})})}):h?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"직원 상세"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"직원 정보 관리"})]}),(0,a.jsx)(i.default,{href:"/customer/staff",children:(0,a.jsx)("button",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"← 목록으로"})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"기본 정보"}),y?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{f(!1),k({name:h.name||"",phone:h.phone||"",department:h.department||"",position:h.position||"",role:h.role||""})},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"취소"}),(0,a.jsx)(c.Z,{onClick:v,children:"저장"})]}):(0,a.jsx)(c.Z,{onClick:()=>f(!0),children:"수정"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"이름"}),y?(0,a.jsx)(l.Z,{value:p.name,onChange:e=>k({...p,name:e.target.value})}):(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:h.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"이메일"}),(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:h.email}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"이메일은 변경할 수 없습니다."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"전화번호"}),y?(0,a.jsx)(l.Z,{value:p.phone,onChange:e=>k({...p,phone:e.target.value}),placeholder:"010-1234-5678"}):(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:h.phone||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"역할"}),y?(0,a.jsxs)("select",{value:p.role,onChange:e=>k({...p,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,a.jsx)("option",{value:"CUSTOMER_ADMIN",children:"고객사 관리자"}),(0,a.jsx)("option",{value:"CUSTOMER_USER",children:"고객사 사용자"})]}):(0,a.jsx)("div",{children:(e=h.role,(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat({CUSTOMER_ADMIN:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",CUSTOMER_USER:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"}[e]||"bg-gray-100 text-gray-800"),children:{CUSTOMER_ADMIN:"고객사 관리자",CUSTOMER_USER:"고객사 사용자"}[e]||e}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"부서"}),y?(0,a.jsx)(l.Z,{value:p.department,onChange:e=>k({...p,department:e.target.value}),placeholder:"환경안전팀"}):(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:h.department||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"직책"}),y?(0,a.jsx)(l.Z,{value:p.position,onChange:e=>k({...p,position:e.target.value}),placeholder:"팀장"}):(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:h.position||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"상태"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(h.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:h.isActive?"활성":"비활성"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"가입일"}),(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:new Date(h.createdAt).toLocaleDateString("ko-KR")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"최근 로그인"}),(0,a.jsx)("div",{className:"text-gray-900 dark:text-white",children:h.lastLoginAt?new Date(h.lastLoginAt).toLocaleDateString("ko-KR"):"없음"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"계정 관리"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:h.isActive?"계정 비활성화":"계정 활성화"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:h.isActive?"비활성화하면 로그인할 수 없습니다. 데이터는 유지됩니다.":"활성화하면 다시 로그인할 수 있습니다."})]}),(0,a.jsx)("button",{onClick:N,className:"px-4 py-2 rounded-md whitespace-nowrap ".concat(h.isActive?"bg-orange-600 hover:bg-orange-700 text-white":"bg-green-600 hover:bg-green-700 text-white"),children:h.isActive?"비활성화":"활성화"})]}),!h.isActive&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20 rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-red-900 dark:text-red-200",children:"계정 삭제"}),(0,a.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:"⚠️ 삭제하면 모든 데이터가 영구적으로 삭제됩니다. 이 작업은 되돌릴 수 없습니다."})]}),(0,a.jsx)("button",{onClick:w,className:"px-4 py-2 rounded-md whitespace-nowrap bg-red-600 hover:bg-red-700 text-white",children:"삭제"})]})]})]})]})}):null}},6334:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var a=r(7437);r(2265);let s={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},n={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function d(e){let{variant:t="primary",size:r="md",className:d="",...i}=e;return(0,a.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(s[t]," ").concat(n[r]," ").concat(d),...i})}},2827:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(7437);function s(e){let{className:t="",...r}=e;return(0,a.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...r})}r(2265)}},function(e){e.O(0,[605,3448,2971,2117,1744],function(){return e(e.s=6951)}),_N_E=e.O()}]);