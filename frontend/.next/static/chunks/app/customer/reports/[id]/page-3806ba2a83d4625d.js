(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3995],{67:function(){},2061:function(){},840:function(e,s,a){Promise.resolve().then(a.bind(a,5719))},9376:function(e,s,a){"use strict";var l=a(5475);a.o(l,"useParams")&&a.d(s,{useParams:function(){return l.useParams}}),a.o(l,"usePathname")&&a.d(s,{usePathname:function(){return l.usePathname}}),a.o(l,"useRouter")&&a.d(s,{useRouter:function(){return l.useRouter}}),a.o(l,"useSearchParams")&&a.d(s,{useSearchParams:function(){return l.useSearchParams}})},5719:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return n}});var l=a(7437),d=a(2265),c=a(9376),i=a(6334),t=a(2827),r=a(6660);function n(){let e=(0,c.useParams)(),s=(0,c.useRouter)(),a=e.id,[n,m]=(0,d.useState)(null),[h,x]=(0,d.useState)(!0);(0,d.useEffect)(()=>{o()},[a]);let o=async()=>{try{let e=await fetch("/api/reports/".concat(a)),s=await e.json();m(s.data)}catch(e){}finally{x(!1)}};if(h)return(0,l.jsx)("div",{className:"p-6 text-center",children:"로딩 중..."});if(!n)return(0,l.jsx)("div",{className:"p-6 text-center",children:"보고서를 찾을 수 없습니다."});let u=JSON.parse(n.measurements||"[]").filter(e=>null!==e.value&&void 0!==e.value&&""!==e.value&&0!==e.value);return(0,l.jsxs)("div",{className:"p-4 md:p-6 max-w-6xl mx-auto space-y-6",children:[(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"대기측정기록부"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["버전 ",n.version," | 공유됨"]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)(i.Z,{variant:"secondary",onClick:()=>(0,r.n)([n],"보고서_".concat(n.companyName,"_").concat(new Date(n.measuredAt).toLocaleDateString(),".xlsx")),className:"flex-1 md:flex-none",children:"\uD83D\uDCCA 엑셀"}),(0,l.jsx)(i.Z,{variant:"secondary",onClick:()=>window.open("/reports/".concat(a,"/pdf"),"_blank"),className:"flex-1 md:flex-none",children:"PDF 출력"}),(0,l.jsx)(i.Z,{variant:"secondary",onClick:()=>s.push("/customer/reports"),className:"flex-1 md:flex-none",children:"목록"})]})]})}),(0,l.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 md:p-6 space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"의뢰인 정보"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"상호(사업장명)"}),(0,l.jsx)(t.Z,{value:n.companyName||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"주소"}),(0,l.jsx)(t.Z,{value:n.address||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"대표자"}),(0,l.jsx)(t.Z,{value:n.representative||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"환경기술인"}),(0,l.jsx)(t.Z,{value:n.environmentalTech||"",disabled:!0})]})]})]}),(0,l.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 md:p-6 space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"일반현황"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"업종"}),(0,l.jsx)(t.Z,{value:n.industry||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"시설종류"}),(0,l.jsx)(t.Z,{value:n.facilityType||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"사업장종별"}),(0,l.jsx)(t.Z,{value:n.siteCategory||"",disabled:!0})]})]})]}),(0,l.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 md:p-6 space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"의뢰내용"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"측정용도"}),(0,l.jsx)(t.Z,{value:n.purpose||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"굴뚝명칭"}),(0,l.jsx)(t.Z,{value:n.stackName||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"높이(m)"}),(0,l.jsx)(t.Z,{type:"number",value:n.stackHeight||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"안지름(m)"}),(0,l.jsx)(t.Z,{type:"number",value:n.stackDiameter||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"굴뚝종별"}),(0,l.jsx)(t.Z,{value:n.stackType||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"의뢰항목"}),(0,l.jsx)(t.Z,{value:n.requestedItems||"",disabled:!0})]})]})]}),(0,l.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 md:p-6 space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"시료채취"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"날씨"}),(0,l.jsx)(t.Z,{value:n.weather||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"기온(℃)"}),(0,l.jsx)(t.Z,{type:"number",value:n.temp||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"습도(%)"}),(0,l.jsx)(t.Z,{type:"number",value:n.humidity||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"기압(mmHg)"}),(0,l.jsx)(t.Z,{type:"number",value:n.pressure||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"풍향"}),(0,l.jsx)(t.Z,{value:n.windDir||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"풍속(m/sec)"}),(0,l.jsx)(t.Z,{type:"number",value:n.wind||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"가스속도(m/s)"}),(0,l.jsx)(t.Z,{type:"number",value:n.gasVel||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"가스온도(℃)"}),(0,l.jsx)(t.Z,{type:"number",value:n.gasTemp||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"수분함량(%)"}),(0,l.jsx)(t.Z,{type:"number",value:n.moisture||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"실측산소농도(%)"}),(0,l.jsx)(t.Z,{type:"number",value:n.o2Measured||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"표준산소농도(%)"}),(0,l.jsx)(t.Z,{type:"number",value:n.o2Standard||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"배출가스유량(S㎥/min)"}),(0,l.jsx)(t.Z,{type:"number",value:n.flow||"",disabled:!0})]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"배출가스 기타"}),(0,l.jsx)(t.Z,{value:n.gasNote||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"채취일"}),(0,l.jsx)(t.Z,{type:"date",value:n.samplingDate?new Date(n.samplingDate).toISOString().split("T")[0]:"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"채취시간 시작"}),(0,l.jsx)(t.Z,{type:"time",value:n.samplingStart||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"채취시간 종료"}),(0,l.jsx)(t.Z,{type:"time",value:n.samplingEnd||"",disabled:!0})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"시료채취자1"}),(0,l.jsx)(t.Z,{value:n.sampler||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"시료채취자2"}),(0,l.jsx)(t.Z,{value:n.sampler2||"",disabled:!0})]})]})]}),(0,l.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 md:p-6 space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"측정분석결과"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm border-collapse",children:[(0,l.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border p-2",children:"측정항목"}),(0,l.jsx)("th",{className:"border p-2",children:"허용기준"}),(0,l.jsx)("th",{className:"border p-2",children:"분석값"}),(0,l.jsx)("th",{className:"border p-2",children:"단위"}),(0,l.jsx)("th",{className:"border p-2",children:"측정분석방법"}),(0,l.jsx)("th",{className:"border p-2",children:"측정시간 시작"}),(0,l.jsx)("th",{className:"border p-2",children:"측정시간 종료"}),(0,l.jsx)("th",{className:"border p-2",children:"비고"})]})}),(0,l.jsx)("tbody",{children:u.map((e,s)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2",children:e.item}),(0,l.jsx)("td",{className:"border p-2",children:e.limit}),(0,l.jsx)("td",{className:"border p-2",children:e.value}),(0,l.jsx)("td",{className:"border p-2",children:e.unit}),(0,l.jsx)("td",{className:"border p-2",children:e.method}),(0,l.jsx)("td",{className:"border p-2",children:e.startTime}),(0,l.jsx)("td",{className:"border p-2",children:e.endTime}),(0,l.jsx)("td",{className:"border p-2",children:e.note})]},s))})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"분석기간 시작"}),(0,l.jsx)(t.Z,{type:"date",value:n.analysisStart||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"분석기간 종료"}),(0,l.jsx)(t.Z,{type:"date",value:n.analysisEnd||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"분석기술인"}),(0,l.jsx)(t.Z,{value:n.analyst||"",disabled:!0})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-sm font-medium",children:"책임기술인"}),(0,l.jsx)(t.Z,{value:n.chiefTech||"",disabled:!0})]})]})]}),(0,l.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 md:p-6 space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"종합의견"}),(0,l.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded min-h-[120px]",children:n.opinion||""})]})]})}},6334:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});var l=a(7437);a(2265);let d={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},c={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i(e){let{variant:s="primary",size:a="md",className:i="",...t}=e;return(0,l.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(d[s]," ").concat(c[a]," ").concat(i),...t})}},2827:function(e,s,a){"use strict";a.d(s,{Z:function(){return d}});var l=a(7437);function d(e){let{className:s="",...a}=e;return(0,l.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(s),...a})}a(2265)},6660:function(e,s,a){"use strict";a.d(s,{n:function(){return d}});var l=a(2093);function d(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"대기측정기록부.xlsx",a=[["외뢰인","외뢰인","외뢰인","외뢰인","일반현황","일반현황","일반현황","의뢰내용","의뢰내용","의뢰내용","의뢰내용","의뢰내용","의뢰내용","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","종합의견"],["상호(사업장명)","사업장소재지","대표자(의뢰인)","환경기술인","업종","시설종류","사업장종별","측정용도","굴뚝정보","굴뚝정보","굴뚝정보","굴뚝정보","의뢰항목","현장기상","현장기상","현장기상","현장기상","현장기상","현장기상","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","채취일","채취시간(시작)","채취시간(종료)","시료채취자1","시료채취자2","측정항목","허용기준","분석값","단위","측정분석방법","측정시간(시작)","측정시간(종료)","비고","분석기간(시작)","분석기간(종료)","분석기술인","책임기술인","종합의견"],["","","","","","","","","굴뚝명칭","높이","안지름(측정공)","굴뚝종별","","날씨","기온","습도","기압","풍향","풍속","표준산소농도","실측산소농도","배출가스 유량(산소보정 전)","배출가스 유량(산소보정 후)","수분량","배출가스 온도","배출가스 유속","기타","","","","","","","","","","","","","","","","","",""]];e.forEach(e=>{let s=JSON.parse(e.measurements||"[]"),l=[e.companyName||"",e.address||"",e.representative||"",e.environmentalTech||"",e.industry||"",e.facilityType||"",e.siteCategory||"",e.purpose||"",e.stackName||"",e.stackHeight||"",e.stackDiameter||"",e.stackType||"",e.requestedItems||"",e.weather||"",e.temp||"",e.humidity||"",e.pressure||"",e.windDir||"",e.wind||"",e.o2Standard||"",e.o2Measured||"",e.flow||"",e.flowCorrected||"",e.moisture||"",e.gasTemp||"",e.gasVel||"",e.gasNote||"",e.samplingDate?new Date(e.samplingDate).toLocaleDateString():"",e.samplingStart||"",e.samplingEnd||"",e.sampler||"",e.sampler2||""];0===s.length?a.push([...l,"","","","","","","","",e.analysisStart||"",e.analysisEnd||"",e.analyst||"",e.chiefTech||"",e.opinion||""]):s.forEach(s=>{a.push([...l,s.item||"",s.limit||"",s.value||"",s.unit||"",s.method||"",s.startTime||"",s.endTime||"",s.note||"",e.analysisStart||"",e.analysisEnd||"",e.analyst||"",e.chiefTech||"",e.opinion||""])})});let d=l.P6.aoa_to_sheet(a);d["!cols"]=[{wch:20},{wch:30},{wch:10},{wch:10},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:8},{wch:12},{wch:10},{wch:30},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10},{wch:10},{wch:15},{wch:15},{wch:8},{wch:10},{wch:10},{wch:15},{wch:12},{wch:12},{wch:12},{wch:10},{wch:10},{wch:15},{wch:10},{wch:10},{wch:10},{wch:20},{wch:12},{wch:12},{wch:15},{wch:12},{wch:12},{wch:10},{wch:10},{wch:30}];let c=l.P6.book_new();l.P6.book_append_sheet(c,d,"대기측정기록부"),l.NC(c,s)}}},function(e){e.O(0,[1425,2971,2117,1744],function(){return e(e.s=840)}),_N_E=e.O()}]);