(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5512],{67:function(){},2061:function(){},7328:function(e,t,a){Promise.resolve().then(a.bind(a,8811))},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},8811:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7437),r=a(2265),n=a(2397),c=a(9376),i=a(6334),l=a(6819),d=a(2827),o=a(1515),u=a(6660);function h(){let{user:e}=(0,n.a)(),t=(0,c.useRouter)(),[a,h]=(0,r.useState)("measurement"),[x,m]=(0,r.useState)([]),[g,p]=(0,r.useState)([]),[f,v]=(0,r.useState)(!0),[w,j]=(0,r.useState)({stackId:"",startDate:"",endDate:"",organization:""}),[b,y]=(0,r.useState)([]);(0,r.useEffect)(()=>{k(),N()},[w]);let N=async()=>{try{let e=await fetch("/api/stacks"),t=await e.json();y(t.stacks||[])}catch(e){}},k=async()=>{try{v(!0);let e=new URLSearchParams;w.stackId&&e.append("stackId",w.stackId),w.startDate&&e.append("startDate",w.startDate),w.endDate&&e.append("endDate",w.endDate);let t=await fetch("/api/customer/reports?".concat(e.toString())),a=(await t.json()).data||[];w.organization&&(a=a.filter(e=>{var t,a,s;return null===(s=e.createdByUser)||void 0===s?void 0:null===(a=s.organization)||void 0===a?void 0:null===(t=a.name)||void 0===t?void 0:t.includes(w.organization)})),m(a)}catch(e){}finally{v(!1)}},D=e=>"SHARED"===e?(0,s.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"공유됨"}):e;return(0,s.jsxs)("div",{className:"p-4 md:p-6 max-w-7xl mx-auto space-y-6",children:[(0,s.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold whitespace-nowrap mb-1.5",children:"받은 보고서"}),(0,s.jsx)("span",{className:"text-gray-300 dark:text-gray-600 mb-1.5",children:"|"}),(0,s.jsxs)("div",{className:"flex flex-col",style:{width:"176px",minWidth:"176px"},children:[(0,s.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"굴뚝"}),(0,s.jsxs)(l.Z,{className:"text-sm h-8 w-full",value:w.stackId,onChange:e=>j({...w,stackId:e.target.value}),children:[(0,s.jsx)("option",{value:"",children:"전체"}),b.map(e=>(0,s.jsx)("option",{value:e.id,children:e.fullName||e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"시작일"}),(0,s.jsx)(d.Z,{className:"text-sm h-8",style:{width:"144px",minWidth:"144px"},type:"date",value:w.startDate,onChange:e=>j({...w,startDate:e.target.value})})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mb-1.5",children:"~"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"종료일"}),(0,s.jsx)(d.Z,{className:"text-sm h-8",style:{width:"144px",minWidth:"144px"},type:"date",value:w.endDate,onChange:e=>j({...w,endDate:e.target.value})})]}),(0,s.jsx)("div",{className:"flex flex-col",style:{width:"176px",minWidth:"176px"},children:(0,s.jsx)(d.Z,{className:"text-sm h-8 w-full",type:"text",value:w.organization,onChange:e=>j({...w,organization:e.target.value}),placeholder:"환경측정기업 검색"})}),(0,s.jsx)("div",{className:"flex gap-1.5 mb-1.5 ml-auto",children:(0,s.jsx)(i.Z,{size:"sm",onClick:()=>(0,u.n)(x),children:"\uD83D\uDCCA 엑셀"})})]})}),(0,s.jsx)("div",{className:"hidden md:block rounded-lg border overflow-x-auto",children:(0,s.jsx)("div",{className:"overflow-y-auto max-h-[calc(100vh-220px)]",children:f?(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"로딩 중..."}):0===x.length?(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"받은 보고서가 없습니다."}):(0,s.jsxs)(o.iA,{children:[(0,s.jsx)(o.hr,{className:"bg-gray-50 dark:bg-white/10 sticky top-0 z-10",children:(0,s.jsxs)(o.Tr,{children:[(0,s.jsx)(o.Th,{children:"버전"}),(0,s.jsx)(o.Th,{children:"굴뚝명"}),(0,s.jsx)(o.Th,{children:"측정일자"}),(0,s.jsx)(o.Th,{children:"상태"}),(0,s.jsx)(o.Th,{children:"공유일"}),(0,s.jsx)(o.Th,{children:"환경측정기업"}),(0,s.jsx)(o.Th,{children:"액션"})]})}),(0,s.jsx)(o.p3,{children:x.map(e=>{var a,r,n,c;return(0,s.jsxs)(o.Tr,{children:[(0,s.jsxs)(o.Td,{children:["v",e.version]}),(0,s.jsx)(o.Td,{children:(null===(a=e.stack)||void 0===a?void 0:a.fullName)||(null===(r=e.stack)||void 0===r?void 0:r.name)||"-"}),(0,s.jsx)(o.Td,{children:new Date(e.measuredAt).toLocaleDateString()}),(0,s.jsx)(o.Td,{children:D(e.status)}),(0,s.jsx)(o.Td,{children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)(o.Td,{children:(null===(c=e.createdByUser)||void 0===c?void 0:null===(n=c.organization)||void 0===n?void 0:n.name)||"-"}),(0,s.jsx)(o.Td,{children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>t.push("/customer/reports/".concat(e.id)),className:"text-xs text-blue-600 hover:underline",children:"조회"}),(0,s.jsx)("button",{onClick:()=>window.open("/reports/".concat(e.id,"/pdf"),"_blank"),className:"text-xs text-purple-600 hover:underline",children:"PDF"})]})})]},e.id)})})]})})}),(0,s.jsx)("div",{className:"md:hidden space-y-4",children:f?(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"로딩 중..."}):0===x.length?(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"받은 보고서가 없습니다."}):x.map(e=>{var a,r,n,c;return(0,s.jsxs)("div",{className:"rounded-lg border bg-white dark:bg-gray-800 p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-semibold",children:["v",e.version," - ",(null===(a=e.stack)||void 0===a?void 0:a.fullName)||(null===(r=e.stack)||void 0===r?void 0:r.name)||"-"]}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.measuredAt).toLocaleDateString()})]}),D(e.status)]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[(0,s.jsxs)("div",{children:["공유일: ",new Date(e.createdAt).toLocaleDateString()]}),(0,s.jsxs)("div",{children:["환경측정기업: ",(null===(c=e.createdByUser)||void 0===c?void 0:null===(n=c.organization)||void 0===n?void 0:n.name)||"-"]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>t.push("/customer/reports/".concat(e.id)),className:"text-sm text-blue-600 hover:underline",children:"조회"}),(0,s.jsx)("button",{onClick:()=>window.open("/reports/".concat(e.id,"/pdf"),"_blank"),className:"text-sm text-purple-600 hover:underline",children:"PDF"})]})]},e.id)})})]})}},6334:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(7437);a(2265);let r={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},n={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function c(e){let{variant:t="primary",size:a="md",className:c="",...i}=e;return(0,s.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(r[t]," ").concat(n[a]," ").concat(c),...i})}},2827:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437);function r(e){let{className:t="",...a}=e;return(0,s.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...a})}a(2265)},6819:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437);function r(e){let{className:t="",children:a,...r}=e;return(0,s.jsx)("select",{className:"".concat("w-full rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...r,children:a})}a(2265)},1515:function(e,t,a){"use strict";a.d(t,{Td:function(){return d},Th:function(){return l},Tr:function(){return i},hr:function(){return n},iA:function(){return r},p3:function(){return c}});var s=a(7437);function r(e){let{className:t="",...a}=e;return(0,s.jsx)("table",{className:"w-full text-sm border-collapse ".concat(t),...a})}function n(e){return(0,s.jsx)("thead",{...e})}function c(e){return(0,s.jsx)("tbody",{...e})}function i(e){return(0,s.jsx)("tr",{className:"border-b last:border-0 border-gray-200 dark:border-white/10",...e})}function l(e){let{className:t="",...a}=e;return(0,s.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-600 dark:text-gray-300 ".concat(t),...a})}function d(e){let{className:t="",...a}=e;return(0,s.jsx)("td",{className:"py-2 px-3 ".concat(t),...a})}a(2265)},2397:function(e,t,a){"use strict";a.d(t,{H:function(){return d},a:function(){return o}});var s=a(7437),r=a(2265),n=a(605),c=a(9376);function i(){return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900",children:[(0,s.jsxs)("div",{className:"mb-16",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-white text-center",children:"오염물질 측정 관리 시스템"}),(0,s.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Pollutant Measurement Management System"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-gray-200 dark:border-gray-700 border-t-blue-600 rounded-full animate-spin"})}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"로딩 중..."})]}),(0,s.jsx)("div",{className:"mt-16"})]})}let l=(0,r.createContext)(null);function d(e){let{children:t}=e,{data:a,status:d}=(0,n.useSession)(),[o,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(!0),m=(0,c.usePathname)();(0,r.useEffect)(()=>{"loading"!==d&&x(!1),(null==a?void 0:a.user)?u(a.user):"unauthenticated"===d&&u(null)},[a,d]);let g="loading"===d||h;return!g||"/login"===m||(null==m?void 0:m.startsWith("/register"))||(null==m?void 0:m.startsWith("/invite"))||(null==m?void 0:m.startsWith("/auth"))?(0,s.jsx)(l.Provider,{value:{user:o,loading:g},children:t}):(0,s.jsx)(i,{})}function o(){let e=(0,r.useContext)(l);if(!e)throw Error("AuthProvider is missing");return e}},6660:function(e,t,a){"use strict";a.d(t,{n:function(){return r}});var s=a(2093);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"대기측정기록부.xlsx",a=[["외뢰인","외뢰인","외뢰인","외뢰인","일반현황","일반현황","일반현황","의뢰내용","의뢰내용","의뢰내용","의뢰내용","의뢰내용","의뢰내용","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","종합의견"],["상호(사업장명)","사업장소재지","대표자(의뢰인)","환경기술인","업종","시설종류","사업장종별","측정용도","굴뚝정보","굴뚝정보","굴뚝정보","굴뚝정보","의뢰항목","현장기상","현장기상","현장기상","현장기상","현장기상","현장기상","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","채취일","채취시간(시작)","채취시간(종료)","시료채취자1","시료채취자2","측정항목","허용기준","분석값","단위","측정분석방법","측정시간(시작)","측정시간(종료)","비고","분석기간(시작)","분석기간(종료)","분석기술인","책임기술인","종합의견"],["","","","","","","","","굴뚝명칭","높이","안지름(측정공)","굴뚝종별","","날씨","기온","습도","기압","풍향","풍속","표준산소농도","실측산소농도","배출가스 유량(산소보정 전)","배출가스 유량(산소보정 후)","수분량","배출가스 온도","배출가스 유속","기타","","","","","","","","","","","","","","","","","",""]];e.forEach(e=>{let t=JSON.parse(e.measurements||"[]"),s=[e.companyName||"",e.address||"",e.representative||"",e.environmentalTech||"",e.industry||"",e.facilityType||"",e.siteCategory||"",e.purpose||"",e.stackName||"",e.stackHeight||"",e.stackDiameter||"",e.stackType||"",e.requestedItems||"",e.weather||"",e.temp||"",e.humidity||"",e.pressure||"",e.windDir||"",e.wind||"",e.o2Standard||"",e.o2Measured||"",e.flow||"",e.flowCorrected||"",e.moisture||"",e.gasTemp||"",e.gasVel||"",e.gasNote||"",e.samplingDate?new Date(e.samplingDate).toLocaleDateString():"",e.samplingStart||"",e.samplingEnd||"",e.sampler||"",e.sampler2||""];0===t.length?a.push([...s,"","","","","","","","",e.analysisStart||"",e.analysisEnd||"",e.analyst||"",e.chiefTech||"",e.opinion||""]):t.forEach(t=>{a.push([...s,t.item||"",t.limit||"",t.value||"",t.unit||"",t.method||"",t.startTime||"",t.endTime||"",t.note||"",e.analysisStart||"",e.analysisEnd||"",e.analyst||"",e.chiefTech||"",e.opinion||""])})});let r=s.P6.aoa_to_sheet(a);r["!cols"]=[{wch:20},{wch:30},{wch:10},{wch:10},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:8},{wch:12},{wch:10},{wch:30},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10},{wch:10},{wch:15},{wch:15},{wch:8},{wch:10},{wch:10},{wch:15},{wch:12},{wch:12},{wch:12},{wch:10},{wch:10},{wch:15},{wch:10},{wch:10},{wch:10},{wch:20},{wch:12},{wch:12},{wch:15},{wch:12},{wch:12},{wch:10},{wch:10},{wch:30}];let n=s.P6.book_new();s.P6.book_append_sheet(n,r,"대기측정기록부"),s.NC(n,t)}}},function(e){e.O(0,[1425,605,2971,2117,1744],function(){return e(e.s=7328)}),_N_E=e.O()}]);