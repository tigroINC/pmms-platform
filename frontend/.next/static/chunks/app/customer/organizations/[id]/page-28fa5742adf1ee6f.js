(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7],{4902:function(e,t,s){Promise.resolve().then(s.bind(s,1181))},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},1181:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),n=s(2265),l=s(9376),r=s(605);function i(){let e=(0,l.useParams)(),t=(0,l.useRouter)(),{data:s}=(0,r.useSession)(),i=e.id,[c,d]=(0,n.useState)(null),[m,x]=(0,n.useState)(null),[o,h]=(0,n.useState)([]),[u,g]=(0,n.useState)(!0),[b,j]=(0,n.useState)("");(0,n.useEffect)(()=>{i&&N()},[i]);let N=async()=>{try{var e;g(!0);let t=null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.customerId,a=await fetch("/api/organizations/".concat(i)),n=await a.json();if(a.ok){d(n.organization);let e=await fetch("/api/connections/by-customer?customerId=".concat(t)),s=await e.json();if(e.ok&&s.connections){let e=s.connections.find(e=>e.organization.id===i);if(e&&e.contractStartDate&&e.contractEndDate){let t=new Date,s=new Date(e.contractEndDate).getTime()-t.getTime();x({startDate:e.contractStartDate,endDate:e.contractEndDate,daysRemaining:Math.ceil(s/864e5)})}let t=await fetch("/api/organizations/".concat(i,"/managers")),a=await t.json();t.ok&&h(a.managers||[])}}else j(n.error||"환경측정기업 정보를 불러올 수 없습니다.")}catch(e){j("환경측정기업 정보 조회 중 오류가 발생했습니다.")}finally{g(!1)}};return u?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-gray-500",children:"로딩 중..."})}):b||!c?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-red-800",children:b||"환경측정기업을 찾을 수 없습니다."})}),(0,a.jsx)("button",{onClick:()=>t.back(),className:"mt-4 text-blue-600 hover:text-blue-800",children:"← 돌아가기"})]}):(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("button",{onClick:()=>t.back(),className:"text-blue-600 hover:text-blue-800 mb-4 flex items-center gap-1",children:"← 돌아가기"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:c.name}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"환경측정기업 상세 정보"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"기본 정보"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"기업명"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"사업자등록번호"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.businessNumber})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"대표자"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.representative||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"설립일"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.establishedDate?new Date(c.establishedDate).toLocaleDateString():"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"등록일"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:new Date(c.createdAt).toLocaleDateString()})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"계약 정보"}),m?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"계약 시작일"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:new Date(m.startDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"계약 종료일"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:new Date(m.endDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"잔여 계약일"}),(0,a.jsx)("p",{className:"mt-1 font-semibold ".concat(m.daysRemaining<0?"text-red-600":m.daysRemaining<=7?"text-red-500":m.daysRemaining<=28?"text-yellow-600":"text-green-600"),children:m.daysRemaining<0?"만료됨 (".concat(Math.abs(m.daysRemaining),"일 경과)"):"".concat(m.daysRemaining,"일")})]})]}):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"계약 정보가 없습니다. 환경측정기업에 문의하세요."})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"연락처 정보"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"전화번호"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.phone||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"이메일"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.email||"-"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"주소"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.address||"-"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"웹사이트"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:c.website?(0,a.jsx)("a",{href:c.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:c.website}):"-"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"관리자 목록"}),o.length>0?(0,a.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.email})]}),e.phone&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.phone})]},e.id))}):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"등록된 관리자가 없습니다."})]})]})}}},function(e){e.O(0,[605,2971,2117,1744],function(){return e(e.s=4902)}),_N_E=e.O()}]);