(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{67:function(){},2061:function(){},95:function(e,t,r){Promise.resolve().then(r.bind(r,6725))},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},6725:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var a=r(7437),n=r(2265),s=r(2397),i=r(6334),l=r(2827),c=r(6819),d=r(1515),o=r(6660),u=r(4755),h=r(9548);function x(){let{user:e}=(0,s.a)(),t=null==e?void 0:e.role,[r,x]=(0,n.useState)("measurement"),[m,g]=(0,n.useState)([]),[f,p]=(0,n.useState)([]),[v,j]=(0,n.useState)(!1),[b,w]=(0,n.useState)("전체"),[y,N]=(0,n.useState)("전체"),[k,S]=(0,n.useState)("전체"),[D,R]=(0,n.useState)(""),[T,A]=(0,n.useState)(""),{list:I}=(0,u.n)(),E=(0,n.useMemo)(()=>{var e;return"전체"===b?void 0:null===(e=I.find(e=>e.name===b))||void 0===e?void 0:e.id},[b,I]),{list:C}=(0,h.D)(E),P=async()=>{j(!0);try{let t=new URLSearchParams;if(E&&t.append("customerId",E),"전체"!==y){var e;let r=null===(e=C.find(e=>e.name===y))||void 0===e?void 0:e.id;r&&t.append("stackId",r)}"전체"!==k&&t.append("status",k),D&&t.append("startDate",D),T&&t.append("endDate",T);let r=await fetch("/api/reports?".concat(t.toString())),a=await r.json();r.ok?g(a.data||[]):g([])}catch(e){g([])}finally{j(!1)}};(0,n.useEffect)(()=>{"measurement"===r?P():_()},[r,E,y,k,D,T]);let _=async()=>{try{j(!0);let e=new URLSearchParams;E&&e.append("customerId",E);let t=await fetch("/api/insight-reports?".concat(e.toString())),r=await t.json();p(r.data||[])}catch(e){}finally{j(!1)}},O=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{let t=await fetch("/api/reports/".concat(e),{method:"DELETE"});if(t.ok)alert("삭제되었습니다."),P();else{let e=await t.json();alert(e.error||"삭제 실패")}}catch(e){alert(e.message||"삭제 중 오류가 발생했습니다.")}},M=async e=>{if(confirm("이 보고서를 고객사와 공유하시겠습니까?"))try{let t=await fetch("/api/reports/".concat(e,"/share"),{method:"POST"});if(t.ok)alert("고객사와 공유되었습니다."),P();else{let e=await t.json();alert(e.error||"공유 실패")}}catch(e){alert(e.message||"공유 중 오류가 발생했습니다.")}},U=e=>{switch(e){case"DRAFT":return(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:"작성중"});case"CONFIRMED":return(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:"확정"});case"SHARED":return(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"공유됨"});default:return e}};return(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"보고서 관리"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t||"ORG_USER"===t)&&"measurement"===r&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.Z,{variant:"secondary",onClick:()=>(0,o.n)(m),children:"\uD83D\uDCCA 엑셀 내보내기"}),(0,a.jsx)(i.Z,{onClick:()=>window.location.href="/reports/new",children:"\uD83D\uDCDD 신규 작성"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("button",{onClick:()=>x("measurement"),className:"px-4 py-2 font-medium transition-colors ".concat("measurement"===r?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:"대기측정기록부"}),(0,a.jsx)("button",{onClick:()=>x("insight"),className:"px-4 py-2 font-medium transition-colors ".concat("insight"===r?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:"인사이트 보고서"})]}),(0,a.jsx)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-3",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-col",style:{width:"176px",minWidth:"176px"},children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"고객사"}),(0,a.jsx)(c.Z,{className:"text-sm h-8 w-full",value:b,onChange:e=>{w(e.target.value),N("전체")},children:["전체",...I.map(e=>e.name)].map(e=>(0,a.jsx)("option",{children:e},e))})]}),(0,a.jsxs)("div",{className:"flex flex-col",style:{width:"176px",minWidth:"176px"},children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"굴뚝명"}),(0,a.jsx)(c.Z,{className:"text-sm h-8 w-full",value:y,onChange:e=>N(e.target.value),children:["전체",...E?C.map(e=>e.name):[]].map(e=>(0,a.jsx)("option",{children:e},e))})]}),(0,a.jsxs)("div",{className:"flex flex-col",style:{width:"120px",minWidth:"120px"},children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"상태"}),(0,a.jsxs)(c.Z,{className:"text-sm h-8 w-full",value:k,onChange:e=>S(e.target.value),children:[(0,a.jsx)("option",{children:"전체"}),(0,a.jsx)("option",{value:"DRAFT",children:"작성중"}),(0,a.jsx)("option",{value:"CONFIRMED",children:"확정"}),(0,a.jsx)("option",{value:"SHARED",children:"공유됨"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"시작일"}),(0,a.jsx)(l.Z,{className:"text-sm h-8",style:{width:"144px",minWidth:"144px"},type:"date",value:D,onChange:e=>R(e.target.value)})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mb-1.5",children:"~"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"종료일"}),(0,a.jsx)(l.Z,{className:"text-sm h-8",style:{width:"144px",minWidth:"144px"},type:"date",value:T,onChange:e=>A(e.target.value)})]}),(0,a.jsx)("div",{className:"flex gap-1.5 ml-auto mb-1.5",children:(0,a.jsx)(i.Z,{size:"sm",variant:"secondary",onClick:()=>{w("전체"),N("전체"),S("전체"),R(""),A("")},children:"초기화"})})]})}),(0,a.jsx)("div",{className:"hidden md:block rounded-lg border overflow-x-auto",children:v?(0,a.jsx)("div",{className:"p-6 text-center text-gray-500",children:"로딩 중..."}):"measurement"===r&&0===m.length?(0,a.jsx)("div",{className:"p-6 text-center text-gray-500",children:"보고서가 없습니다."}):"insight"===r&&0===f.length?(0,a.jsx)("div",{className:"p-6 text-center text-gray-500",children:"인사이트 보고서가 없습니다."}):"measurement"===r?(0,a.jsxs)(d.iA,{className:"min-w-[1000px]",children:[(0,a.jsx)(d.hr,{className:"bg-gray-50 dark:bg-white/10",children:(0,a.jsxs)(d.Tr,{children:[(0,a.jsx)(d.Th,{children:"버전"}),(0,a.jsx)(d.Th,{children:"고객사"}),(0,a.jsx)(d.Th,{children:"굴뚝명"}),(0,a.jsx)(d.Th,{children:"측정일자"}),(0,a.jsx)(d.Th,{children:"상태"}),(0,a.jsx)(d.Th,{children:"작성일"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t||"ORG_USER"===t)&&(0,a.jsx)(d.Th,{children:"액션"})]})}),(0,a.jsx)(d.p3,{children:m.map(e=>(0,a.jsxs)(d.Tr,{children:[(0,a.jsxs)(d.Td,{children:["v",e.version]}),(0,a.jsx)(d.Td,{children:e.customer.fullName||e.customer.name}),(0,a.jsx)(d.Td,{children:e.stack.fullName||e.stack.name}),(0,a.jsx)(d.Td,{children:new Date(e.measuredAt).toLocaleDateString()}),(0,a.jsx)(d.Td,{children:U(e.status)}),(0,a.jsx)(d.Td,{children:new Date(e.createdAt).toLocaleDateString()}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t||"ORG_USER"===t)&&(0,a.jsx)(d.Td,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/reports/".concat(e.id),className:"text-xs text-blue-600 hover:underline",children:"DRAFT"===e.status?"수정":"조회"}),(0,a.jsx)("button",{onClick:()=>window.open("/reports/".concat(e.id,"/pdf"),"_blank"),className:"text-xs text-purple-600 hover:underline",children:"PDF"}),"CONFIRMED"===e.status&&("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)("button",{onClick:()=>M(e.id),className:"text-xs text-green-600 hover:underline",children:"고객공유"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)("button",{onClick:()=>O(e.id),className:"text-xs text-red-600 hover:underline",children:"삭제"})]})})]},e.id))})]}):(0,a.jsxs)(d.iA,{className:"min-w-[1000px]",children:[(0,a.jsx)(d.hr,{className:"bg-gray-50 dark:bg-white/10",children:(0,a.jsxs)(d.Tr,{children:[(0,a.jsx)(d.Th,{children:"고객사"}),(0,a.jsx)(d.Th,{children:"항목"}),(0,a.jsx)(d.Th,{children:"예측기간"}),(0,a.jsx)(d.Th,{children:"생성일"}),(0,a.jsx)(d.Th,{children:"공유상태"}),(0,a.jsx)(d.Th,{children:"액션"})]})}),(0,a.jsx)(d.p3,{children:f.map(e=>(0,a.jsxs)(d.Tr,{children:[(0,a.jsx)(d.Td,{children:e.customer.name}),(0,a.jsx)(d.Td,{children:e.itemName}),(0,a.jsxs)(d.Td,{children:[e.periods,"일"]}),(0,a.jsx)(d.Td,{children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)(d.Td,{children:e.sharedAt?(0,a.jsxs)("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:["공유됨 (",new Date(e.sharedAt).toLocaleDateString(),")"]}):(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:"미공유"})}),(0,a.jsx)(d.Td,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{let t=atob(e.pdfBase64),r=Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let a=new Blob([new Uint8Array(r)],{type:"application/pdf"}),n=URL.createObjectURL(a);window.open(n,"_blank")},className:"text-xs text-purple-600 hover:underline",children:"PDF 보기"}),!e.sharedAt&&("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)("button",{onClick:async()=>{if(confirm("이 인사이트 보고서를 고객사와 공유하시겠습니까?"))try{(await fetch("/api/insight-reports/".concat(e.id,"/share"),{method:"POST"})).ok?(alert("고객사와 공유되었습니다."),_()):alert("공유 실패")}catch(e){alert("공유 중 오류가 발생했습니다.")}},className:"text-xs text-green-600 hover:underline",children:"고객공유"})]})})]},e.id))})]})}),(0,a.jsx)("div",{className:"md:hidden space-y-4",children:v?(0,a.jsx)("div",{className:"p-6 text-center text-gray-500",children:"로딩 중..."}):0===m.length?(0,a.jsx)("div",{className:"p-6 text-center text-gray-500",children:"보고서가 없습니다."}):m.map(e=>(0,a.jsxs)("div",{className:"rounded-lg border bg-white dark:bg-gray-800 p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold",children:["v",e.version," - ",e.customer.fullName||e.customer.name]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.stack.fullName||e.stack.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.measuredAt).toLocaleDateString()})]}),U(e.status)]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["작성일: ",new Date(e.createdAt).toLocaleDateString()]}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t||"ORG_USER"===t)&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsx)("button",{onClick:()=>window.location.href="/reports/".concat(e.id),className:"text-sm text-blue-600 hover:underline",children:"DRAFT"===e.status?"수정":"조회"}),(0,a.jsx)("button",{onClick:()=>window.open("/reports/".concat(e.id,"/pdf"),"_blank"),className:"text-sm text-purple-600 hover:underline",children:"PDF"}),"CONFIRMED"===e.status&&("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)("button",{onClick:()=>M(e.id),className:"text-sm text-green-600 hover:underline",children:"고객공유"}),("SUPER_ADMIN"===t||"ORG_ADMIN"===t)&&(0,a.jsx)("button",{onClick:()=>O(e.id),className:"text-sm text-red-600 hover:underline",children:"삭제"})]})]},e.id))})]})}},6334:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(7437);r(2265);let n={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},s={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i(e){let{variant:t="primary",size:r="md",className:i="",...l}=e;return(0,a.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(n[t]," ").concat(s[r]," ").concat(i),...l})}},2827:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(7437);function n(e){let{className:t="",...r}=e;return(0,a.jsx)("input",{className:"".concat("rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...r})}r(2265)},6819:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(7437);function n(e){let{className:t="",children:r,...n}=e;return(0,a.jsx)("select",{className:"".concat("w-full rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20"," ").concat(t),...n,children:r})}r(2265)},1515:function(e,t,r){"use strict";r.d(t,{Td:function(){return d},Th:function(){return c},Tr:function(){return l},hr:function(){return s},iA:function(){return n},p3:function(){return i}});var a=r(7437);function n(e){let{className:t="",...r}=e;return(0,a.jsx)("table",{className:"w-full text-sm border-collapse ".concat(t),...r})}function s(e){return(0,a.jsx)("thead",{...e})}function i(e){return(0,a.jsx)("tbody",{...e})}function l(e){return(0,a.jsx)("tr",{className:"border-b last:border-0 border-gray-200 dark:border-white/10",...e})}function c(e){let{className:t="",...r}=e;return(0,a.jsx)("th",{className:"text-left py-2 px-3 font-medium text-gray-600 dark:text-gray-300 ".concat(t),...r})}function d(e){let{className:t="",...r}=e;return(0,a.jsx)("td",{className:"py-2 px-3 ".concat(t),...r})}r(2265)},2397:function(e,t,r){"use strict";r.d(t,{H:function(){return d},a:function(){return o}});var a=r(7437),n=r(2265),s=r(605),i=r(9376);function l(){return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"mb-16",children:[(0,a.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-white text-center",children:"오염물질 측정 관리 시스템"}),(0,a.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Pollutant Measurement Management System"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-gray-200 dark:border-gray-700 border-t-blue-600 rounded-full animate-spin"})}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-medium",children:"로딩 중..."})]}),(0,a.jsx)("div",{className:"mt-16"})]})}let c=(0,n.createContext)(null);function d(e){let{children:t}=e,{data:r,status:d}=(0,s.useSession)(),[o,u]=(0,n.useState)(null),[h,x]=(0,n.useState)(!0),m=(0,i.usePathname)();(0,n.useEffect)(()=>{"loading"!==d&&x(!1),(null==r?void 0:r.user)?u(r.user):"unauthenticated"===d&&u(null)},[r,d]);let g="loading"===d||h;return!g||"/login"===m||(null==m?void 0:m.startsWith("/register"))||(null==m?void 0:m.startsWith("/invite"))||(null==m?void 0:m.startsWith("/auth"))?(0,a.jsx)(c.Provider,{value:{user:o,loading:g},children:t}):(0,a.jsx)(l,{})}function o(){let e=(0,n.useContext)(c);if(!e)throw Error("AuthProvider is missing");return e}},2891:function(e,t,r){"use strict";r.d(t,{OrganizationProvider:function(){return l},o:function(){return c}});var a=r(7437),n=r(2265),s=r(605);let i=(0,n.createContext)(void 0);function l(e){var t,r,l;let{children:c}=e,{data:d,status:o}=(0,s.useSession)(),[u,h]=(0,n.useState)(null),[x,m]=(0,n.useState)([]),[g,f]=(0,n.useState)(!0),p=(null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.role)==="SUPER_ADMIN",v=null==d?void 0:null===(r=d.user)||void 0===r?void 0:r.role,j=null==d?void 0:null===(l=d.user)||void 0===l?void 0:l.organizationId,b="CUSTOMER_ADMIN"===v||"CUSTOMER_USER"===v;(0,n.useEffect)(()=>{if("loading"!==o){if(!d||b){f(!1);return}p&&sessionStorage.getItem("viewAsOrganization"),p?w():j?y(j):f(!1)}},[d,o,p,j,b]),(0,n.useEffect)(()=>{if(!p)return;let e=sessionStorage.getItem("viewAsOrganization");e&&(null==u?void 0:u.id)!==e&&w();let t=setInterval(()=>{let e=sessionStorage.getItem("viewAsOrganization");if(e&&(null==u?void 0:u.id)!==e)w();else if(!e&&u){let e=localStorage.getItem("selectedOrgId");e&&u.id!==e&&w()}},500);return()=>clearInterval(t)},[p,u]);let w=async()=>{try{let e=await fetch("/api/organizations?status=APPROVED"),t=await e.json();if(e.ok){let e=t.organizations||[];m(e);let r=sessionStorage.getItem("viewAsOrganization");if(r){let t=e.find(e=>e.id===r);if(t){h(t);return}}let a=localStorage.getItem("selectedOrgId");if(a){let t=e.find(e=>e.id===a);t?h(t):e.length>0&&h(e[0])}else e.length>0&&h(e[0])}}catch(e){}finally{f(!1)}},y=async e=>{try{let t=await fetch("/api/organizations/".concat(e)),r=await t.json();if(t.ok){let e=r.organization;m([e]),h(e)}}catch(e){}finally{f(!1)}};return(0,a.jsx)(i.Provider,{value:{selectedOrg:u,setSelectedOrg:e=>{h(e),e?localStorage.setItem("selectedOrgId",e.id):localStorage.removeItem("selectedOrgId")},organizations:x,loading:g,isSuperAdmin:p},children:c})}function c(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useOrganization must be used within OrganizationProvider");return e}},4755:function(e,t,r){"use strict";r.d(t,{n:function(){return i}});var a=r(2265),n=r(2891),s=r(605);function i(){var e,t;let[r,i]=(0,a.useState)([]),{selectedOrg:l}=(0,n.o)(),{data:c}=(0,s.useSession)(),d=null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.role,o=null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.customerId,u="CUSTOMER_ADMIN"===d||"CUSTOMER_USER"===d,h=(0,a.useCallback)(()=>{if(u&&o){fetch("/api/customers/".concat(o)).then(e=>e.json()).then(e=>{let t=e.customer||e.data;i(t?[t]:[])}).catch(e=>{i([])});return}if(!(null==l?void 0:l.id)){i([]);return}let e=new URLSearchParams;e.append("organizationId",l.id),e.append("tab","all"),fetch("/api/customers?".concat(e.toString())).then(e=>e.json()).then(e=>{i(e.customers||e.data||[])}).catch(e=>{i([])})},[l,u,o]);return(0,a.useEffect)(()=>{h()},[h]),{list:r,refetch:h}}},9548:function(e,t,r){"use strict";r.d(t,{D:function(){return s}});var a=r(2265),n=r(2891);function s(e){let[t,r]=(0,a.useState)([]),{selectedOrg:s}=(0,n.o)();return(0,a.useEffect)(()=>{let t=!0;if(!(null==s?void 0:s.id)){r([]);return}let a=new URLSearchParams;return e&&a.set("customerId",e),a.set("organizationId",s.id),fetch("/api/stacks?".concat(a.toString())).then(e=>e.json()).then(e=>{let a=(e.stacks||e.data||[]).filter(e=>!1!==e.isActive);t&&r(a)}).catch(e=>{t&&r([])}),()=>{t=!1}},[e,s]),{list:t}}},6660:function(e,t,r){"use strict";r.d(t,{n:function(){return n}});var a=r(2093);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"대기측정기록부.xlsx",r=[["외뢰인","외뢰인","외뢰인","외뢰인","일반현황","일반현황","일반현황","의뢰내용","의뢰내용","의뢰내용","의뢰내용","의뢰내용","의뢰내용","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","시료채취","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","측정분석결과","종합의견"],["상호(사업장명)","사업장소재지","대표자(의뢰인)","환경기술인","업종","시설종류","사업장종별","측정용도","굴뚝정보","굴뚝정보","굴뚝정보","굴뚝정보","의뢰항목","현장기상","현장기상","현장기상","현장기상","현장기상","현장기상","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","배출가스","채취일","채취시간(시작)","채취시간(종료)","시료채취자1","시료채취자2","측정항목","허용기준","분석값","단위","측정분석방법","측정시간(시작)","측정시간(종료)","비고","분석기간(시작)","분석기간(종료)","분석기술인","책임기술인","종합의견"],["","","","","","","","","굴뚝명칭","높이","안지름(측정공)","굴뚝종별","","날씨","기온","습도","기압","풍향","풍속","표준산소농도","실측산소농도","배출가스 유량(산소보정 전)","배출가스 유량(산소보정 후)","수분량","배출가스 온도","배출가스 유속","기타","","","","","","","","","","","","","","","","","",""]];e.forEach(e=>{let t=JSON.parse(e.measurements||"[]"),a=[e.companyName||"",e.address||"",e.representative||"",e.environmentalTech||"",e.industry||"",e.facilityType||"",e.siteCategory||"",e.purpose||"",e.stackName||"",e.stackHeight||"",e.stackDiameter||"",e.stackType||"",e.requestedItems||"",e.weather||"",e.temp||"",e.humidity||"",e.pressure||"",e.windDir||"",e.wind||"",e.o2Standard||"",e.o2Measured||"",e.flow||"",e.flowCorrected||"",e.moisture||"",e.gasTemp||"",e.gasVel||"",e.gasNote||"",e.samplingDate?new Date(e.samplingDate).toLocaleDateString():"",e.samplingStart||"",e.samplingEnd||"",e.sampler||"",e.sampler2||""];0===t.length?r.push([...a,"","","","","","","","",e.analysisStart||"",e.analysisEnd||"",e.analyst||"",e.chiefTech||"",e.opinion||""]):t.forEach(t=>{r.push([...a,t.item||"",t.limit||"",t.value||"",t.unit||"",t.method||"",t.startTime||"",t.endTime||"",t.note||"",e.analysisStart||"",e.analysisEnd||"",e.analyst||"",e.chiefTech||"",e.opinion||""])})});let n=a.P6.aoa_to_sheet(r);n["!cols"]=[{wch:20},{wch:30},{wch:10},{wch:10},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:8},{wch:12},{wch:10},{wch:30},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10},{wch:10},{wch:15},{wch:15},{wch:8},{wch:10},{wch:10},{wch:15},{wch:12},{wch:12},{wch:12},{wch:10},{wch:10},{wch:15},{wch:10},{wch:10},{wch:10},{wch:20},{wch:12},{wch:12},{wch:15},{wch:12},{wch:12},{wch:10},{wch:10},{wch:30}];let s=a.P6.book_new();a.P6.book_append_sheet(s,n,"대기측정기록부"),a.NC(s,t)}}},function(e){e.O(0,[1425,605,2971,2117,1744],function(){return e(e.s=95)}),_N_E=e.O()}]);