(()=>{var e={};e.id=722,e.ids=[722],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},44983:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>g,tree:()=>o}),r(99246),r(92553),r(35866);var a=r(23191),s=r(88716),d=r(37922),i=r.n(d),n=r(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let o=["",{children:["org",{children:["staff",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,99246)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\org\\staff\\[id]\\page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\User\\boaz\\frontend\\src\\app\\org\\staff\\[id]\\page.tsx"],x="/org/staff/[id]/page",m={require:r,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/org/staff/[id]/page",pathname:"/org/staff/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},82757:(e,t,r)=>{Promise.resolve().then(r.bind(r,55008))},55008:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(10326),s=r(17577),d=r(77109),i=r(35047),n=r(90434),l=r(99837),o=r(89175);function c({isOpen:e,staffId:t,currentAssignments:r,onClose:d,onSuccess:i}){let[n,c]=(0,s.useState)([]),[x,m]=(0,s.useState)(new Set),[g,h]=(0,s.useState)(null),[u,b]=(0,s.useState)(""),[p,y]=(0,s.useState)(!1),f=e=>{let t=new Set(x);t.has(e)?(t.delete(e),g===e&&h(null)):t.add(e),m(t)},j=e=>{x.has(e)&&h(e)},v=async()=>{try{y(!0);let e=await fetch(`/api/org/staff/${t}/assign-customers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerIds:Array.from(x),primaryCustomerId:g})}),r=await e.json();e.ok?(alert("담당 고객사가 할당되었습니다."),i()):alert(r.error||"할당에 실패했습니다.")}catch(e){alert("할당 중 오류가 발생했습니다.")}finally{y(!1)}};if(!e)return null;let k=n.filter(e=>e.name.toLowerCase().includes(u.toLowerCase())||e.businessNumber.includes(u));return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] flex flex-col",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"담당 고객사 할당"})}),(0,a.jsxs)("div",{className:"p-6 flex-1 overflow-y-auto",children:[a.jsx("div",{className:"mb-4",children:a.jsx(o.Z,{type:"text",placeholder:"고객사명 또는 사업자등록번호 검색...",value:u,onChange:e=>b(e.target.value)})}),a.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:(0,a.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:["선택: ",x.size,"개",g&&" (주 담당 설정됨)"]})}),a.jsx("div",{className:"space-y-2",children:0===k.length?a.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"고객사가 없습니다."}):k.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-700 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,a.jsxs)("label",{className:"flex items-center flex-1 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:x.has(e.id),onChange:()=>f(e.id),className:"mr-3"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),a.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.businessNumber})]})]}),x.has(e.id)&&a.jsx("button",{onClick:()=>j(e.id),className:`ml-3 px-3 py-1 rounded text-xs font-medium ${g===e.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500"}`,children:g===e.id?"주 담당":"주 담당 설정"})]},e.id))}),a.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"\uD83D\uDCA1 주 담당으로 설정된 고객사는 알림 및 보고서에서 기본 담당자로 표시됩니다."})})]}),(0,a.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[a.jsx("button",{onClick:d,disabled:p,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50",children:"취소"}),a.jsx(l.Z,{onClick:v,disabled:p,className:"flex-1",children:p?"저장 중...":"저장"})]})]})})}function x(){var e;let{data:t,status:r}=(0,d.useSession)(),x=(0,i.useRouter)(),m=(0,i.useParams)(),g=m?.id,[h,u]=(0,s.useState)(null),[b,p]=(0,s.useState)(!0),[y,f]=(0,s.useState)(!1),[j,v]=(0,s.useState)(!1),[k,N]=(0,s.useState)({name:"",phone:"",department:"",position:"",role:""}),w=async()=>{try{p(!0);let e=await fetch(`/api/org/staff/${g}`),t=await e.json();e.ok?(u(t.staff),N({name:t.staff.name||"",phone:t.staff.phone||"",department:t.staff.department||"",position:t.staff.position||"",role:t.staff.role||""})):(alert(t.error||"직원 정보를 불러오는데 실패했습니다."),x.push("/org/staff"))}catch(e){alert("직원 정보를 불러오는데 실패했습니다.")}finally{p(!1)}},C=async()=>{try{let e=await fetch(`/api/org/staff/${g}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),t=await e.json();e.ok?(alert("저장되었습니다."),f(!1),w()):alert(t.error||"저장에 실패했습니다.")}catch(e){alert("저장 중 오류가 발생했습니다.")}},A=async()=>{if(!h)return;let e=h.isActive?"비활성화":"활성화";if(confirm(`이 직원을 ${e}하시겠습니까?`))try{let t=h.isActive?"deactivate":"activate",r=await fetch(`/api/org/staff/${g}/${t}`,{method:"PATCH"}),a=await r.json();r.ok?(alert(a.message),w()):alert(a.error||`${e}에 실패했습니다.`)}catch(t){alert(`${e} 중 오류가 발생했습니다.`)}},P=async()=>{if(h){if(h.assignedCustomers.length>0){alert(`담당 고객사가 ${h.assignedCustomers.length}개 있는 직원은 삭제할 수 없습니다.
먼저 담당 고객사를 해제해주세요.`);return}if(confirm(`"${h.name}" 직원을 완전히 삭제하시겠습니까?

⚠️ 이 작업은 되돌릴 수 없습니다.`))try{let e=await fetch(`/api/org/staff/${g}`,{method:"DELETE"}),t=await e.json();e.ok?(alert("삭제되었습니다."),x.push("/org/staff")):alert(t.error||"삭제에 실패했습니다.")}catch(e){alert("삭제 중 오류가 발생했습니다.")}}};return b?a.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"text-gray-500",children:"로딩 중..."})})}):h?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"직원 상세"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"직원 정보 및 담당 고객사 관리"})]}),a.jsx(n.default,{href:"/org/staff",children:a.jsx("button",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"← 목록으로"})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"기본 정보"}),y?(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{f(!1),N({name:h.name||"",phone:h.phone||"",department:h.department||"",position:h.position||"",role:h.role||""})},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"취소"}),a.jsx(l.Z,{onClick:C,children:"저장"})]}):a.jsx(l.Z,{onClick:()=>f(!0),children:"수정"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"이름"}),y?a.jsx(o.Z,{value:k.name,onChange:e=>N({...k,name:e.target.value})}):a.jsx("div",{className:"text-gray-900 dark:text-white",children:h.name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"이메일"}),a.jsx("div",{className:"text-gray-900 dark:text-white",children:h.email}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"이메일은 변경할 수 없습니다."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"전화번호"}),y?a.jsx(o.Z,{value:k.phone,onChange:e=>N({...k,phone:e.target.value}),placeholder:"010-1234-5678"}):a.jsx("div",{className:"text-gray-900 dark:text-white",children:h.phone||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"역할"}),y?(0,a.jsxs)("select",{value:k.role,onChange:e=>N({...k,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"ORG_ADMIN",children:"조직 관리자"}),a.jsx("option",{value:"OPERATOR",children:"실무자"})]}):a.jsx("div",{children:(e=h.role,a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${{SUPER_ADMIN:"bg-purple-100 text-purple-800",ORG_ADMIN:"bg-red-100 text-red-800",OPERATOR:"bg-blue-100 text-blue-800"}[e]||"bg-gray-100 text-gray-800"}`,children:{SUPER_ADMIN:"시스템 관리자",ORG_ADMIN:"조직 관리자",OPERATOR:"실무자"}[e]||e}))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"부서"}),y?a.jsx(o.Z,{value:k.department,onChange:e=>N({...k,department:e.target.value}),placeholder:"개발팀"}):a.jsx("div",{className:"text-gray-900 dark:text-white",children:h.department||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"직책"}),y?a.jsx(o.Z,{value:k.position,onChange:e=>N({...k,position:e.target.value}),placeholder:"팀장"}):a.jsx("div",{className:"text-gray-900 dark:text-white",children:h.position||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"상태"}),a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${h.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.isActive?"활성":"비활성"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"가입일"}),a.jsx("div",{className:"text-gray-900 dark:text-white",children:new Date(h.createdAt).toLocaleDateString("ko-KR")})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["담당 고객사 (",h.assignedCustomers.length,"개)"]}),a.jsx(l.Z,{onClick:()=>v(!0),children:"담당 할당"})]}),0===h.assignedCustomers.length?a.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"담당 고객사가 없습니다."}):a.jsx("div",{className:"space-y-2",children:h.assignedCustomers.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:e.customer.name}),a.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.customer.businessNumber})]}),e.isPrimary&&a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded text-xs font-medium",children:"주 담당"})]},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"계정 관리"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:h.isActive?"계정 비활성화":"계정 활성화"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:h.isActive?"비활성화하면 로그인할 수 없습니다. 데이터는 유지됩니다.":"활성화하면 다시 로그인할 수 있습니다."})]}),a.jsx("button",{onClick:A,className:`px-4 py-2 rounded-md whitespace-nowrap ${h.isActive?"bg-orange-600 hover:bg-orange-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:h.isActive?"비활성화":"활성화"})]}),!h.isActive&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20 rounded-md",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-medium text-red-900 dark:text-red-200",children:"계정 삭제"}),a.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:"⚠️ 삭제하면 모든 데이터가 영구적으로 삭제됩니다. 이 작업은 되돌릴 수 없습니다."}),h.assignedCustomers.length>0&&(0,a.jsxs)("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:["담당 고객사 ",h.assignedCustomers.length,"개를 먼저 해제해야 삭제할 수 있습니다."]})]}),a.jsx("button",{onClick:P,disabled:h.assignedCustomers.length>0,className:"px-4 py-2 rounded-md whitespace-nowrap bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"삭제"})]})]})]})]}),j&&a.jsx(c,{isOpen:j,staffId:g,currentAssignments:h.assignedCustomers,onClose:()=>v(!1),onSuccess:()=>{v(!1),w()}})]}):null}},99837:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(10326);r(17577);let s={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},d={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i({variant:e="primary",size:t="md",className:r="",...i}){return a.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ${s[e]} ${d[t]} ${r}`,...i})}},89175:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var a=r(10326);function s({className:e="",...t}){return a.jsx("input",{className:`rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20 ${e}`,...t})}r(17577)},99246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\org\staff\[id]\page.tsx#default`)},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(66621);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,9975,6621,5736],()=>r(44983));module.exports=a})();