(()=>{var e={};e.id=6121,e.ids=[6121],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},49707:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>o,pages:()=>x,routeModule:()=>u,tree:()=>c}),s(1458),s(92553),s(35866);var a=s(23191),r=s(88716),l=s(37922),n=s.n(l),i=s(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let c=["",{children:["org",{children:["stack-requests",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1458)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\org\\stack-requests\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["C:\\Users\\User\\boaz\\frontend\\src\\app\\org\\stack-requests\\page.tsx"],o="/org/stack-requests/page",p={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/org/stack-requests/page",pathname:"/org/stack-requests",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},74126:(e,t,s)=>{Promise.resolve().then(s.bind(s,15449))},15449:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(10326),r=s(17577),l=s(77109),n=s(35047);function i({isOpen:e,onClose:t,onSuccess:s}){let{data:n}=(0,l.useSession)(),[i,d]=(0,r.useState)([]),[c,x]=(0,r.useState)(""),[o,p]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[j,f]=(0,r.useState)(""),[N,v]=(0,r.useState)(""),[w,k]=(0,r.useState)(""),[P,C]=(0,r.useState)(!1),S=async()=>{if(!c||!o||!h){alert("고객사, 굴뚝명, 위치는 필수입니다.");return}try{C(!0);let e=await fetch("/api/stack-assignments/request-new",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:c,stackName:o,stackCode:u||null,location:h,height:b?parseFloat(b):null,diameter:j?parseFloat(j):null,coordinates:N||null,description:w||null})}),t=await e.json();e.ok?(alert("굴뚝 등록 요청이 전송되었습니다."),s(),q()):alert(t.error||"요청 전송 실패")}catch(e){alert("요청 전송 중 오류가 발생했습니다.")}finally{C(!1)}},q=()=>{x(""),p(""),m(""),g(""),y(""),f(""),v(""),k(""),t()};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-[600px] max-h-[80vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"신규 굴뚝 등록 요청"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["고객사 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:c,onChange:e=>x(e.target.value),className:"w-full border rounded px-3 py-2",required:!0,children:[a.jsx("option",{value:"",children:"고객사 선택"}),i.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.businessNumber,")"]},e.id))]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["굴뚝명 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:o,onChange:e=>p(e.target.value),placeholder:"예: 1호 소각로",className:"w-full border rounded px-3 py-2",required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"굴뚝코드"}),a.jsx("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"예: ST-001",className:"w-full border rounded px-3 py-2"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["위치 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"예: 공장 동쪽",className:"w-full border rounded px-3 py-2",required:!0})]}),(0,a.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"높이 (m)"}),a.jsx("input",{type:"number",step:"0.1",value:b,onChange:e=>y(e.target.value),placeholder:"예: 25.5",className:"w-full border rounded px-3 py-2"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"직경 (m)"}),a.jsx("input",{type:"number",step:"0.1",value:j,onChange:e=>f(e.target.value),placeholder:"예: 1.2",className:"w-full border rounded px-3 py-2"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"좌표"}),a.jsx("input",{type:"text",value:N,onChange:e=>v(e.target.value),placeholder:"예: 37.5665,126.9780",className:"w-full border rounded px-3 py-2"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"설명"}),a.jsx("textarea",{value:w,onChange:e=>k(e.target.value),placeholder:"추가 설명이 있으면 입력해주세요",rows:3,className:"w-full border rounded px-3 py-2"})]}),a.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded text-sm text-blue-800",children:"\uD83D\uDCA1 요청을 전송하면 고객사 관리자가 승인할 수 있습니다."}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:q,className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",disabled:P,children:"취소"}),a.jsx("button",{onClick:S,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400",disabled:P,children:P?"전송 중...":"등록 요청"})]})]})}):null}function d(){let{data:e,status:t}=(0,l.useSession)();(0,n.useRouter)();let[s,d]=(0,r.useState)([]),[c,x]=(0,r.useState)(!0),[o,p]=(0,r.useState)("ALL"),[u,m]=(0,r.useState)(!1),h=async()=>{try{x(!0);let t=e?.user?.organizationId,s=await fetch(`/api/stack-requests?organizationId=${t}`),a=await s.json();s.ok&&d(a.requests||[])}catch(e){}finally{x(!1)}},g=s.filter(e=>"ALL"===o||e.status===o),b=e=>a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${{PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"}[e]}`,children:{PENDING:"대기중",APPROVED:"승인됨",REJECTED:"거부됨"}[e]}),y=e=>"NEW_STACK"===e?a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"신규 등록"}):a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800",children:"담당 추가"}),j=e?.user?.role;return c?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"text-gray-500",children:"로딩 중..."})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"굴뚝 등록 요청"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"고객사 굴뚝 등록 및 담당 요청 관리"})]}),(0,a.jsxs)("div",{className:"mb-4 flex flex-wrap gap-3 items-center",children:[(0,a.jsxs)("select",{value:o,onChange:e=>p(e.target.value),className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"ALL",children:"전체"}),a.jsx("option",{value:"PENDING",children:"대기중"}),a.jsx("option",{value:"APPROVED",children:"승인됨"}),a.jsx("option",{value:"REJECTED",children:"거부됨"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["총 ",g.length,"건"]}),("ORG_ADMIN"===j||"OPERATOR"===j)&&a.jsx("button",{onClick:()=>m(!0),className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"+ 신규 굴뚝 등록 요청"})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"상태"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청유형"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"고객사"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"굴뚝명"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"굴뚝코드"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"위치"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"제원"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청일"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===g.length?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:"굴뚝 등록 요청이 없습니다."})}):g.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:b(e.status)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y(e.requestType)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:e.customer.name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:e.stackName}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:e.stackCode||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:e.location}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.height&&e.diameter?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:["높이: ",e.height,"m"]}),(0,a.jsxs)("div",{children:["직경: ",e.diameter,"m"]})]}):"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})]})}),a.jsx(i,{isOpen:u,onClose:()=>m(!1),onSuccess:h})]})}},1458:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\org\stack-requests\page.tsx#default`)},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,9975,6621,5736],()=>s(49707));module.exports=a})();