(()=>{var e={};e.id=8219,e.ids=[8219],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},87366:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>o,pages:()=>x,routeModule:()=>m,tree:()=>d}),s(26276),s(92553),s(35866);var a=s(23191),r=s(88716),i=s(37922),n=s.n(i),l=s(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let d=["",{children:["customer",{children:["stack-requests",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,26276)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\customer\\stack-requests\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["C:\\Users\\User\\boaz\\frontend\\src\\app\\customer\\stack-requests\\page.tsx"],o="/customer/stack-requests/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/customer/stack-requests/page",pathname:"/customer/stack-requests",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},26142:(e,t,s)=>{Promise.resolve().then(s.bind(s,47231))},47231:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(10326),r=s(17577),i=s(77109),n=s(35047);function l(){let{data:e,status:t}=(0,i.useSession)();(0,n.useRouter)();let[s,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[x,o]=(0,r.useState)("ALL"),p=async()=>{try{d(!0);let t=e?.user?.customerId,s=await fetch(`/api/stack-requests?customerId=${t}`),a=await s.json();s.ok&&l(a.requests||[])}catch(e){}finally{d(!1)}},m=async(e,t)=>{if(confirm(`이 굴뚝 ${"NEW_STACK"===t?"등록":"담당"} 요청을 승인하시겠습니까?`))try{let s=await fetch(`/api/stack-requests/${e}/approve`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"NEW_STACK"===t?"create_new":"assign_existing"})});if(s.ok)alert("요청이 승인되었습니다."),p();else{let e=await s.json();alert(e.error||"승인 실패")}}catch(e){alert("승인 중 오류가 발생했습니다.")}},u=async e=>{if(confirm("이 요청을 거부하시겠습니까?"))try{let t=await fetch(`/api/stack-requests/${e}/reject`,{method:"PATCH"});if(t.ok)alert("요청이 거부되었습니다."),p();else{let e=await t.json();alert(e.error||"거부 실패")}}catch(e){alert("거부 중 오류가 발생했습니다.")}},h=s.filter(e=>"ALL"===x||e.status===x),y=e=>a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${{PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"}[e]}`,children:{PENDING:"대기중",APPROVED:"승인됨",REJECTED:"거부됨"}[e]}),g=e=>"NEW_STACK"===e?a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"신규 등록"}):a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800",children:"담당 추가"}),f=e?.user?.role,j="CUSTOMER_ADMIN"===f||"SUPER_ADMIN"===f;return c?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"text-gray-500",children:"로딩 중..."})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"굴뚝 등록 요청 관리"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"환경측정기업의 굴뚝 등록 및 담당 요청 관리"})]}),(0,a.jsxs)("div",{className:"mb-4 flex flex-wrap gap-3 items-center",children:[(0,a.jsxs)("select",{value:x,onChange:e=>o(e.target.value),className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"ALL",children:"전체"}),a.jsx("option",{value:"PENDING",children:"대기중"}),a.jsx("option",{value:"APPROVED",children:"승인됨"}),a.jsx("option",{value:"REJECTED",children:"거부됨"})]}),(0,a.jsxs)("div",{className:"ml-auto text-sm text-gray-500",children:["총 ",h.length,"건"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"상태"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청유형"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청기업"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"굴뚝명"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"굴뚝코드"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"위치"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"제원"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"요청일"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"액션"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===h.length?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"굴뚝 등록 요청이 없습니다."})}):h.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y(e.status)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g(e.requestType)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:e.organization.name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:e.stackName}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:e.stackCode||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:e.location}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.height&&e.diameter?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:["높이: ",e.height,"m"]}),(0,a.jsxs)("div",{children:["직경: ",e.diameter,"m"]})]}):"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:["PENDING"===e.status&&j&&(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>m(e.id,e.requestType),className:"text-green-600 hover:text-green-900",children:"승인"}),a.jsx("button",{onClick:()=>u(e.id),className:"text-red-600 hover:text-red-900",children:"거부"})]}),"PENDING"!==e.status&&a.jsx("span",{className:"text-gray-400",children:"-"})]})]},e.id))})]})})]})}},26276:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\customer\stack-requests\page.tsx#default`)},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,9975,6621,5736],()=>s(87366));module.exports=a})();