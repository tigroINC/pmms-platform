"use strict";(()=>{var e={};e.id=315,e.ids=[315],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},73377:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{POST:()=>d});var i=r(49303),n=r(88716),s=r(60670),o=r(87070),u=r(20728),p=r(98691);async function d(e){try{let{token:t,password:r}=await e.json();if(!t||!r)return o.NextResponse.json({error:"토큰과 비밀번호가 필요합니다."},{status:400});if(r.length<8)return o.NextResponse.json({error:"비밀번호는 최소 8자 이상이어야 합니다."},{status:400});let a=await u._.user.findFirst({where:{inviteToken:t,inviteTokenExpiry:{gte:new Date},status:"PENDING"}});if(!a)return o.NextResponse.json({error:"유효하지 않거나 만료된 초대 링크입니다."},{status:404});let i=await p.ZP.hash(r,10);return await u._.user.update({where:{id:a.id},data:{password:i,status:"APPROVED",isActive:!0,inviteToken:null,inviteTokenExpiry:null}}),await u._.activityLog.create({data:{userId:a.id,action:"ACCEPT_INVITE",details:`${a.name}이(가) 초대를 수락하고 계정을 활성화함`,ipAddress:e.headers.get("x-forwarded-for")||"unknown"}}),o.NextResponse.json({message:"계정이 활성화되었습니다."})}catch(e){return o.NextResponse.json({error:"계정 활성화 중 오류가 발생했습니다."},{status:500})}}let c=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/accept-invite/route",pathname:"/api/auth/accept-invite",filename:"route",bundlePath:"app/api/auth/accept-invite/route"},resolvedPagePath:"C:\\Users\\User\\boaz\\frontend\\src\\app\\api\\auth\\accept-invite\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:v}=c,x="/api/auth/accept-invite/route";function m(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}},20728:(e,t,r)=>{r.d(t,{_:()=>i});let a=require("@prisma/client"),i=global.prisma||new a.PrismaClient({log:["warn","error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,8691],()=>r(73377));module.exports=a})();