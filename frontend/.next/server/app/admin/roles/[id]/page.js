(()=>{var e={};e.id=2878,e.ids=[2878],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},75447:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>c.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>i,routeModule:()=>p,tree:()=>l}),a(20793),a(92553),a(35866);var r=a(23191),s=a(88716),o=a(37922),c=a.n(o),n=a(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(t,d);let l=["",{children:["admin",{children:["roles",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,20793)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\admin\\roles\\[id]\\page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],i=["C:\\Users\\User\\boaz\\frontend\\src\\app\\admin\\roles\\[id]\\page.tsx"],m="/admin/roles/[id]/page",u={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/roles/[id]/page",pathname:"/admin/roles/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},70593:(e,t,a)=>{Promise.resolve().then(a.bind(a,44523))},44523:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(10326),s=a(17577),o=a(77109),c=a(35047);let n=[{code:"customer.tab.all",name:"전체탭 보기",category:"고객사 관리"},{code:"customer.tab.internal",name:"내부탭 보기",category:"고객사 관리"},{code:"customer.tab.connected",name:"연결탭 보기",category:"고객사 관리"},{code:"customer.tab.search",name:"검색탭 보기",category:"고객사 관리"},{code:"customer.view",name:"고객사 조회",category:"고객사 관리"},{code:"customer.create",name:"고객사 등록",category:"고객사 관리"},{code:"customer.update",name:"고객사 수정",category:"고객사 관리"},{code:"customer.delete",name:"고객사 삭제",category:"고객사 관리"},{code:"customer.activate",name:"활성화/비활성화",category:"고객사 관리"},{code:"customer.search",name:"검색 기능",category:"고객사 관리"},{code:"customer.filter",name:"필터 기능",category:"고객사 관리"},{code:"customer.bulk_upload",name:"일괄업로드",category:"고객사 관리"},{code:"customer.export",name:"Excel 내보내기",category:"고객사 관리"},{code:"customer.invite",name:"고객사 초대",category:"고객사 관리"},{code:"stack.view",name:"굴뚝 조회",category:"굴뚝 관리"},{code:"stack.create",name:"굴뚝 등록",category:"굴뚝 관리"},{code:"stack.update",name:"굴뚝 수정",category:"굴뚝 관리"},{code:"stack.delete",name:"굴뚝 삭제",category:"굴뚝 관리"},{code:"measurement.view",name:"측정 데이터 조회",category:"측정 데이터"},{code:"measurement.create",name:"측정 데이터 입력",category:"측정 데이터"},{code:"measurement.update",name:"측정 데이터 수정",category:"측정 데이터"},{code:"measurement.delete",name:"측정 데이터 삭제",category:"측정 데이터"},{code:"measurement.export",name:"측정 데이터 내보내기",category:"측정 데이터"},{code:"user.view",name:"사용자 조회",category:"사용자 관리"},{code:"user.create",name:"사용자 등록",category:"사용자 관리"},{code:"user.update",name:"사용자 수정",category:"사용자 관리"},{code:"user.delete",name:"사용자 삭제",category:"사용자 관리"},{code:"user.role",name:"역할 관리",category:"사용자 관리"},{code:"report.view",name:"보고서 조회",category:"보고서"},{code:"report.create",name:"보고서 생성",category:"보고서"},{code:"report.update",name:"보고서 수정",category:"보고서"},{code:"report.delete",name:"보고서 삭제",category:"보고서"},{code:"settings.view",name:"설정 조회",category:"설정"},{code:"settings.update",name:"설정 변경",category:"설정"},{code:"contract.view",name:"계약 조회",category:"계약 관리"},{code:"contract.create",name:"계약 등록",category:"계약 관리"},{code:"contract.update",name:"계약 수정",category:"계약 관리"},{code:"contract.delete",name:"계약 삭제",category:"계약 관리"}];function d(){let{data:e,status:t}=(0,o.useSession)(),a=(0,c.useRouter)(),d=(0,c.useParams)().id,[l,i]=(0,s.useState)(null),[m,u]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[x,h]=(0,s.useState)(new Set),[y,b]=(0,s.useState)(!0),[v,f]=(0,s.useState)(!1),j=e=>{let t=new Set(x);t.has(e)?t.delete(e):t.add(e),h(t)},N=async e=>{if(e.preventDefault(),!m){alert("역할 이름을 입력해주세요.");return}if(0===x.size){alert("최소 1개 이상의 권한을 선택해주세요.");return}f(!0);try{let e=await fetch(`/api/custom-roles/${d}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m,description:p,permissions:Array.from(x).map(e=>({permissionCode:e,granted:!0}))})}),t=await e.json();e.ok?(alert("역할이 수정되었습니다!"),a.push("/org/settings/roles")):alert(t.error||"역할 수정 실패")}catch(e){alert("역할 수정 중 오류가 발생했습니다.")}finally{f(!1)}};if(y)return r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"text-gray-500",children:"로딩 중..."})});if(!l)return null;let w=n.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("button",{onClick:()=>a.push("/org/settings/roles"),className:"text-blue-600 hover:text-blue-700 mb-2",children:"← 역할 관리로 돌아가기"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"역할 수정"}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:[l._count.users,"명의 사용자가 이 역할을 사용 중입니다."]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("form",{onSubmit:N,children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3",children:"기본 정보"}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"역할 이름 *"}),r.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"예: 현장 책임자",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),r.jsx("textarea",{value:p,onChange:e=>g(e.target.value),className:"w-full border rounded px-3 py-2",rows:2,placeholder:"역할에 대한 설명을 입력하세요"})]}),l.template&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"기반 템플릿"}),r.jsx("div",{className:"px-3 py-2 bg-gray-50 rounded text-gray-700",children:l.template.name})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-3",children:["권한 선택 (",x.size,"개 선택됨)"]}),r.jsx("div",{className:"space-y-4",children:Object.entries(w).map(([e,t])=>(0,r.jsxs)("div",{className:"border rounded p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:e}),r.jsx("button",{type:"button",onClick:()=>{let e=t.map(e=>e.code),a=e.every(e=>x.has(e)),r=new Set(x);a?e.forEach(e=>r.delete(e)):e.forEach(e=>r.add(e)),h(r)},className:"text-sm text-blue-600 hover:text-blue-700",children:t.every(e=>x.has(e.code))?"전체 해제":"전체 선택"})]}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.map(e=>(0,r.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[r.jsx("input",{type:"checkbox",checked:x.has(e.code),onChange:()=>j(e.code),className:"rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:e.name})]},e.code))})]},e))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",onClick:()=>a.push("/org/settings/roles"),className:"flex-1 px-4 py-2 border rounded hover:bg-gray-50",disabled:v,children:"취소"}),r.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",disabled:v,children:v?"저장 중...":"변경사항 저장"})]})]})})]})}},20793:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\admin\roles\[id]\page.tsx#default`)},73881:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(66621);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,9975,6621,5736],()=>a(75447));module.exports=r})();