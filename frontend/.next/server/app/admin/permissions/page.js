(()=>{var e={};e.id=8944,e.ids=[8944],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},62733:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>d.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>h,tree:()=>c}),r(4267),r(92553),r(35866);var a=r(23191),t=r(88716),l=r(37922),d=r.n(l),n=r(95231),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);r.d(s,i);let c=["",{children:["admin",{children:["permissions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4267)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\admin\\permissions\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["C:\\Users\\User\\boaz\\frontend\\src\\app\\admin\\permissions\\page.tsx"],o="/admin/permissions/page",m={require:r,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/admin/permissions/page",pathname:"/admin/permissions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},78395:(e,s,r)=>{Promise.resolve().then(r.bind(r,56915))},56915:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>m});var a=r(10326),t=r(17577),l=r(77109),d=r(35047),n=r(90434),i=r(62993),c=r(99837),x=r(89175),o=r(43150);function m(){let{data:e,status:s}=(0,l.useSession)();(0,d.useRouter)();let[r,m]=(0,t.useState)([]),[p,g]=(0,t.useState)([]),[u,b]=(0,t.useState)(!0),[j,y]=(0,t.useState)(null),[N,v]=(0,t.useState)(!1),[f,k]=(0,t.useState)(""),[w,D]=(0,t.useState)(!1),[C,A]=(0,t.useState)("ALL"),S=async()=>{try{let e=await fetch("/api/users"),s=await e.json();e.ok&&m(s.users||[])}catch(e){}},R=async(e,s)=>{try{let r=await fetch(`/api/users/${e}/role`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({customRoleId:s})});if(r.ok)alert("역할이 변경되었습니다."),S();else{let e=await r.json();alert(e.error||"역할 변경 실패")}}catch(e){alert("역할 변경 중 오류가 발생했습니다.")}},O=e=>a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${{SUPER_ADMIN:"bg-purple-100 text-purple-800",ORG_ADMIN:"bg-blue-100 text-blue-800",OPERATOR:"bg-green-100 text-green-800",CUSTOMER_GROUP_ADMIN:"bg-yellow-100 text-yellow-800",CUSTOMER_SITE_ADMIN:"bg-orange-100 text-orange-800",CUSTOMER_USER:"bg-gray-100 text-gray-800"}[e]||"bg-gray-100 text-gray-800"}`,children:{SUPER_ADMIN:"시스템 관리자",ORG_ADMIN:"조직 관리자",OPERATOR:"실무자",CUSTOMER_GROUP_ADMIN:"그룹 관리자",CUSTOMER_SITE_ADMIN:"사업장 관리자",CUSTOMER_USER:"일반 사용자"}[e]||e}),_=e=>a.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-100 text-gray-700",children:{SYSTEM:"시스템 전체",ORGANIZATION:"조직 전체",GROUP:"그룹",SITE:"사업장",ASSIGNED:"담당",SELF:"본인"}[e]||e});return u?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[a.jsx(i.Z,{}),a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"text-gray-500",children:"로딩 중..."})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[a.jsx(i.Z,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"사용자 권한 관리"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"사용자별 역할 및 권한 설정"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>D(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"도움말"]}),a.jsx(n.default,{href:"/admin/dashboard",children:a.jsx(c.Z,{children:"← 대시보드로"})})]})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"전체 "}),a.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:r.length})]}),(0,a.jsxs)("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"활성 "}),a.jsx("span",{className:"font-bold text-green-600",children:r.filter(e=>e.isActive).length})]})]}),a.jsx("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),a.jsx(x.Z,{type:"text",placeholder:"사용자 이름 또는 이메일 검색...",value:f,onChange:e=>k(e.target.value),className:"flex-1 min-w-[200px]"}),(0,a.jsxs)("select",{value:C,onChange:e=>A(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white",children:[a.jsx("option",{value:"ALL",children:"전체 역할"}),a.jsx("option",{value:"ORG_ADMIN",children:"조직 관리자"}),a.jsx("option",{value:"OPERATOR",children:"실무자"}),a.jsx("option",{value:"CUSTOMER_ADMIN",children:"고객사 관리자"}),a.jsx("option",{value:"CUSTOMER_USER",children:"고객사 사용자"})]})]})}),a.jsx("div",{className:"hidden md:block bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"이름"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"이메일"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"시스템 역할"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"커스텀 역할"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"접근 범위"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"상태"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"액션"})]})}),a.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:r.filter(e=>{let s=""===f||e.name.toLowerCase().includes(f.toLowerCase())||e.email.toLowerCase().includes(f.toLowerCase()),r="ALL"===C||e.role===C;return s&&r}).map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:e.name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:O(e.role)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.customRole?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200 rounded text-xs font-medium",children:e.customRole.name}),(0,a.jsxs)("select",{value:e.customRole.id,onChange:s=>R(e.id,s.target.value||null),className:"border rounded px-2 py-1 text-xs dark:bg-gray-700 dark:border-gray-600",disabled:"SUPER_ADMIN"===e.role,children:[a.jsx("option",{value:e.customRole.id,children:e.customRole.name}),a.jsx("option",{value:"",children:"기본 역할로 변경"}),p.filter(s=>s.id!==e.customRole?.id).map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 rounded text-xs",children:"기본 역할"}),(0,a.jsxs)("select",{value:"",onChange:s=>R(e.id,s.target.value||null),className:"border rounded px-2 py-1 text-xs dark:bg-gray-700 dark:border-gray-600",disabled:"SUPER_ADMIN"===e.role,children:[a.jsx("option",{value:"",children:"선택"}),p.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_(e.accessScope)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isActive?"활성":"비활성"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.jsx("button",{onClick:()=>{y(e),v(!0)},className:"text-blue-600 hover:text-blue-900",disabled:"SUPER_ADMIN"===e.role,children:"개별 권한 설정"})})]},e.id))})]})})}),a.jsx("div",{className:"md:hidden space-y-3",children:r.filter(e=>{let s=""===f||e.name.toLowerCase().includes(f.toLowerCase())||e.email.toLowerCase().includes(f.toLowerCase()),r="ALL"===C||e.role===C;return s&&r}).map(e=>(0,a.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"font-medium text-lg",children:e.name}),a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isActive?"활성":"비활성"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCE7 이메일:"})," ",e.email]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFF7️ 시스템 역할:"})," ",O(e.role)]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFAF 커스텀 역할:"})," ",e.customRole?a.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200 rounded text-xs font-medium",children:e.customRole.name}):a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 rounded text-xs",children:"기본 역할"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDD11 접근 범위:"})," ",_(e.accessScope)]}),a.jsx("div",{className:"pt-2",children:a.jsx("button",{onClick:()=>{y(e),v(!0)},disabled:"SUPER_ADMIN"===e.role,className:"w-full px-3 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded text-sm disabled:opacity-50",children:"개별 권한 설정"})})]})]},e.id))}),N&&j&&a.jsx(h,{user:j,onClose:()=>{v(!1),y(null)},onSuccess:()=>{v(!1),y(null),S()}}),a.jsx(o.Z,{isOpen:w,onClose:()=>D(!1),title:"권한 관리 가이드",sections:[{title:"개요",content:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 border-l-4 border-purple-600 p-4 rounded",children:[a.jsx("h4",{className:"font-bold text-purple-900 dark:text-purple-200 mb-2",children:"\uD83D\uDCCC 이 페이지의 목적"}),(0,a.jsxs)("p",{className:"text-purple-800 dark:text-purple-300",children:["권한 관리 페이지는 ",a.jsx("strong",{children:"커스텀 역할 할당"}),"과 ",a.jsx("strong",{children:"세부 권한 설정"}),"을 관리하는 곳입니다."]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"주요 기능"}),(0,a.jsxs)("ul",{className:"space-y-2",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-green-600 mt-1",children:"✓"}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"커스텀 역할 할당"}),": 조직별로 생성한 역할을 사용자에게 할당"]})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-green-600 mt-1",children:"✓"}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"접근 범위 조정"}),": 사용자가 접근할 수 있는 데이터 범위 설정"]})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-green-600 mt-1",children:"✓"}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"개별 권한 설정"}),": 특정 사용자에게만 추가 권한 부여 또는 제한"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 p-4 rounded",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"\uD83D\uDCA1 사용자 관리와의 차이"}),(0,a.jsxs)("p",{className:"text-sm",children:[a.jsx("strong",{children:"사용자 관리"}),"는 시스템 기본 역할(ORG_ADMIN, OPERATOR 등)을 변경하고,",a.jsx("strong",{className:"text-purple-600",children:" 권한 관리(이 페이지)"}),"는 커스텀 역할을 할당하여 세부 권한을 조정합니다."]})]})]})},{title:"커스텀 역할",content:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"\uD83C\uDFAD 커스텀 역할이란?"}),a.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border-l-4 border-purple-600 p-4 rounded",children:(0,a.jsxs)("p",{className:"text-purple-800 dark:text-purple-300 text-sm",children:["커스텀 역할은 ",a.jsx("strong",{children:"조직별로 생성한 맞춤형 역할"}),"입니다. 시스템 기본 역할의 권한을 기반으로 하되, 조직의 필요에 따라 권한을 추가하거나 제한할 수 있습니다."]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h5",{className:"font-semibold",children:"커스텀 역할 예시"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,a.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-blue-50 dark:bg-blue-900/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-lg",children:"\uD83D\uDC54"}),a.jsx("span",{className:"text-sm font-semibold",children:"선임 실무자"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"기본 OPERATOR 권한 + 측정 데이터 승인 권한 + 보고서 작성 권한"})]}),(0,a.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-green-50 dark:bg-green-900/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-lg",children:"\uD83C\uDF0D"}),a.jsx("span",{className:"text-sm font-semibold",children:"지역 관리자"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"특정 지역 고객사만 관리 + 해당 지역 직원 관리 권한"})]}),(0,a.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-orange-50 dark:bg-orange-900/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-lg",children:"\uD83D\uDCCA"}),a.jsx("span",{className:"text-sm font-semibold",children:"데이터 분석가"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"모든 측정 데이터 조회 권한 + 통계 분석 권한 (수정 권한 없음)"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"\uD83D\uDCDD 커스텀 역할 할당 방법"}),(0,a.jsxs)("ol",{className:"text-sm space-y-2",children:[a.jsx("li",{children:"1. 커스텀 역할 컬럼에서 드롭다운 메뉴 클릭"}),a.jsx("li",{children:'2. 할당할 커스텀 역할 선택 (또는 "기본 역할 사용" 선택)'}),a.jsx("li",{children:"3. 자동으로 저장됨"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:'\uD83D\uDCA1 커스텀 역할은 "역할 관리" 메뉴에서 생성할 수 있습니다.'})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"⚠️ 주의사항"}),(0,a.jsxs)("ul",{className:"text-sm space-y-1",children:[a.jsx("li",{children:"• SUPER_ADMIN에게는 커스텀 역할을 할당할 수 없습니다"}),a.jsx("li",{children:"• 커스텀 역할이 없으면 시스템 기본 역할의 권한이 적용됩니다"}),a.jsx("li",{children:"• 커스텀 역할을 할당하면 시스템 역할의 권한을 오버라이드합니다"})]})]})]})},{title:"접근 범위",content:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"\uD83C\uDFAF 접근 범위(Access Scope)"}),a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-600 p-4 rounded",children:(0,a.jsxs)("p",{className:"text-blue-800 dark:text-blue-300 text-sm",children:["접근 범위는 사용자가 ",a.jsx("strong",{children:"어떤 데이터에 접근할 수 있는지"}),"를 정의합니다."]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"border-l-4 border-purple-500 bg-purple-50 dark:bg-purple-900/20 p-3 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-2 py-0.5 bg-purple-600 text-white rounded text-xs font-bold",children:"SYSTEM"}),a.jsx("span",{className:"font-semibold text-sm",children:"시스템 전체"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"모든 조직, 모든 고객사의 데이터에 접근 가능 (SUPER_ADMIN 전용)"})]}),(0,a.jsxs)("div",{className:"border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-900/20 p-3 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white rounded text-xs font-bold",children:"ORGANIZATION"}),a.jsx("span",{className:"font-semibold text-sm",children:"조직 전체"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"자신이 속한 조직의 모든 고객사 데이터에 접근 가능 (ORG_ADMIN 기본값)"})]}),(0,a.jsxs)("div",{className:"border-l-4 border-orange-500 bg-orange-50 dark:bg-orange-900/20 p-3 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-2 py-0.5 bg-orange-600 text-white rounded text-xs font-bold",children:"ASSIGNED"}),a.jsx("span",{className:"font-semibold text-sm",children:"담당"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"자신에게 할당된 고객사의 데이터만 접근 가능 (OPERATOR 기본값)"})]}),(0,a.jsxs)("div",{className:"border-l-4 border-gray-500 bg-gray-50 dark:bg-gray-900/20 p-3 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"px-2 py-0.5 bg-gray-600 text-white rounded text-xs font-bold",children:"SELF"}),a.jsx("span",{className:"font-semibold text-sm",children:"본인"})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"자신의 데이터만 접근 가능 (고객사 사용자 기본값)"})]})]})]})},{title:"개별 권한",content:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"\uD83D\uDD27 개별 권한 설정"}),(0,a.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-600 p-4 rounded",children:[a.jsx("h5",{className:"font-bold text-orange-900 dark:text-orange-200 mb-2",children:"개별 권한이란?"}),(0,a.jsxs)("p",{className:"text-orange-800 dark:text-orange-300 text-sm",children:["특정 사용자에게만 ",a.jsx("strong",{children:"추가 권한을 부여"}),"하거나 ",a.jsx("strong",{children:"일부 권한을 제한"}),"할 수 있는 기능입니다."]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"\uD83D\uDCDD 개별 권한 설정 방법"}),(0,a.jsxs)("ol",{className:"text-sm space-y-2",children:[a.jsx("li",{children:'1. 액션 컬럼에서 "개별 권한 설정" 버튼 클릭'}),a.jsx("li",{children:"2. 권한 설정 모달에서 권한 코드 선택"}),a.jsx("li",{children:"3. 권한 부여(Grant) 또는 거부(Deny) 선택"}),a.jsx("li",{children:"4. 저장 버튼 클릭"})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"\uD83C\uDFAF 권한 적용 순서"}),(0,a.jsxs)("ol",{className:"text-sm space-y-2",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-bold text-blue-600",children:"1."}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"개별 권한"})," (최우선)",a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"특정 사용자에게 설정한 권한"})]})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-bold text-blue-600",children:"2."}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"커스텀 역할 권한"}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"할당된 커스텀 역할의 권한"})]})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-bold text-blue-600",children:"3."}),(0,a.jsxs)("div",{children:[a.jsx("strong",{children:"시스템 역할 권한"})," (기본값)",a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"ORG_ADMIN, OPERATOR 등의 기본 권한"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-semibold",children:"사용 예시"}),(0,a.jsxs)("div",{className:"border-l-4 border-green-500 bg-green-50 dark:bg-green-900/20 p-3 rounded",children:[a.jsx("strong",{className:"text-green-700 dark:text-green-400 text-sm",children:"예시 1: 추가 권한 부여"}),a.jsx("p",{className:"text-sm mt-1",children:"일반 OPERATOR에게 보고서 승인 권한 추가"})]}),(0,a.jsxs)("div",{className:"border-l-4 border-red-500 bg-red-50 dark:bg-red-900/20 p-3 rounded",children:[a.jsx("strong",{className:"text-red-700 dark:text-red-400 text-sm",children:"예시 2: 권한 제한"}),a.jsx("p",{className:"text-sm mt-1",children:"특정 관리자의 삭제 권한만 제한"})]})]})]})},{title:"vs 사용자 관리",content:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"\uD83D\uDD04 권한 관리 vs 사용자 관리"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"border-2 border-purple-300 dark:border-purple-700 rounded-lg p-4",children:[(0,a.jsxs)("h5",{className:"font-bold text-purple-900 dark:text-purple-200 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83D\uDD10"}),"권한 관리 (이 페이지)"]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/30 p-2 rounded",children:[a.jsx("strong",{children:"목적:"})," 세부 권한 설정"]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("strong",{children:"주요 기능:"}),(0,a.jsxs)("ul",{className:"ml-4 space-y-1",children:[a.jsx("li",{children:"• 커스텀 역할 할당"}),a.jsx("li",{children:"• 접근 범위 조정"}),a.jsx("li",{children:"• 개별 권한 설정"})]})]})]})]}),(0,a.jsxs)("div",{className:"border-2 border-blue-300 dark:border-blue-700 rounded-lg p-4",children:[(0,a.jsxs)("h5",{className:"font-bold text-blue-900 dark:text-blue-200 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83D\uDC65"}),"사용자 관리"]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-2 rounded",children:[a.jsx("strong",{children:"목적:"})," 계정 생명주기 관리"]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("strong",{children:"주요 기능:"}),(0,a.jsxs)("ul",{className:"ml-4 space-y-1",children:[a.jsx("li",{children:"• 가입 승인/거부"}),a.jsx("li",{children:"• 사용자 삭제"}),a.jsx("li",{children:"• 시스템 역할 변경"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"\uD83C\uDFAF 권장 워크플로우"}),(0,a.jsxs)("ol",{className:"text-sm space-y-2",children:[(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"1단계:"})," 사용자 관리에서 가입 승인 및 시스템 역할 설정"]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"2단계:"})," 기본 권한으로 충분하면 완료"]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"3단계:"})," 추가 권한 필요 시 권한 관리에서 커스텀 역할 할당"]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"4단계:"})," 필요시 개별 권한 세부 조정"]})]})]})]})}]})]})]})}function h({user:e,onClose:s,onSuccess:r}){let[l,d]=(0,t.useState)({}),[n,i]=(0,t.useState)(!0),[c,x]=(0,t.useState)(!1),o=async()=>{x(!0);try{let s=Object.entries(l).map(([e,s])=>({permissionCode:e,granted:s})),a=await fetch(`/api/users/${e.id}/permissions`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:s})});if(a.ok)alert("권한이 저장되었습니다."),r();else{let e=await a.json();alert(e.error||"권한 저장 실패")}}catch(e){alert("권한 저장 중 오류가 발생했습니다.")}finally{x(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["개별 권한 설정: ",e.name]}),n?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"로딩 중..."}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded",children:a.jsx("p",{className:"text-sm text-blue-800",children:"\uD83D\uDCA1 개별 권한은 역할 권한보다 우선 적용됩니다. 특정 권한만 추가하거나 제거할 때 사용하세요."})}),a.jsx("div",{className:"space-y-4 mb-6",children:[{name:"고객사 관리",permissions:[{code:"customer.view",name:"고객사 조회"},{code:"customer.create",name:"고객사 등록"},{code:"customer.update",name:"고객사 수정"},{code:"customer.delete",name:"고객사 삭제"}]},{name:"측정 데이터",permissions:[{code:"measurement.view",name:"측정 데이터 조회"},{code:"measurement.create",name:"측정 데이터 입력"},{code:"measurement.update",name:"측정 데이터 수정"},{code:"measurement.delete",name:"측정 데이터 삭제"}]},{name:"사용자 관리",permissions:[{code:"user.view",name:"사용자 조회"},{code:"user.create",name:"사용자 등록"},{code:"user.update",name:"사용자 수정"},{code:"user.delete",name:"사용자 삭제"}]}].map(e=>(0,a.jsxs)("div",{className:"border rounded p-4",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:e.name}),a.jsx("div",{className:"space-y-2",children:e.permissions.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[a.jsx("input",{type:"checkbox",checked:l[e.code]||!1,onChange:s=>{d({...l,[e.code]:s.target.checked})},className:"rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:e.name})]},e.code))})]},e.name))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:s,className:"flex-1 px-4 py-2 border rounded hover:bg-gray-50",disabled:c,children:"취소"}),a.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",disabled:c,children:c?"저장 중...":"저장"})]})]})]})})}},62993:(e,s,r)=>{"use strict";r.d(s,{Z:()=>n});var a=r(10326),t=r(77109),l=r(35047),d=r(17577);function n(){let{data:e}=(0,t.useSession)();(0,l.useRouter)();let[s,r]=(0,d.useState)(!1),n=e?.user?.name||"",i=e?.user?.email||"";return a.jsx("header",{className:"h-16 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 sticky top-0 z-40",children:(0,a.jsxs)("div",{className:"mx-auto h-full px-6 flex items-center justify-between",children:[a.jsx("div",{children:a.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"시스템 관리자"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>r(!s),className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center text-white font-semibold",children:n.charAt(0).toUpperCase()}),a.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n}),a.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>r(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:i})]}),a.jsx("div",{className:"py-1",children:a.jsx("button",{onClick:()=>{sessionStorage.removeItem("viewAsOrganization"),sessionStorage.removeItem("viewAsCustomer"),(0,t.signOut)({callbackUrl:"/login"})},className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700",children:"로그아웃"})})]})]})]})]})})}},43150:(e,s,r)=>{"use strict";r.d(s,{Z:()=>l});var a=r(10326),t=r(17577);function l({isOpen:e,onClose:s,title:r,sections:l}){let[d,n]=(0,t.useState)(0);return e?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:s}),(0,a.jsxs)("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center text-2xl",children:"\uD83D\uDCDA"}),a.jsx("h3",{className:"text-xl font-bold text-white",children:r})]}),a.jsx("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),l.length>1&&a.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:a.jsx("nav",{className:"flex -mb-px overflow-x-auto",children:l.map((e,s)=>a.jsx("button",{onClick:()=>n(s),className:`px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 transition-colors ${d===s?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:e.title},s))})}),a.jsx("div",{className:"px-6 py-6 max-h-[70vh] overflow-y-auto",children:a.jsx("div",{className:"prose dark:prose-invert max-w-none",children:"string"==typeof l[d].content?a.jsx("div",{dangerouslySetInnerHTML:{__html:l[d].content}}):l[d].content})}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-4 flex justify-between items-center",children:[a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\uD83D\uDCA1 추가 도움이 필요하시면 시스템 관리자에게 문의하세요."}),a.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"닫기"})]})]})]})}):null}},99837:(e,s,r)=>{"use strict";r.d(s,{Z:()=>d});var a=r(10326);r(17577);let t={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},l={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function d({variant:e="primary",size:s="md",className:r="",...d}){return a.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ${t[e]} ${l[s]} ${r}`,...d})}},89175:(e,s,r)=>{"use strict";r.d(s,{Z:()=>t});var a=r(10326);function t({className:e="",...s}){return a.jsx("input",{className:`rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20 ${e}`,...s})}r(17577)},4267:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\admin\permissions\page.tsx#default`)},73881:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});var a=r(66621);let t=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),a=s.X(0,[8948,9975,6621,5736],()=>r(62733));module.exports=a})();