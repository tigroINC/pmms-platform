(()=>{var e={};e.id=5964,e.ids=[5964],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},98031:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>u,tree:()=>c}),t(22021),t(92553),t(35866);var a=t(23191),r=t(88716),l=t(37922),i=t.n(l),n=t(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let c=["",{children:["masters",{children:["limits",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,22021)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\masters\\limits\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["C:\\Users\\User\\boaz\\frontend\\src\\app\\masters\\limits\\page.tsx"],o="/masters/limits/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/masters/limits/page",pathname:"/masters/limits",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},28450:(e,s,t)=>{Promise.resolve().then(t.bind(t,60872))},60872:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(10326),r=t(17577),l=t(21120),i=t(93746),n=t(91245),d=t(20872),c=t(99837),x=t(89175),o=t(94585),m=t(2102);function u({isOpen:e,onClose:s,onSuccess:t,limit:l}){let{list:o}=(0,i.n)(),{items:u}=(0,d.F)(),[g,h]=(0,r.useState)(""),[p,y]=(0,r.useState)(""),[b,j]=(0,r.useState)(""),[f,k]=(0,r.useState)(""),[N,v]=(0,r.useState)("일반지역"),[w,C]=(0,r.useState)(!1),{list:D}=(0,n.D)(g||void 0),S=u.filter(e=>("오염물질"===e.category||"채취환경"===e.category||"보조항목"===e.category)&&!1!==e.isActive).sort((e,s)=>{let t="오염물질"===e.category,a="오염물질"===s.category;return t&&!a?-1:!t&&a?1:e.name.localeCompare(s.name)}),T=async e=>{if(e.preventDefault(),!b||!f){alert("항목과 기준값을 입력해주세요.");return}C(!0);try{if(l?.id){await fetch(`/api/limits?id=${l.id}`,{method:"DELETE"});let e={limits:[{itemKey:b,limit:parseFloat(f)}],customerId:g||"",stackId:p||"",region:N||"",createdBy:"admin"},a=await fetch("/api/limits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)alert("수정되었습니다."),t(),s();else{let e=await a.json();alert(e.error||"수정 실패")}}else{let e={limits:[{itemKey:b,limit:parseFloat(f)}],customerId:g||"",stackId:p||"",region:N||"",createdBy:"admin"},a=await fetch("/api/limits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)alert("저장되었습니다."),t(),s();else{let e=await a.json();alert(e.error||"저장 실패")}}}catch(e){alert("저장 중 오류가 발생했습니다.")}finally{C(!1)}};return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b dark:border-gray-700",children:[a.jsx("h2",{className:"text-xl font-semibold",children:l?"배출허용기준 수정":"배출허용기준 추가"}),a.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:T,className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"고객사"}),(0,a.jsxs)(m.Z,{value:g,onChange:e=>{h(e.target.value),y("")},children:[a.jsx("option",{value:"",children:"전체"}),o.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"굴뚝"}),(0,a.jsxs)(m.Z,{value:p,onChange:e=>y(e.target.value),disabled:!g,children:[a.jsx("option",{value:"",children:"전체"}),D.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"측정항목 *"}),(0,a.jsxs)(m.Z,{value:b,onChange:e=>j(e.target.value),required:!0,children:[a.jsx("option",{value:"",children:"선택하세요"}),S.map(e=>(0,a.jsxs)("option",{value:e.key,children:[e.name," (",e.key,")"]},e.key))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"기준값 *"}),a.jsx(x.Z,{type:"number",step:"0.01",value:f,onChange:e=>k(e.target.value),placeholder:"예: 20",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"지역 구분"}),(0,a.jsxs)(m.Z,{value:N,onChange:e=>v(e.target.value),children:[a.jsx("option",{value:"",children:"전체"}),a.jsx("option",{value:"일반지역",children:"일반지역"}),a.jsx("option",{value:"특별대책지역",children:"특별대책지역"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end pt-4",children:[a.jsx(c.Z,{type:"button",variant:"secondary",onClick:s,children:"취소"}),a.jsx(c.Z,{type:"submit",disabled:w,children:w?"저장 중...":"저장"})]})]})]})}):null}function g({isOpen:e,onClose:s}){return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b dark:border-gray-700",children:[a.jsx("h2",{className:"text-xl font-semibold flex items-center gap-2",children:"❓ 배출허용기준 관리 도움말"}),a.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCCB 컬럼 설명"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"범위:"}),a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"배출허용기준이 어느 수준에서 적용되는지 표시 (전체/고객사별/굴뚝별)"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"고객사:"}),a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:'실제 어느 고객사에 적용되는지 표시 (범위가 "전체"면 "전체" 표시)'})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"굴뚝:"}),a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"특정 굴뚝에만 적용되는 경우 굴뚝명 표시"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83C\uDFAF 범위 종류"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 whitespace-nowrap",children:"공통"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:"공통 기준"}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"모든 고객사, 모든 굴뚝에 적용되는 기본 기준입니다."})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 whitespace-nowrap",children:"고객사별"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:"고객사별 기준"}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"특정 고객사의 모든 굴뚝에 적용됩니다. (예: A기업 전체)"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 whitespace-nowrap",children:"굴뚝별"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:"굴뚝별 기준"}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"특정 고객사의 특정 굴뚝에만 적용됩니다. (예: A기업 S-001)"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"⚡ 적용 우선순위 (높음 → 낮음)"}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/10 rounded-lg p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:"1순위"}),a.jsx("span",{className:"text-sm font-medium",children:"굴뚝별 기준"}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(특정 굴뚝에만 적용)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:"2순위"}),a.jsx("span",{className:"text-sm font-medium",children:"고객사별 기준"}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(해당 고객사 전체)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:"3순위"}),a.jsx("span",{className:"text-sm font-medium",children:"공통 기준"}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(모든 고객사/굴뚝)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-200 text-gray-600 dark:bg-gray-800 dark:text-gray-400",children:"기본"}),a.jsx("span",{className:"text-sm font-medium",children:"기본 기준"}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"(측정항목 테이블의 기본값)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCA1 사용 예시"}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 space-y-2 text-sm",children:[a.jsx("div",{className:"font-medium",children:"시나리오: 먼지(PM) 배출허용기준"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs text-gray-600 dark:text-gray-400 pl-4",children:[a.jsx("div",{children:"• 일반 기준: 20 mg/Sm\xb3 (공통 기준)"}),a.jsx("div",{children:"• A기업: 15 mg/Sm\xb3 (고객사별 기준 - 특별관리 대상)"}),a.jsx("div",{children:"• A기업 S-001: 18 mg/Sm\xb3 (굴뚝별 기준 - 노후화로 완화)"})]}),(0,a.jsxs)("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[a.jsx("div",{className:"font-medium text-xs",children:"적용 결과:"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 pl-4 space-y-1",children:[(0,a.jsxs)("div",{children:["→ A기업 S-001: ",a.jsx("strong",{children:"18"})," (굴뚝별 우선)"]}),(0,a.jsxs)("div",{children:["→ A기업 S-002: ",a.jsx("strong",{children:"15"})," (고객사별 적용)"]}),(0,a.jsxs)("div",{children:["→ B기업: ",a.jsx("strong",{children:"20"})," (공통 기준 적용)"]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCCC 안내사항"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[a.jsx("li",{children:"특별대책지역은 일반지역 기준의 80%가 자동 계산됩니다"}),a.jsx("li",{children:"비활성화된 기준은 적용되지 않습니다"}),a.jsx("li",{children:"관리자만 추가/수정/삭제가 가능합니다"}),a.jsx("li",{children:"수정 시 고객사, 굴뚝, 항목을 모두 변경할 수 있습니다"})]})]})]}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(c.Z,{onClick:s,children:"확인"})})]})}):null}var h=t(32743);function p(){let{user:e}=(0,l.a)(),s=e?.role,{list:t}=(0,i.n)(),{items:m}=(0,d.F)(),[p,y]=(0,r.useState)([]),[b,j]=(0,r.useState)(!1),[f,k]=(0,r.useState)(""),[N,v]=(0,r.useState)("all"),[w,C]=(0,r.useState)(!1),[D,S]=(0,r.useState)(!1),[T,A]=(0,r.useState)(null),[I,$]=(0,r.useState)(!1),[E,_]=(0,r.useState)(!1),{list:P}=(0,n.D)(),U=async()=>{j(!0);try{let e=await fetch("/api/limits"),s=await e.json();y(Array.isArray(s.data)?s.data:[])}catch(e){}finally{j(!1)}},R=e=>{let s=m.find(s=>s.key===e);return s?s.name:e},K=e=>{let s=m.find(s=>s.key===e);return s?s.unit:"-"},O=e=>{let s=m.find(s=>s.key===e);return s?s.category:""},M=e=>{let s=m.find(s=>s.key===e);return s?s.order??0:0},Z=e=>{if(!e)return"전체";let s=t.find(s=>s.id===e);return s?s.name:e},F=e=>{if(!e)return"-";let s=P.find(s=>s.id===e);return s?s.name:e},L=e=>e.stackId?"굴뚝별":e.customerId?"고객사별":"전체",z=(0,r.useMemo)(()=>p,[p]),q=(0,r.useMemo)(()=>{let e=z.filter(e=>{let s=!!w||!1!==e.isActive,t=!0;if("global"===N?t=!e.customerId&&!e.stackId:"customer"===N?t=!!e.customerId&&!e.stackId:"stack"===N&&(t=!!e.stackId),!f)return s&&t;let a=f.toLowerCase(),r=R(e.itemKey).toLowerCase().includes(a)||e.itemKey.toLowerCase().includes(a)||Z(e.customerId).toLowerCase().includes(a)||F(e.stackId).toLowerCase().includes(a);return s&&t&&r}),s=(e,s)=>{let t=M(e.itemKey),a=M(s.itemKey);return 0===t&&0!==a?1:0!==t&&0===a?-1:t===a?R(e.itemKey).localeCompare(R(s.itemKey)):t-a},t=e.filter(e=>"오염물질"===O(e.itemKey)),a=e.filter(e=>"채취환경"===O(e.itemKey)),r=e.filter(e=>{let s=O(e.itemKey);return"오염물질"!==s&&"채취환경"!==s});return t.sort(s),a.sort(s),r.sort(s),[...t,...a,...r]},[z,f,N,w,m]),G=e=>{A(e),S(!0)},B=()=>{S(!1),A(null)},J=async e=>{try{let s=await fetch(`/api/limits/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!e.isActive})});if(!s.ok){let e=await s.json();throw Error(e.error||"상태 변경 실패")}U()}catch(e){alert(e.message||"상태 변경 중 오류가 발생했습니다.")}},V=async e=>{if(confirm(`${R(e.itemKey)} 기준을 삭제하시겠습니까?`))try{let s=await fetch(`/api/limits?id=${e.id}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"삭제 실패")}alert("삭제되었습니다."),U()}catch(e){alert(e.message||"삭제 중 오류가 발생했습니다.")}},H=async e=>{try{let s=await e.text(),t=await fetch("/api/limits/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({csvText:s})}),a=await t.json();if(t.ok)return U(),{success:!0,message:a.message||"업로드 성공",count:a.count};return{success:!1,message:a.error||"업로드 실패"}}catch(e){return{success:!1,message:e.message||"업로드 중 오류가 발생했습니다."}}};return(0,a.jsxs)("section",{className:"space-y-3",children:[a.jsx("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[a.jsx("h1",{className:"text-lg font-semibold whitespace-nowrap mb-1.5",children:"배출허용기준 관리"}),a.jsx("span",{className:"text-gray-300 dark:text-gray-600 mb-1.5",children:"|"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"검색"}),a.jsx(x.Z,{className:"text-sm h-8",style:{width:"352px",minWidth:"352px"},value:f,onChange:e=>k(e.target.value),placeholder:"항목명, 항목코드, 고객사, 굴뚝 등"})]}),(0,a.jsxs)("div",{className:"flex gap-1.5 mb-1.5",children:[a.jsx("button",{onClick:()=>v("all"),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${"all"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"모두보기"}),a.jsx("button",{onClick:()=>v("global"),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${"global"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"공통기준"}),a.jsx("button",{onClick:()=>v("customer"),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${"customer"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"고객사별"}),a.jsx("button",{onClick:()=>v("stack"),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${"stack"===N?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"굴뚝별"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-1.5 text-xs cursor-pointer mb-1.5 whitespace-nowrap ml-auto",children:[a.jsx("input",{type:"checkbox",checked:w,onChange:e=>C(e.target.checked),className:"rounded"}),"비활성 표시"]}),(0,a.jsxs)("div",{className:"flex gap-1.5 mb-1.5",children:[a.jsx(c.Z,{size:"sm",variant:"secondary",onClick:()=>$(!0),children:"❓ 도움말"}),("SUPER_ADMIN"===s||"ORG_ADMIN"===s)&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(c.Z,{size:"sm",variant:"secondary",onClick:()=>{let e=new Blob(["\uFEFF"+[["범위","고객사","굴뚝","구분","항목코드","항목명","단위","설정기준","지역구분"],...q.map(e=>[L(e),Z(e.customerId),F(e.stackId),O(e.itemKey)||"-",e.itemKey,R(e.itemKey),K(e.itemKey),e.limit,e.region||"-"])].map(e=>e.map(e=>`"${String(e??"").replace(/"/g,'""')}"`).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download=`배출허용기준_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},children:"Excel"}),a.jsx(c.Z,{size:"sm",variant:"secondary",onClick:()=>_(!0),children:"일괄업로드"}),a.jsx(c.Z,{size:"sm",onClick:()=>{A(null),S(!0)},children:"+ 신규 추가"})]})]})]})}),a.jsx("div",{className:"hidden md:block rounded-lg border overflow-x-auto max-h-[calc(100vh-180px)] overflow-y-auto",children:(0,a.jsxs)(o.iA,{className:"min-w-[1200px]",children:[a.jsx(o.hr,{className:"bg-gray-50 dark:bg-white/10 sticky top-0 z-10",children:(0,a.jsxs)(o.Tr,{children:[a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"상태"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"범위"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"고객사"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"굴뚝"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"구분"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"항목코드"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"항목명"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"단위"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"설정기준"}),a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"지역구분"}),("SUPER_ADMIN"===s||"ORG_ADMIN"===s)&&a.jsx(o.Th,{className:"bg-gray-50 dark:bg-gray-800",children:"액션"})]})}),a.jsx(o.p3,{children:0===q.length?a.jsx(o.Tr,{children:a.jsx(o.Td,{colSpan:"SUPER_ADMIN"===s||"ORG_ADMIN"===s?11:10,className:"text-center text-gray-500 py-8",children:"설정된 배출허용기준이 없습니다"})}):q.map(e=>{let t=!1!==e.isActive;return(0,a.jsxs)(o.Tr,{className:t?"":"opacity-50 bg-gray-50 dark:bg-gray-900/20",children:[a.jsx(o.Td,{children:t?a.jsx("span",{className:"inline-block px-2 py-0.5 rounded bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300 text-xs",children:"활성"}):a.jsx("span",{className:"inline-block px-2 py-0.5 rounded bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 text-xs",children:"비활성"})}),a.jsx(o.Td,{children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.stackId?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":e.customerId?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:L(e)})}),a.jsx(o.Td,{children:Z(e.customerId)}),a.jsx(o.Td,{children:F(e.stackId)}),a.jsx(o.Td,{children:a.jsx("span",{className:`px-2 py-1 rounded text-xs ${"오염물질"===O(e.itemKey)?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"채취환경"===O(e.itemKey)?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:O(e.itemKey)||"-"})}),a.jsx(o.Td,{className:"font-mono text-xs",children:e.itemKey}),(0,a.jsxs)(o.Td,{className:"font-medium",children:[R(e.itemKey),e.isDefault&&a.jsx("span",{className:"ml-2 inline-block px-2 py-0.5 rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300 text-xs",children:"기본값"})]}),a.jsx(o.Td,{className:"text-center",children:K(e.itemKey)}),a.jsx(o.Td,{className:"font-semibold",children:e.limit}),a.jsx(o.Td,{className:"text-sm",children:e.region||"-"}),("SUPER_ADMIN"===s||"ORG_ADMIN"===s)&&a.jsx(o.Td,{children:(0,a.jsxs)("div",{className:"flex gap-2 whitespace-nowrap",children:[a.jsx("button",{onClick:()=>G(e),className:"text-xs text-green-600 hover:underline",children:"수정"}),a.jsx("button",{onClick:()=>J(e),className:"text-xs text-blue-600 hover:underline",children:t?"비활성화":"활성화"}),!t&&a.jsx("button",{onClick:()=>V(e),className:"text-xs text-red-600 hover:underline",children:"삭제"})]})})]},e.id)})})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:0===q.length?a.jsx("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-6 text-center text-gray-500",children:"설정된 배출허용기준이 없습니다"}):q.map(e=>{let t=!1!==e.isActive;return(0,a.jsxs)("div",{className:`rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2 ${t?"":"opacity-50"}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[a.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs ${t?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"}`,children:t?"활성":"비활성"}),a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.stackId?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300":e.customerId?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:L(e)})]}),("SUPER_ADMIN"===s||"ORG_ADMIN"===s)&&(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>G(e),className:"text-xs text-blue-600 hover:underline",children:"수정"}),a.jsx("button",{onClick:()=>J(e),className:"text-xs text-blue-600 hover:underline",children:t?"비활성화":"활성화"}),!t&&a.jsx("button",{onClick:()=>V(e),className:"text-xs text-gray-600 hover:underline",children:"삭제"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCD 고객사:"})," ",Z(e.customerId)]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFED 굴뚝:"})," ",F(e.stackId)]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFF7️ 구분:"})," ",a.jsx("span",{className:`px-2 py-1 rounded text-xs ${"오염물질"===O(e.itemKey)?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"채취환경"===O(e.itemKey)?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:O(e.itemKey)||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCB 코드:"})," ",e.itemKey]}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCDD 항목:"})," ",R(e.itemKey),e.isDefault&&a.jsx("span",{className:"ml-2 inline-block px-2 py-0.5 rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300 text-xs",children:"기본값"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCF 단위:"})," ",K(e.itemKey)]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"⚠️ 기준:"})," ",a.jsx("span",{className:"font-semibold",children:e.limit})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-gray-500",children:"\uD83D\uDDFA️ 지역:"})," ",e.region||"-"]})]})]},e.id)})}),a.jsx(u,{isOpen:D,onClose:B,onSuccess:()=>{U(),B()},limit:T}),a.jsx(g,{isOpen:I,onClose:()=>$(!1)}),a.jsx(h.Z,{isOpen:E,onClose:()=>_(!1),title:"배출허용기준 일괄업로드",templateHeaders:["범위","고객사코드","굴뚝번호","항목코드","설정기준","지역구분"],exampleRow:["공통","","","dust","20","일반지역"],templateFileName:"배출허용기준_일괄업로드_양식.csv",onUpload:H,parseInstructions:"범위는 '공통', '고객사별', '굴뚝별' 중 하나입니다. 고객사별은 고객사코드 필수, 굴뚝별은 고객사코드와 굴뚝번호 모두 필수입니다."})]})}},32743:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(10326),r=t(17577),l=t(99837);function i({isOpen:e,onClose:s,title:t,templateHeaders:i,exampleRow:n,templateFileName:d,onUpload:c,parseInstructions:x="양식에 맞게 작성한 CSV 파일을 업로드하세요."}){let[o,m]=(0,r.useState)(null),[u,g]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),y=async()=>{if(!o){p("파일을 선택해주세요.");return}g(!0),p("");try{let e=await c(o);if(e.success){let s=e.message||"업로드 완료";p(`✅ ${s}`),m(null)}else p(`❌ ${e.message||"업로드 실패"}`)}catch(e){p(`❌ 오류: ${e.message||"업로드 중 문제가 발생했습니다."}`)}finally{g(!1)}},b=()=>{u||(m(null),p(""),s())};return e?a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:b,children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-bold",children:t}),a.jsx("button",{onClick:b,disabled:u,className:"text-gray-500 hover:text-gray-700 disabled:opacity-50",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded",children:[a.jsx("p",{className:"font-medium mb-1",children:"\uD83D\uDCCB 업로드 절차"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[a.jsx("li",{children:'아래 "업로드 양식 다운로드" 버튼을 클릭하여 CSV 양식을 다운로드합니다.'}),a.jsx("li",{children:"다운로드한 양식에 데이터를 입력합니다. (예시 행 참고)"}),a.jsx("li",{children:'"파일 선택" 버튼을 클릭하여 작성한 CSV 파일을 선택합니다.'}),a.jsx("li",{children:'"업로드" 버튼을 클릭하여 데이터를 등록합니다.'})]})]}),a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:x}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[a.jsx("div",{className:"flex gap-2",children:a.jsx(l.Z,{variant:"secondary",onClick:()=>{let e=new Blob(["\uFEFF"+i.map(e=>`"${e}"`).join(",")+"\n"+n.map(e=>`"${e}"`).join(",")+"\n"],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download=d,t.click(),URL.revokeObjectURL(s)},disabled:u,className:"flex-1",children:"\uD83D\uDCE5 업로드 양식 다운로드"})}),a.jsx("div",{className:"flex gap-2",children:(0,a.jsxs)("label",{className:"flex-1",children:[a.jsx("div",{className:`px-4 py-2 border-2 border-dashed rounded cursor-pointer text-center transition-colors ${o?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400"} ${u?"opacity-50 cursor-not-allowed":""}`,children:o?(0,a.jsxs)("span",{className:"text-sm",children:["\uD83D\uDCC4 ",o.name]}):a.jsx("span",{className:"text-sm text-gray-500",children:"\uD83D\uDCC1 파일 선택 (CSV)"})}),a.jsx("input",{type:"file",accept:".csv",className:"hidden",onChange:e=>{let s=e.target.files?.[0];s&&(m(s),p(""))},disabled:u})]})}),a.jsx(l.Z,{onClick:y,disabled:!o||u,className:"w-full",children:u?"업로드 중...":"업로드"})]}),h&&a.jsx("div",{className:`text-sm p-4 rounded border-2 ${h.startsWith("✅")?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-500":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-500"}`,children:(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[a.jsx("pre",{className:"whitespace-pre-wrap font-sans",children:h}),a.jsx(l.Z,{size:"sm",onClick:()=>{p(""),b()},className:"self-end",children:"확인"})]})})]}),!h&&a.jsx("div",{className:"mt-6 flex justify-end gap-2",children:a.jsx(l.Z,{variant:"secondary",onClick:b,disabled:u,children:"닫기"})})]})}):null}},99837:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(10326);t(17577);let r={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},l={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i({variant:e="primary",size:s="md",className:t="",...i}){return a.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ${r[e]} ${l[s]} ${t}`,...i})}},89175:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});var a=t(10326);function r({className:e="",...s}){return a.jsx("input",{className:`rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20 ${e}`,...s})}t(17577)},2102:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});var a=t(10326);function r({className:e="",children:s,...t}){return a.jsx("select",{className:`w-full rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20 ${e}`,...t,children:s})}t(17577)},94585:(e,s,t)=>{"use strict";t.d(s,{Td:()=>c,Th:()=>d,Tr:()=>n,hr:()=>l,iA:()=>r,p3:()=>i});var a=t(10326);function r({className:e="",...s}){return a.jsx("table",{className:`w-full text-sm border-collapse ${e}`,...s})}function l(e){return a.jsx("thead",{...e})}function i(e){return a.jsx("tbody",{...e})}function n(e){return a.jsx("tr",{className:"border-b last:border-0 border-gray-200 dark:border-white/10",...e})}function d({className:e="",...s}){return a.jsx("th",{className:`text-left py-2 px-3 font-medium text-gray-600 dark:text-gray-300 ${e}`,...s})}function c({className:e="",...s}){return a.jsx("td",{className:`py-2 px-3 ${e}`,...s})}t(17577)},93746:(e,s,t)=>{"use strict";t.d(s,{n:()=>i});var a=t(17577),r=t(33326),l=t(77109);function i(){let[e,s]=(0,a.useState)([]),{selectedOrg:t}=(0,r.o)(),{data:i}=(0,l.useSession)(),n=i?.user?.role,d=i?.user?.customerId,c="CUSTOMER_ADMIN"===n||"CUSTOMER_USER"===n;return{list:e,refetch:(0,a.useCallback)(()=>{if(c&&d){fetch(`/api/customers/${d}`).then(e=>e.json()).then(e=>{let t=e.customer||e.data;s(t?[t]:[])}).catch(e=>{s([])});return}if(!t?.id){s([]);return}let e=new URLSearchParams;e.append("organizationId",t.id),e.append("tab","all"),fetch(`/api/customers?${e.toString()}`).then(e=>e.json()).then(e=>{s(e.customers||e.data||[])}).catch(e=>{s([])})},[t,c,d])}}},20872:(e,s,t)=>{"use strict";t.d(s,{F:()=>i,r:()=>n});var a=t(17577),r=t(33326),l=t(77109);function i(){let[e,s]=(0,a.useState)([]);return{items:e}}function n(e={}){let{customerId:s,stack:t,stacks:i,itemKey:n,page:d=1,pageSize:c=50,sort:x,start:o,end:m}=e,[u,g]=(0,a.useState)([]),[h,p]=(0,a.useState)(0),{selectedOrg:y}=(0,r.o)(),{data:b}=(0,l.useSession)(),j=b?.user?.role,f="CUSTOMER_ADMIN"===j||"CUSTOMER_USER"===j;(0,a.useEffect)(()=>{let e=!0,a=new AbortController;if(!f&&!y?.id){g([]);return}let r=new URLSearchParams;return s&&r.set("customerId",s),i&&i.length?i.forEach(e=>r.append("stack",e)):t&&r.set("stack",t),n&&r.set("itemKey",n),o&&r.set("start",o),m&&r.set("end",m),y?.id&&r.set("organizationId",y.id),fetch(`/api/measurements?${r.toString()}`,{signal:a.signal}).then(e=>e.json()).then(s=>{e&&g(Array.isArray(s.measurements)?s.measurements:Array.isArray(s.data)?s.data:[])}).catch(s=>{s.name,e&&g([])}),()=>{e=!1,a.abort()}},[s,t,(i||[]).join("|"),n,o,m,h,y,f]);let k=(0,a.useMemo)(()=>{if(!x)return u;let{key:e,dir:s}=x,t=[...u];return t.sort((t,a)=>{let r=t[e],l=a[e];return r<l?"asc"===s?-1:1:r>l?"asc"===s?1:-1:0}),t},[u,x]),N=k.length,v=(d-1)*c;return{data:c>=999999?k:k.slice(v,v+c),total:N,page:d,pageSize:c,mutate:()=>p(e=>e+1)}}},91245:(e,s,t)=>{"use strict";t.d(s,{D:()=>l});var a=t(17577),r=t(33326);function l(e){let[s,t]=(0,a.useState)([]),{selectedOrg:l}=(0,r.o)();return{list:s}}},22021:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\masters\limits\page.tsx#default`)},73881:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var a=t(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[8948,9975,6621,5736],()=>t(98031));module.exports=a})();