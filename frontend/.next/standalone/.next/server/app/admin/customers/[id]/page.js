(()=>{var e={};e.id=1201,e.ids=[1201],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},80993:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>c,routeModule:()=>g,tree:()=>x}),s(16696),s(92553),s(35866);var a=s(23191),r=s(88716),l=s(37922),i=s.n(l),d=s(95231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(t,n);let x=["",{children:["admin",{children:["customers",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,16696)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\admin\\customers\\[id]\\page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\User\\boaz\\frontend\\src\\app\\admin\\customers\\[id]\\page.tsx"],o="/admin/customers/[id]/page",m={require:s,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/customers/[id]/page",pathname:"/admin/customers/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:x}})},31297:(e,t,s)=>{Promise.resolve().then(s.bind(s,50324))},50324:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(10326),r=s(17577),l=s(77109),i=s(35047),d=s(99837),n=s(62993),x=s(90434);function c(){let{data:e,status:t}=(0,l.useSession)(),s=(0,i.useRouter)(),c=(0,i.useParams)(),u=c?.id,[h,p]=(0,r.useState)(null),[y,b]=(0,r.useState)(!0),[j,v]=(0,r.useState)(!1),[f,N]=(0,r.useState)(""),[k,w]=(0,r.useState)(!1),[C,A]=(0,r.useState)({}),P=async()=>{try{b(!0);let e=await fetch(`/api/customers/${u}`),t=await e.json();e.ok?p(t.customer):(alert(t.error||"고객회사 정보를 불러오는데 실패했습니다."),s.push("/admin/customers"))}catch(e){alert("고객회사 정보를 불러오는데 실패했습니다."),s.push("/admin/customers")}finally{b(!1)}},_=async()=>{if(!f){alert("새 관리자를 선택해주세요.");return}if(confirm("관리자를 변경하시겠습니까?"))try{let e=await fetch(`/api/customers/${u}/change-admin`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({newAdminId:f})}),t=await e.json();e.ok?(alert(t.message),v(!1),P()):alert(t.error||"관리자 변경에 실패했습니다.")}catch(e){alert("관리자 변경 중 오류가 발생했습니다.")}},S=(e,t)=>{A(s=>({...s,[e]:t}))},U=async()=>{if(confirm("고객회사 정보를 수정하시겠습니까?"))try{let e=await fetch(`/api/customers/${u}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}),t=await e.json();e.ok?(alert(t.message),w(!1),P()):alert(t.error||"정보 수정에 실패했습니다.")}catch(e){alert("정보 수정 중 오류가 발생했습니다.")}};if(y||!h)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"text-lg",children:"로딩 중..."})});let T=h.users.find(e=>"CUSTOMER_ADMIN"===e.role),M=h.users.filter(e=>"CUSTOMER_USER"===e.role&&"APPROVED"===e.status);return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[a.jsx(n.Z,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"고객회사 상세"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:h.name})]}),a.jsx(x.default,{href:"/admin/customers",children:a.jsx(d.Z,{children:"← 목록으로"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"회사 정보"}),k?(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(d.Z,{onClick:U,className:"text-sm px-3 py-1 bg-green-600 hover:bg-green-700 text-white",children:"저장"}),a.jsx(d.Z,{onClick:()=>{w(!1),A({})},className:"text-sm px-3 py-1 bg-gray-300 hover:bg-gray-400 text-gray-800",children:"취소"})]}):a.jsx(d.Z,{onClick:()=>{A({name:h?.name,code:h?.code||"",businessNumber:h?.businessNumber||"",fullName:h?.fullName||"",siteType:h?.siteType||"",address:h?.address||"",industry:h?.industry||"",siteCategory:h?.siteCategory||""}),w(!0)},className:"text-sm px-3 py-1",children:"수정"})]}),k?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(g,{label:"고객사명(약칭)",value:C.name||"",onChange:e=>S("name",e),required:!0}),a.jsx(g,{label:"고객사 코드",value:C.code||"",onChange:e=>S("code",e)}),a.jsx(g,{label:"사업자등록번호",value:C.businessNumber||"",onChange:e=>S("businessNumber",e)}),a.jsx(g,{label:"고객사명(정식)",value:C.fullName||"",onChange:e=>S("fullName",e)}),a.jsx(g,{label:"사업장 구분",value:C.siteType||"",onChange:e=>S("siteType",e)}),a.jsx(g,{label:"업종",value:C.industry||"",onChange:e=>S("industry",e)}),a.jsx(g,{label:"사업장 종별",value:C.siteCategory||"",onChange:e=>S("siteCategory",e)}),a.jsx("div",{}),a.jsx(g,{label:"주소",value:C.address||"",onChange:e=>S("address",e),className:"md:col-span-2"})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(o,{label:"고객사명(약칭)",value:h.name}),a.jsx(o,{label:"고객사 코드",value:h.code}),a.jsx(o,{label:"사업자등록번호",value:h.businessNumber}),a.jsx(o,{label:"고객사명(정식)",value:h.fullName}),a.jsx(o,{label:"사업장 구분",value:h.siteType}),a.jsx(o,{label:"업종",value:h.industry}),a.jsx(o,{label:"사업장 종별",value:h.siteCategory}),a.jsx(o,{label:"승인 상태",value:h.isActive?"활성":"승인 대기",valueClassName:h.isActive?"text-green-600":"text-yellow-600"}),a.jsx(o,{label:"주소",value:h.address,className:"md:col-span-2"})]})]}),h.organization&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"소속 환경측정기업"}),a.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:a.jsx("div",{className:"text-lg font-medium text-gray-900 dark:text-white",children:h.organization.name})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"관리자 정보"}),M.length>0&&a.jsx(d.Z,{onClick:()=>v(!j),className:"text-sm px-3 py-1",children:j?"취소":"관리자 변경"})]}),T?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(o,{label:"이름",value:T.name}),a.jsx(o,{label:"이메일",value:T.email}),a.jsx(o,{label:"전화번호",value:T.phone}),a.jsx(o,{label:"부서",value:T.department}),a.jsx(o,{label:"직책",value:T.position}),a.jsx(o,{label:"상태",value:T.isActive?"활성":"비활성",valueClassName:T.isActive?"text-green-600":"text-gray-400"})]}):a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"관리자가 없습니다."}),j&&M.length>0&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"새 관리자 선택"}),(0,a.jsxs)("select",{value:f,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white mb-3",children:[a.jsx("option",{value:"",children:"선택하세요"}),M.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.email,") - ",e.department||"부서 없음"]},e.id))]}),a.jsx(d.Z,{onClick:_,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:"관리자 변경"})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["사용자 목록 (",h.users.length,"명)"]}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"이름"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"이메일"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"역할"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"부서/직책"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"상태"})]})}),a.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:h.users.map(e=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.name}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:e.email}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${"CUSTOMER_ADMIN"===e.role?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:"CUSTOMER_ADMIN"===e.role?"관리자":"사용자"})}),(0,a.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:[e.department||"-"," / ",e.position||"-"]}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${e.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:e.isActive?"활성":"비활성"})})]},e.id))})]})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"통계"}),(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx(m,{label:"사용자 수",value:h._count.users}),a.jsx(m,{label:"굴뚝 수",value:h._count.stacks}),a.jsx(m,{label:"측정 데이터",value:h._count.measurements})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"굴뚝 목록"}),h.stacks.length>0?a.jsx("div",{className:"space-y-2",children:h.stacks.map(e=>(0,a.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),e.code&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["코드: ",e.code]}),a.jsx("div",{className:"text-xs mt-1",children:a.jsx("span",{className:`px-2 py-1 rounded-full ${e.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:e.isActive?"활성":"비활성"})})]},e.id))}):a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"등록된 굴뚝이 없습니다."})]})]})]})]})]})}function o({label:e,value:t,className:s="",valueClassName:r=""}){return(0,a.jsxs)("div",{className:s,children:[a.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:e}),a.jsx("div",{className:`mt-1 text-sm text-gray-900 dark:text-white ${r}`,children:t||"-"})]})}function m({label:e,value:t}){return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:e}),a.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t})]})}function g({label:e,value:t,onChange:s,className:r="",type:l="text",required:i=!1}){return(0,a.jsxs)("div",{className:r,children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e,i&&a.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a.jsx("input",{type:l,value:t,onChange:e=>s(e.target.value),required:i,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}},62993:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(10326),r=s(77109),l=s(35047),i=s(17577);function d(){let{data:e}=(0,r.useSession)();(0,l.useRouter)();let[t,s]=(0,i.useState)(!1),d=e?.user?.name||"",n=e?.user?.email||"";return a.jsx("header",{className:"h-16 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 sticky top-0 z-40",children:(0,a.jsxs)("div",{className:"mx-auto h-full px-6 flex items-center justify-between",children:[a.jsx("div",{children:a.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"시스템 관리자"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>s(!t),className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center text-white font-semibold",children:d.charAt(0).toUpperCase()}),a.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:d}),a.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:d}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:n})]}),a.jsx("div",{className:"py-1",children:a.jsx("button",{onClick:()=>{sessionStorage.removeItem("viewAsOrganization"),sessionStorage.removeItem("viewAsCustomer"),(0,r.signOut)({callbackUrl:"/login"})},className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700",children:"로그아웃"})})]})]})]})]})})}},99837:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(10326);s(17577);let r={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},l={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function i({variant:e="primary",size:t="md",className:s="",...i}){return a.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ${r[e]} ${l[t]} ${s}`,...i})}},16696:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\admin\customers\[id]\page.tsx#default`)},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,9975,6621,5736],()=>s(80993));module.exports=a})();