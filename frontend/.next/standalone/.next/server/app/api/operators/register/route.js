"use strict";(()=>{var e={};e.id=167,e.ids=[167],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},86558:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>R,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var a={};t.r(a),t.d(a,{POST:()=>d});var s=t(49303),i=t(88716),o=t(60670),n=t(87070),p=t(20728),u=t(98691);async function d(e){try{let{businessNumber:r,email:t,password:a,name:s,phone:i,department:o,position:d}=await e.json();if(!r||!t||!a||!s||!i)return n.NextResponse.json({error:"필수 항목을 모두 입력해주세요."},{status:400});let c=await p._.organization.findUnique({where:{businessNumber:r}});if(!c)return n.NextResponse.json({error:"등록되지 않은 환경측정기업입니다. 사업자등록번호를 확인해주세요."},{status:404});if(!c.isActive)return n.NextResponse.json({error:"승인되지 않은 환경측정기업입니다."},{status:400});if(await p._.user.findUnique({where:{email:t}}))return n.NextResponse.json({error:"이미 사용 중인 이메일입니다."},{status:400});let l=await u.ZP.hash(a,10),g=await p._.user.create({data:{email:t,password:l,name:s,phone:i,role:"OPERATOR",organizationId:c.id,companyName:c.name,department:o,position:d,status:"PENDING",isActive:!1,emailVerified:!1}});await p._.activityLog.create({data:{userId:g.id,action:"REGISTER_OPERATOR",target:"User",targetId:g.id,details:JSON.stringify({organizationName:c.name,businessNumber:r})}});let m=c.isActive?"회원가입 신청이 완료되었습니다. 환경측정기업 관리자의 승인을 기다려주세요.":"임시 등록이 완료되었습니다. 회사 승인 후 관리자가 귀하의 가입 신청을 확인합니다.";return n.NextResponse.json({message:m,email:g.email,isPendingCompany:!c.isActive})}catch(e){return n.NextResponse.json({error:"회원가입 처리 중 오류가 발생했습니다."},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/operators/register/route",pathname:"/api/operators/register",filename:"route",bundlePath:"app/api/operators/register/route"},resolvedPagePath:"C:\\Users\\User\\boaz\\frontend\\src\\app\\api\\operators\\register\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:g,serverHooks:m}=c,x="/api/operators/register/route";function R(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},20728:(e,r,t)=>{t.d(r,{_:()=>s});let a=require("@prisma/client"),s=global.prisma||new a.PrismaClient({log:["warn","error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[8948,5972,8691],()=>t(86558));module.exports=a})();