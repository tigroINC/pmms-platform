"use strict";(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},67470:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{POST:()=>d});var s=r(49303),i=r(88716),n=r(60670),o=r(87070),u=r(20728),p=r(98691);async function d(e){try{let{email:t,password:r,name:a,phone:s,companyName:i,businessNumber:n,department:d,position:l}=await e.json();if(!t||!r||!a)return o.NextResponse.json({error:"이메일, 비밀번호, 이름은 필수입니다."},{status:400});if(await u._.user.findUnique({where:{email:t}}))return o.NextResponse.json({error:"이미 등록된 이메일입니다."},{status:400});let c=await p.ZP.hash(r,10),m=null,h=!1;n&&(h=!!(m=await u._.customer.findUnique({where:{businessNumber:n}}))&&!m.isActive);let g=await u._.user.create({data:{email:t,password:c,name:a,phone:s,companyName:i,businessNumber:n,customerId:m?.id,department:d,position:l,role:"CUSTOMER_USER",status:"PENDING",isActive:!1,emailVerified:!1}});await u._.activityLog.create({data:{userId:g.id,action:"REGISTER",details:JSON.stringify({email:g.email,name:g.name})}});let x=h?"임시 등록이 완료되었습니다. 회사 승인 후 관리자가 귀하의 가입 신청을 확인합니다.":"회원가입이 완료되었습니다. 관리자 승인 후 로그인할 수 있습니다.";return o.NextResponse.json({message:x,user:{id:g.id,email:g.email,name:g.name,status:g.status},isPendingCompany:h},{status:201})}catch(e){return o.NextResponse.json({error:"회원가입 중 오류가 발생했습니다."},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\User\\boaz\\frontend\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:h}=l,g="/api/auth/register/route";function x(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},20728:(e,t,r)=>{r.d(t,{_:()=>s});let a=require("@prisma/client"),s=global.prisma||new a.PrismaClient({log:["warn","error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,8691],()=>r(67470));module.exports=a})();