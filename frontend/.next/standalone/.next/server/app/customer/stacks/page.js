(()=>{var e={};e.id=7044,e.ids=[7044],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},23294:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>h,tree:()=>d}),a(15599),a(92553),a(35866);var s=a(23191),r=a(88716),i=a(37922),n=a.n(i),l=a(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(t,c);let d=["",{children:["customer",{children:["stacks",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,15599)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\customer\\stacks\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,92553)),"C:\\Users\\User\\boaz\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["C:\\Users\\User\\boaz\\frontend\\src\\app\\customer\\stacks\\page.tsx"],o="/customer/stacks/page",m={require:a,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/customer/stacks/page",pathname:"/customer/stacks",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},82102:(e,t,a)=>{Promise.resolve().then(a.bind(a,58061))},36728:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},58061:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(10326),r=a(17577),i=a(35047),n=a(99837),l=a(36728),c=a(89175);function d({isOpen:e,onClose:t,onSelect:a,currentOrgId:i}){let[l,d]=(0,r.useState)([]),[x,o]=(0,r.useState)([]),[m,h]=(0,r.useState)(""),[p,g]=(0,r.useState)(null),[u,y]=(0,r.useState)(!1);return e?s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:t,children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:s.jsx("h2",{className:"text-xl font-bold",children:"환경측정기업 선택"})}),s.jsx("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:s.jsx(c.Z,{placeholder:"기업명 또는 사업자번호로 검색...",value:m,onChange:e=>h(e.target.value)})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:u?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"로딩 중..."}):0===x.length?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"검색 결과가 없습니다."}):s.jsx("div",{className:"space-y-2",children:x.map(e=>s.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${p?.id===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"} ${i===e.id?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>g(e),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:e.name}),e.businessNumber&&(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["사업자번호: ",e.businessNumber]})]}),i===e.id&&s.jsx("span",{className:"text-xs px-2 py-1 bg-gray-200 dark:bg-gray-600 rounded",children:"현재"})]})},e.id))})}),(0,s.jsxs)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex gap-2 justify-end",children:[s.jsx(n.Z,{variant:"secondary",onClick:t,children:"취소"}),s.jsx(n.Z,{onClick:()=>{p&&(a(p),t())},disabled:!p,children:"확인"})]})]})}):null}var x=a(21120);function o(){let{user:e,loading:t}=function(e){let{user:t,loading:a}=(0,x.a)();return(0,i.useRouter)(),(0,i.usePathname)(),{user:t,loading:a,hasPermission:!!t&&e.allowedRoles.includes(t.role)}}((0,r.useMemo)(()=>({allowedRoles:["SUPER_ADMIN","CUSTOMER_ADMIN","CUSTOMER_USER"],redirectTo:"/dashboard"}),[])),a=(0,i.useRouter)(),[c,o]=(0,r.useState)("confirmed"),[m,h]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[u,y]=(0,r.useState)(new Set),[j,N]=(0,r.useState)(!0),[b,f]=(0,r.useState)(""),[k,v]=(0,r.useState)(!1),[w,C]=(0,r.useState)(null),[D,S]=(0,r.useState)(null),[T,z]=(0,r.useState)(!1),[A,I]=(0,r.useState)(null),[L,_]=(0,r.useState)(!1),P=async()=>{try{let e=await fetch("/api/customer/stacks/pending-review"),t=await e.json();h(t.stacks||[])}catch(e){}},E=async()=>{try{let e=await fetch("/api/stacks"),t=((await e.json()).data||[]).filter(e=>e.isActive);g(t)}catch(e){}},R=e=>{let t=new Set(u);t.has(e)?t.delete(e):t.add(e),y(t)},F=async e=>{if(confirm("이 굴뚝을 확인 완료하시겠습니까?\n\n확인 완료 후 전체 탭에서 계속 표시되며, 검토대기 탭에서는 사라집니다."))try{let t=await fetch(`/api/customer/stacks/${e}/verify`,{method:"POST",headers:{"Content-Type":"application/json"}}),a=await t.json();t.ok?(alert(a.message||"확인 완료되었습니다."),P(),E()):alert(a.error||"확인 실패")}catch(e){alert("오류가 발생했습니다.")}},M=async()=>{if(0===u.size){alert("확인할 굴뚝을 선택해주세요.");return}if(confirm(`선택한 ${u.size}개 굴뚝을 일괄 확인 완료하시겠습니까?

확인 완료 후 전체 탭에서 계속 표시되며, 검토대기 탭에서는 사라집니다.`))try{let e=Array.from(u),t=0,a=0;for(let s of e)(await fetch(`/api/customer/stacks/${s}/verify`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?t++:a++;alert(`완료: ${t}건 성공, ${a}건 실패`),y(new Set),P(),E()}catch(e){alert("오류가 발생했습니다.")}},$=e=>{C(e.stackId||e.id),S({code:e.internal?.code||e.code||"",fullName:e.site?.name||e.fullName||"",facilityType:e.facilityType||"",category:e.category||"",location:e.physical?.location||e.location||"",height:e.physical?.height||e.height||"",diameter:e.physical?.diameter||e.diameter||"",organizationId:e.internal?.organization?.id||e.organizationNames?.[0]||"",organizationName:e.internal?.organization?.name||e.organizationNames?.[0]||""})},U=()=>{C(null),S(null),I(null)},O=async e=>{if(!D)return;let t=prompt("수정 사유를 입력하세요:");if(t)try{let a=await fetch(`/api/stacks/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:D.code,fullName:D.fullName,facilityType:D.facilityType,category:D.category,location:D.location,height:D.height?parseFloat(D.height):null,diameter:D.diameter?parseFloat(D.diameter):null,changeReason:t})});if(a.ok)A&&A.id!==D.organizationId&&await Z(e,A.id),alert("저장되었습니다."),U(),P(),E();else{let e=await a.json();alert(e.error||"저장 실패")}}catch(e){alert("오류가 발생했습니다.")}},Z=async(e,t)=>{try{let a=await fetch(`/api/stacks/${e}/change-organization`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:t})});if(!a.ok){let e=await a.json();throw Error(e.error)}}catch(e){throw e}},q=async e=>{if(confirm("이 굴뚝을 비활성화하시겠습니까?\n비활성화된 굴뚝은 '비활성화 보기'를 체크해야 표시됩니다."))try{let t=await fetch(`/api/stacks/${e}/deactivate`,{method:"POST"});if(t.ok)alert("비활성화되었습니다."),P(),E();else{let e=await t.json();alert(e.error||"비활성화 실패")}}catch(e){alert("오류가 발생했습니다.")}},G=async e=>{if(confirm("이 굴뚝을 활성화하시겠습니까?"))try{let t=await fetch(`/api/stacks/${e}/activate`,{method:"POST"});if(t.ok)alert("활성화되었습니다."),P(),E();else{let e=await t.json();alert(e.error||"활성화 실패")}}catch(e){alert("오류가 발생했습니다.")}},K=async(e,t)=>{if(t>0){alert("측정 데이터가 있는 굴뚝은 삭제할 수 없습니다.\n먼저 관련 측정 데이터를 삭제해주세요.");return}if(confirm("이 굴뚝을 완전히 삭제하시겠습니까?\n이 작업은 되돌릴 수 없습니다."))try{let t=await fetch(`/api/stacks/${e}`,{method:"DELETE"});if(t.ok)alert("삭제되었습니다."),P(),E();else{let e=await t.json();alert(e.error||"삭제 실패")}}catch(e){alert("오류가 발생했습니다.")}};return(0,s.jsxs)("section",{className:"space-y-3",children:[s.jsx("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-2.5",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[s.jsx("h1",{className:"text-lg font-semibold whitespace-nowrap mb-1.5",children:"굴뚝 관리"}),s.jsx("span",{className:"text-gray-300 dark:text-gray-600 mb-1.5",children:"|"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-1.5",children:[(0,s.jsxs)("button",{onClick:()=>o("confirmed"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${"confirmed"===c?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:["전체 (",p.length,")"]}),(0,s.jsxs)("button",{onClick:()=>o("pending"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${"pending"===c?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:["검토대기 (",m.length,")"]})]}),(0,s.jsxs)("div",{className:"flex flex-col",style:{minWidth:"280px"},children:[s.jsx("label",{className:"text-xs text-gray-600 dark:text-gray-400 mb-0.5",children:"검색"}),s.jsx("input",{type:"text",placeholder:"굴뚝번호, 코드, 명칭...",value:b,onChange:e=>f(e.target.value),className:"text-sm h-8 px-3 border rounded dark:bg-gray-800 dark:border-gray-700"})]}),"confirmed"===c&&(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm mb-1.5",children:[s.jsx("input",{type:"checkbox",checked:L,onChange:e=>_(e.target.checked),className:"w-4 h-4"}),"비활성화 보기"]}),(0,s.jsxs)("div",{className:"flex gap-2 ml-auto mb-1.5",children:[s.jsx(n.Z,{size:"sm",variant:"secondary",onClick:()=>{let e=new Blob(["\uFEFF"+[["굴뚝번호","굴뚝코드","정식명칭","배출시설종류","높이(m)","안지름(m)","종별","확인상태","담당환경측정회사","생성일"],...("pending"===c?m:p).map(e=>["pending"===c?e.site?.code||"":e.name||"","pending"===c?e.internal?.code||"":e.code||"","pending"===c?e.site?.name||"":e.fullName||"",e.facilityType||"","pending"===c?e.physical?.height||"":e.height||"","pending"===c?e.physical?.diameter||"":e.diameter||"",e.category||"","pending"===c?"확인필요":e.isVerified?"확인완료":"확인필요","pending"===c?e.internal?.organization?.name||"":e.organizationNames?.join(", ")||"",new Date(e.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")])].map(e=>e.map(e=>`"${String(e??"").replace(/"/g,'""')}"`).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`굴뚝목록_${"pending"===c?"검토대기":"전체"}_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},children:"Excel"}),"pending"===c&&e?.role==="CUSTOMER_ADMIN"&&(0,s.jsxs)(n.Z,{size:"sm",onClick:M,disabled:0===u.size,children:["일괄확인완료 ",u.size>0&&`(${u.size})`]}),(0,s.jsxs)(n.Z,{variant:"secondary",size:"sm",onClick:()=>v(!0),children:[s.jsx(l.Z,{className:"w-4 h-4 mr-1"}),"도움말"]}),s.jsx(n.Z,{size:"sm",onClick:()=>a.push("/customer/stacks/create"),children:"+ 굴뚝 직접 등록"})]})]})}),k&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>v(!1),children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:"굴뚝 관리 도움말"}),s.jsx("button",{onClick:()=>v(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,s.jsxs)("div",{className:"space-y-6 text-sm",children:[(0,s.jsxs)("section",{children:[s.jsx("h3",{className:"font-semibold text-base mb-2",children:"\uD83D\uDCCB 메뉴 개요"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"자사의 모든 굴뚝 정보를 조회하고 관리할 수 있는 메뉴입니다. 환경측정기업이 등록한 굴뚝을 검토하거나, 직접 굴뚝을 등록할 수 있습니다."})]}),(0,s.jsxs)("section",{children:[s.jsx("h3",{className:"font-semibold text-base mb-2",children:"\uD83D\uDCD1 탭 설명"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"border-l-4 border-blue-500 pl-3",children:[s.jsx("h4",{className:"font-medium mb-1",children:"전체 굴뚝"}),(0,s.jsxs)("ul",{className:"list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1",children:[s.jsx("li",{children:"자사의 모든 활성화된 굴뚝 목록을 확인할 수 있습니다"}),s.jsx("li",{children:"검색 기능으로 굴뚝번호, 코드, 명칭, 배출시설종류로 검색 가능합니다"}),s.jsx("li",{children:"각 굴뚝의 측정 건수와 생성일을 확인할 수 있습니다"}),s.jsx("li",{children:"확인 상태(확인완료/확인필요)를 표시하며, 확인필요 항목이 우선 정렬됩니다"}),(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"관리자"}),'는 "수정" 버튼으로 굴뚝 정보를 인라인 편집할 수 있습니다']}),(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"관리자"}),"는 담당 환경측정기업을 변경할 수 있습니다"]}),(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"관리자"}),"는 굴뚝을 비활성화하거나 영구 삭제할 수 있습니다"]}),s.jsx("li",{children:"Excel 버튼으로 목록을 다운로드할 수 있습니다"})]})]}),(0,s.jsxs)("div",{className:"border-l-4 border-orange-500 pl-3",children:[s.jsx("h4",{className:"font-medium mb-1",children:"검토 대기"}),(0,s.jsxs)("ul",{className:"list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1",children:[s.jsx("li",{children:"환경측정기업이 등록한 굴뚝 중 아직 확인하지 않은 목록입니다"}),s.jsx("li",{children:"검색 기능으로 빠르게 찾을 수 있습니다"}),(0,s.jsxs)("li",{children:["정보를 검토한 후 ",s.jsx("strong",{children:'"확인완료"'})," 버튼을 클릭하여 승인할 수 있습니다"]}),s.jsx("li",{children:"여러 굴뚝을 선택하여 일괄 확인 처리가 가능합니다"}),s.jsx("li",{children:'확인 완료된 굴뚝은 "전체 굴뚝" 탭으로 이동하며, 담당 환경측정기업에 알림이 전송됩니다'}),s.jsx("li",{children:"Excel 버튼으로 검토대기 목록을 다운로드할 수 있습니다"})]})]})]})]}),(0,s.jsxs)("section",{children:[s.jsx("h3",{className:"font-semibold text-base mb-2",children:"➕ 굴뚝 직접 등록"}),(0,s.jsxs)("div",{className:"space-y-2 text-gray-600 dark:text-gray-400",children:[s.jsx("p",{children:'우측 상단의 "+ 굴뚝 직접 등록" 버튼을 클릭하여 새로운 굴뚝을 등록할 수 있습니다.'}),(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded",children:[s.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-300 mb-2",children:"필수 입력 항목:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"현장 코드"}),": 자사에서 사용하는 굴뚝 코드 (예: S-001)"]}),(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"현장 명칭"}),": 굴뚝의 명칭 (예: 1호 소각로)"]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/20 p-3 rounded",children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-300 mb-2",children:"선택 입력 항목:"}),s.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.jsx("li",{children:"배출시설 종류, 높이, 안지름, 종별 등"})})]}),s.jsx("p",{className:"text-sm italic",children:"\uD83D\uDCA1 직접 등록한 굴뚝은 즉시 활성화되어 측정 데이터 입력이 가능합니다."})]})]}),(0,s.jsxs)("section",{children:[s.jsx("h3",{className:"font-semibold text-base mb-2",children:"✏️ 굴뚝 정보 수정"}),(0,s.jsxs)("div",{className:"space-y-2 text-gray-600 dark:text-gray-400",children:[s.jsx("p",{children:'전체 굴뚝 탭에서 "수정" 버튼을 클릭하여 굴뚝 정보를 수정할 수 있습니다.'}),(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded",children:[s.jsx("p",{className:"font-medium text-green-900 dark:text-green-300 mb-2",children:"수정 가능 항목:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"굴뚝 코드, 정식 명칭, 배출시설 종류, 종별"}),s.jsx("li",{children:"높이, 안지름"})]})]}),(0,s.jsxs)("p",{className:"text-sm italic",children:["⚠️ 수정 시 반드시 ",s.jsx("strong",{children:"수정 사유"}),"를 입력해야 하며, 모든 수정 이력이 자동으로 기록됩니다."]}),s.jsx("p",{className:"text-sm italic",children:"\uD83D\uDCCC 굴뚝번호는 환경측정기업 전용 필드로 수정할 수 없습니다."})]})]}),(0,s.jsxs)("section",{children:[s.jsx("h3",{className:"font-semibold text-base mb-2",children:"\uD83D\uDD14 알림 기능"}),s.jsx("div",{className:"space-y-2 text-gray-600 dark:text-gray-400",children:(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"환경측정기업이 굴뚝을 등록하거나 수정하면 실시간 알림을 받습니다"}),s.jsx("li",{children:"고객사가 굴뚝 정보를 수정하면 담당 환경측정기업에게 알림이 전송됩니다"}),s.jsx("li",{children:"굴뚝 확인 완료 시 담당 환경측정기업에게 알림이 전송됩니다"}),s.jsx("li",{children:"우측 상단 알림 아이콘에서 확인할 수 있습니다"})]})})]}),(0,s.jsxs)("section",{children:[s.jsx("h3",{className:"font-semibold text-base mb-2",children:"❓ 자주 묻는 질문"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium",children:"Q. 굴뚝 정보에 오류가 있으면 어떻게 하나요?"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:'A. "수정" 버튼을 클릭하여 직접 수정할 수 있습니다. 수정 사유를 입력하면 담당 환경측정기업에게 알림이 전송됩니다.'})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium",children:"Q. 검토 대기 중인 굴뚝은 측정이 가능한가요?"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"A. 네, 가능합니다. 활성화된 모든 굴뚝은 검토 여부와 관계없이 측정 데이터 입력이 가능합니다."})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium",children:"Q. 확인완료 버튼은 무엇인가요?"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"A. 굴뚝 정보를 확인했음을 표시하는 기능입니다. 측정 가능 여부와는 무관하며, 정보 확인 여부만 표시합니다."})]})]})]})]}),s.jsx("div",{className:"mt-6 flex justify-end",children:s.jsx(n.Z,{onClick:()=>v(!1),children:"닫기"})})]})}),"pending"===c&&s.jsx(s.Fragment,{children:0===m.length?s.jsx("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"검토가 필요한 굴뚝이 없습니다."})}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"hidden md:block overflow-x-auto max-h-[calc(100vh-200px)] overflow-y-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0 z-10",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s.jsx("input",{type:"checkbox",checked:u.size===m.length&&m.length>0,onChange:e=>{e.target.checked?y(new Set(m.map(e=>e.stackId))):y(new Set)},className:"h-4 w-4"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"굴뚝번호"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"굴뚝코드"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"정식명칭"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"배출시설종류"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"높이(m)"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"안지름(m)"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"종별"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"확인 상태"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"담당환경측정회사"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"생성일"}),e?.role==="CUSTOMER_ADMIN"&&s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"액션"})]})}),s.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:m.filter(e=>{if(!b)return!0;let t=b.toLowerCase();return e.site.code?.toLowerCase().includes(t)||e.internal?.code?.toLowerCase().includes(t)||e.site.name?.toLowerCase().includes(t)||e.facilityType?.toLowerCase().includes(t)}).sort((e,t)=>{let a=new Date(e.createdAt).getTime(),s=new Date(t.createdAt).getTime();return a!==s?s-a:(e.site.code||"").localeCompare(t.site.code||"")}).map(t=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("input",{type:"checkbox",checked:u.has(t.stackId),onChange:()=>R(t.stackId),className:"h-4 w-4"})}),s.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:t.site.code}),s.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:w===t.stackId?s.jsx("input",{type:"text",value:D?.code||"",onChange:e=>S({...D,code:e.target.value}),className:"w-full px-2 py-1 border rounded text-sm"}):t.internal?.code||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:w===t.stackId?s.jsx("input",{type:"text",value:D?.fullName||"",onChange:e=>S({...D,fullName:e.target.value}),className:"w-full px-2 py-1 border rounded text-sm"}):t.site.name||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:t.facilityType||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:w===t.stackId?s.jsx("input",{type:"number",step:"0.1",value:D?.height||"",onChange:e=>S({...D,height:e.target.value}),className:"w-20 px-2 py-1 border rounded text-sm"}):t.physical.height??"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:w===t.stackId?s.jsx("input",{type:"number",step:"0.1",value:D?.diameter||"",onChange:e=>S({...D,diameter:e.target.value}),className:"w-20 px-2 py-1 border rounded text-sm"}):t.physical.diameter??"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:t.category||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",children:"확인필요"})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:w===t.stackId?s.jsx("button",{onClick:()=>z(!0),className:"text-blue-600 hover:underline",children:D?.organizationName||"-"}):t.internal?.organization.name||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:new Date(t.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")}),e?.role==="CUSTOMER_ADMIN"&&s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[w===t.stackId?(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{onClick:()=>O(t.stackId),className:"text-blue-600 hover:underline text-xs",children:"저장"}),s.jsx("button",{onClick:()=>U(),className:"text-gray-600 hover:underline text-xs",children:"취소"})]}):s.jsx("button",{onClick:()=>$(t),className:"text-green-600 hover:underline text-xs",children:"수정"}),s.jsx("button",{onClick:()=>F(t.stackId),className:"text-blue-600 hover:underline text-xs",children:"확인완료"})]})})]},t.stackId))})]})}),s.jsx("div",{className:"md:hidden space-y-3",children:m.filter(e=>{if(!b)return!0;let t=b.toLowerCase();return e.site.code?.toLowerCase().includes(t)||e.internal?.code?.toLowerCase().includes(t)||e.site.name?.toLowerCase().includes(t)||e.facilityType?.toLowerCase().includes(t)}).sort((e,t)=>{let a=new Date(e.createdAt).getTime(),s=new Date(t.createdAt).getTime();return a!==s?s-a:(e.site.code||"").localeCompare(t.site.code||"")}).map(t=>(0,s.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"px-2 py-1 text-xs rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",children:"확인필요"}),e?.role==="CUSTOMER_ADMIN"&&s.jsx("button",{onClick:()=>F(t.stackId),className:"text-xs text-blue-600 hover:underline",children:"확인완료"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFED 굴뚝번호:"})," ",t.site.code]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCB 굴뚝코드:"})," ",t.internal?.code||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCD 정식명칭:"})," ",t.site.name||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"⚙️ 배출시설:"})," ",t.facilityType||"-"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCF 높이:"})," ",t.physical.height??"-","m"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"⭕ 안지름:"})," ",t.physical.diameter??"-","m"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFF7️ 종별:"})," ",t.category||"-"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFE2 담당:"})," ",t.internal?.organization.name||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCC5 생성일:"})," ",new Date(t.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")]})]})]},t.stackId))})]})}),"confirmed"===c&&s.jsx(s.Fragment,{children:0===p.length?s.jsx("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"확정된 굴뚝이 없습니다."})}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"hidden md:block overflow-x-auto max-h-[calc(100vh-200px)] overflow-y-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0 z-10",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"굴뚝번호"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"굴뚝코드"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"정식명칭"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"배출시설종류"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"높이(m)"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"안지름(m)"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"종별"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"확인 상태"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"담당환경측정회사"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"측정 건수"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"생성일"}),e?.role==="CUSTOMER_ADMIN"&&s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"액션"})]})}),s.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:p.filter(e=>{if(!L&&!e.isActive)return!1;if(!b)return!0;let t=b.toLowerCase();return e.name?.toLowerCase().includes(t)||e.code?.toLowerCase().includes(t)||e.fullName?.toLowerCase().includes(t)||e.facilityType?.toLowerCase().includes(t)||e.location?.toLowerCase().includes(t)}).sort((e,t)=>{let a=new Date(e.createdAt).getTime(),s=new Date(t.createdAt).getTime();return a!==s?s-a:(e.name||"").localeCompare(t.name||"")}).map(t=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:t.name}),s.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:w===t.id?s.jsx("input",{type:"text",value:D?.code||"",onChange:e=>S({...D,code:e.target.value}),className:"w-full px-2 py-1 border rounded text-sm"}):t.code||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:w===t.id?s.jsx("input",{type:"text",value:D?.fullName||"",onChange:e=>S({...D,fullName:e.target.value}),className:"w-full px-2 py-1 border rounded text-sm"}):t.fullName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:w===t.id?s.jsx("input",{type:"text",value:D?.facilityType||"",onChange:e=>S({...D,facilityType:e.target.value}),className:"w-full px-2 py-1 border rounded text-sm"}):t.facilityType||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:w===t.id?s.jsx("input",{type:"number",step:"0.1",value:D?.height||"",onChange:e=>S({...D,height:e.target.value}),className:"w-20 px-2 py-1 border rounded text-sm"}):t.height??"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:w===t.id?s.jsx("input",{type:"number",step:"0.1",value:D?.diameter||"",onChange:e=>S({...D,diameter:e.target.value}),className:"w-20 px-2 py-1 border rounded text-sm"}):t.diameter??"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:w===t.id?s.jsx("input",{type:"text",value:D?.category||"",onChange:e=>S({...D,category:e.target.value}),className:"w-20 px-2 py-1 border rounded text-sm"}):t.category||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:t.isVerified?s.jsx("span",{className:"px-2 py-1 text-xs rounded bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"✓ 확인완료"}):s.jsx("span",{className:"px-2 py-1 text-xs rounded bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300",children:"확인필요"})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:w===t.id?s.jsx("button",{onClick:()=>z(!0),className:"text-blue-600 hover:underline",children:D?.organizationName||"-"}):t.organizationNames&&t.organizationNames.length>0?t.organizationNames.join(", "):"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:t._count?.measurements||0}),s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:new Date(t.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")}),e?.role==="CUSTOMER_ADMIN"&&s.jsx("td",{className:"px-4 py-3 text-sm text-center",children:s.jsx("div",{className:"flex gap-2 justify-center flex-wrap",children:w===t.id?(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{onClick:()=>O(t.id),className:"text-blue-600 hover:underline text-xs",children:"저장"}),s.jsx("button",{onClick:()=>U(),className:"text-gray-600 hover:underline text-xs",children:"취소"})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{onClick:()=>$(t),className:"text-green-600 hover:underline text-xs",children:"수정"}),t.isActive?s.jsx("button",{onClick:()=>q(t.id),className:"text-orange-600 hover:underline text-xs",children:"비활성화"}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{onClick:()=>G(t.id),className:"text-green-600 hover:underline text-xs",children:"활성화"}),s.jsx("button",{onClick:()=>K(t.id,t._count?.measurements||0),className:`text-xs hover:underline ${(t._count?.measurements||0)>0?"text-gray-400 cursor-not-allowed":"text-red-600"}`,disabled:(t._count?.measurements||0)>0,children:"삭제"})]})]})})})]},t.id))})]})}),s.jsx("div",{className:"md:hidden space-y-3",children:p.filter(e=>{if(!b)return!0;let t=b.toLowerCase();return e.name?.toLowerCase().includes(t)||e.code?.toLowerCase().includes(t)||e.fullName?.toLowerCase().includes(t)||e.facilityType?.toLowerCase().includes(t)}).sort((e,t)=>{let a=new Date(e.createdAt).getTime(),s=new Date(t.createdAt).getTime();return a!==s?s-a:(e.name||"").localeCompare(t.name||"")}).map(e=>(0,s.jsxs)("div",{className:"rounded-lg border bg-white/50 dark:bg-white/5 p-4 space-y-2",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsx("span",{className:"px-2 py-1 text-xs rounded bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"확정완료"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFED 굴뚝번호:"})," ",e.name||"-"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCB 굴뚝코드:"})," ",e.code||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCD 정식명칭:"})," ",e.fullName||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"⚙️ 배출시설:"})," ",e.facilityType||"-"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCF 높이:"})," ",e.height??"-","m"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"⭕ 안지름:"})," ",e.diameter??"-","m"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFF7️ 종별:"})," ",e.category||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"\uD83C\uDFE2 담당:"})," ",e.organizationNames?.length>0?e.organizationNames.join(", "):"-"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCCA 측정:"})," ",e._count?.measurements||0,"건"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"\uD83D\uDCC5 생성:"})," ",e.createdAt?new Date(e.createdAt).toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"}):"-"]})]})]},e.stackId))})]})}),s.jsx(d,{isOpen:T,onClose:()=>z(!1),onSelect:e=>{I(e),S({...D,organizationId:e.id,organizationName:e.name})},currentOrgId:D?.organizationId})]})}},99837:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var s=a(10326);a(17577);let r={primary:"bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90",secondary:"border border-gray-300 text-gray-900 hover:bg-gray-50 dark:border-white/20 dark:text-white dark:hover:bg-white/10",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"},i={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-11 px-5 text-base"};function n({variant:e="primary",size:t="md",className:a="",...n}){return s.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ${r[e]} ${i[t]} ${a}`,...n})}},89175:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(10326);function r({className:e="",...t}){return s.jsx("input",{className:`rounded-md border bg-transparent px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-white/20 ${e}`,...t})}a(17577)},15599:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`C:\Users\User\boaz\frontend\src\app\customer\stacks\page.tsx#default`)},73881:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[8948,9975,6621,5736],()=>a(23294));module.exports=s})();